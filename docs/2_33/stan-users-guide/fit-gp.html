<!DOCTYPE html>
<html lang="" xml:lang="">
<head>
<link rel="canonical" href="https://mc-stan.org/docs/stan-users-guide/gaussian-processes.html#fit-gp.section" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10.3 Fitting a Gaussian process | Stan User’s Guide</title>
  <meta name="description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="10.3 Fitting a Gaussian process | Stan User’s Guide" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/img/logo-tm.pdf" />
  <meta property="og:description" content="Stan user’s guide with examples and programming techniques." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10.3 Fitting a Gaussian process | Stan User’s Guide" />
  
  <meta name="twitter:description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="twitter:image" content="/img/logo-tm.pdf" />

<meta name="author" content="Stan Development Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulating-from-a-gaussian-process.html"/>
<link rel="next" href="directions-rotations-and-hyperspheres.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/stan-users-guide/index.html" style="color:#4183C4">Stan User's Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li class="chapter" data-level="" data-path="example-models.html"><a href="example-models.html"><i class="fa fa-check"></i><i style="font-size: 110%; color:#990017;">Part 1. Example Models</i></a></li>
<li class="chapter" data-level="1" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>1</b> Regression Models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1.1</b> Linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#vectorization.section"><i class="fa fa-check"></i>Matrix notation and vectorization</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="QR-reparameterization.html"><a href="QR-reparameterization.html"><i class="fa fa-check"></i><b>1.2</b> The QR reparameterization</a></li>
<li class="chapter" data-level="1.3" data-path="regression-priors.html"><a href="regression-priors.html"><i class="fa fa-check"></i><b>1.3</b> Priors for coefficients and scales</a></li>
<li class="chapter" data-level="1.4" data-path="robust-noise-models.html"><a href="robust-noise-models.html"><i class="fa fa-check"></i><b>1.4</b> Robust noise models</a></li>
<li class="chapter" data-level="1.5" data-path="logistic-probit-regression.html"><a href="logistic-probit-regression.html"><i class="fa fa-check"></i><b>1.5</b> Logistic and probit regression</a></li>
<li class="chapter" data-level="1.6" data-path="multi-logit.html"><a href="multi-logit.html"><i class="fa fa-check"></i><b>1.6</b> Multi-logit regression</a>
<ul>
<li class="chapter" data-level="" data-path="multi-logit.html"><a href="multi-logit.html#identifiability"><i class="fa fa-check"></i>Identifiability</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html"><i class="fa fa-check"></i><b>1.7</b> Parameterizing centered vectors</a>
<ul>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#k-1-degrees-of-freedom"><i class="fa fa-check"></i><span class="math inline">\(K-1\)</span> degrees of freedom</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#qr-decomposition"><i class="fa fa-check"></i>QR decomposition</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#translated-and-scaled-simplex"><i class="fa fa-check"></i>Translated and scaled simplex</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#soft-centering"><i class="fa fa-check"></i>Soft centering</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="ordered-logistic.html"><a href="ordered-logistic.html"><i class="fa fa-check"></i><b>1.8</b> Ordered logistic and probit regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordered-logistic.html"><a href="ordered-logistic.html#ordered-logistic-regression"><i class="fa fa-check"></i>Ordered logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="hierarchical-logistic-regression.html"><a href="hierarchical-logistic-regression.html"><i class="fa fa-check"></i><b>1.9</b> Hierarchical logistic regression</a></li>
<li class="chapter" data-level="1.10" data-path="hierarchical-priors.html"><a href="hierarchical-priors.html"><i class="fa fa-check"></i><b>1.10</b> Hierarchical priors</a>
<ul>
<li class="chapter" data-level="" data-path="hierarchical-priors.html"><a href="hierarchical-priors.html#boundary-avoiding-priors-for-mle-in-hierarchical-models"><i class="fa fa-check"></i>Boundary-avoiding priors for MLE in hierarchical models</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="item-response-models.html"><a href="item-response-models.html"><i class="fa fa-check"></i><b>1.11</b> Item-response theory models</a>
<ul>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#data-declaration-with-missingness"><i class="fa fa-check"></i>Data declaration with missingness</a></li>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#pl-rasch-model"><i class="fa fa-check"></i>1PL (Rasch) model</a></li>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#multilevel-2pl-model"><i class="fa fa-check"></i>Multilevel 2PL model</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="priors-for-identification.html"><a href="priors-for-identification.html"><i class="fa fa-check"></i><b>1.12</b> Priors for identifiability</a>
<ul>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#location-and-scale-invariance"><i class="fa fa-check"></i>Location and scale invariance</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#separability"><i class="fa fa-check"></i>Separability</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="multivariate-hierarchical-priors.html"><a href="multivariate-hierarchical-priors.html"><i class="fa fa-check"></i><b>1.13</b> Multivariate priors for hierarchical models</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-hierarchical-priors.html"><a href="multivariate-hierarchical-priors.html#multivariate-regression-example"><i class="fa fa-check"></i>Multivariate regression example</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html"><i class="fa fa-check"></i><b>1.14</b> Prediction, forecasting, and backcasting</a>
<ul>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#programming-predictions"><i class="fa fa-check"></i>Programming predictions</a></li>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#predictions-as-generated-quantities"><i class="fa fa-check"></i>Predictions as generated quantities</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html"><i class="fa fa-check"></i><b>1.15</b> Multivariate outcomes</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#seemingly-unrelated-regressions"><i class="fa fa-check"></i>Seemingly unrelated regressions</a></li>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#multivariate-probit-regression"><i class="fa fa-check"></i>Multivariate probit regression</a></li>
</ul></li>
<li class="chapter" data-level="1.16" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html"><i class="fa fa-check"></i><b>1.16</b> Applications of pseudorandom number generation</a>
<ul>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#posterior-predictive-checks"><i class="fa fa-check"></i>Posterior predictive checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>2</b> Time-Series Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="autoregressive.html"><a href="autoregressive.html"><i class="fa fa-check"></i><b>2.1</b> Autoregressive models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#ar1-models"><i class="fa fa-check"></i>AR(1) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#extensions-to-the-ar1-model"><i class="fa fa-check"></i>Extensions to the AR(1) model</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#ar2-models"><i class="fa fa-check"></i>AR(2) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#ark-models"><i class="fa fa-check"></i>AR(<span class="math inline">\(K\)</span>) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#arch1-models"><i class="fa fa-check"></i>ARCH(1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html"><i class="fa fa-check"></i><b>2.2</b> Modeling temporal heteroscedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html#garch11-models"><i class="fa fa-check"></i>GARCH(1,1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>2.3</b> Moving average models</a>
<ul>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#ma2-example"><i class="fa fa-check"></i>MA(2) example</a></li>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#vectorized-maq-model"><i class="fa fa-check"></i>Vectorized MA(Q) model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html"><i class="fa fa-check"></i><b>2.4</b> Autoregressive moving average models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html#identifiability-and-stationarity"><i class="fa fa-check"></i>Identifiability and stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="stochastic-volatility-models.html"><a href="stochastic-volatility-models.html"><i class="fa fa-check"></i><b>2.5</b> Stochastic volatility models</a></li>
<li class="chapter" data-level="2.6" data-path="hmms.html"><a href="hmms.html"><i class="fa fa-check"></i><b>2.6</b> Hidden Markov models</a>
<ul>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#supervised-parameter-estimation"><i class="fa fa-check"></i>Supervised parameter estimation</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#start-state-and-end-state-probabilities"><i class="fa fa-check"></i>Start-state and end-state probabilities</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#calculating-sufficient-statistics"><i class="fa fa-check"></i>Calculating sufficient statistics</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#analytic-posterior"><i class="fa fa-check"></i>Analytic posterior</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#semisupervised-estimation"><i class="fa fa-check"></i>Semisupervised estimation</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#predictive-inference"><i class="fa fa-check"></i>Predictive inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missing-data-and-partially-known-parameters.html"><a href="missing-data-and-partially-known-parameters.html"><i class="fa fa-check"></i><b>3</b> Missing Data and Partially Known Parameters</a>
<ul>
<li class="chapter" data-level="3.1" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>3.1</b> Missing data</a></li>
<li class="chapter" data-level="3.2" data-path="partially-known-parameters.html"><a href="partially-known-parameters.html"><i class="fa fa-check"></i><b>3.2</b> Partially known parameters</a></li>
<li class="chapter" data-level="3.3" data-path="sliced-missing-data.html"><a href="sliced-missing-data.html"><i class="fa fa-check"></i><b>3.3</b> Sliced missing data</a></li>
<li class="chapter" data-level="3.4" data-path="loading-matrix-for-factor-analysis.html"><a href="loading-matrix-for-factor-analysis.html"><i class="fa fa-check"></i><b>3.4</b> Loading matrix for factor analysis</a></li>
<li class="chapter" data-level="3.5" data-path="missing-multivariate-data.html"><a href="missing-multivariate-data.html"><i class="fa fa-check"></i><b>3.5</b> Missing multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="truncated-or-censored-data.html"><a href="truncated-or-censored-data.html"><i class="fa fa-check"></i><b>4</b> Truncated or Censored Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="truncation.html"><a href="truncation.html"><i class="fa fa-check"></i><b>4.1</b> Truncated distributions</a></li>
<li class="chapter" data-level="4.2" data-path="truncated-data.html"><a href="truncated-data.html"><i class="fa fa-check"></i><b>4.2</b> Truncated data</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-data.html"><a href="truncated-data.html#constraints-and-out-of-bounds-returns"><i class="fa fa-check"></i>Constraints and out-of-bounds returns</a></li>
<li class="chapter" data-level="" data-path="truncated-data.html"><a href="truncated-data.html#unknown-truncation-points"><i class="fa fa-check"></i>Unknown truncation points</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="censored-data.html"><a href="censored-data.html"><i class="fa fa-check"></i><b>4.3</b> Censored data</a>
<ul>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#estimating-censored-values"><i class="fa fa-check"></i>Estimating censored values</a></li>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#integrating-out-censored-values"><i class="fa fa-check"></i>Integrating out censored values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixture-modeling.html"><a href="mixture-modeling.html"><i class="fa fa-check"></i><b>5</b> Finite Mixtures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clustering-mixture.html"><a href="clustering-mixture.html"><i class="fa fa-check"></i><b>5.1</b> Relation to clustering</a></li>
<li class="chapter" data-level="5.2" data-path="latent-discrete-parameterization.html"><a href="latent-discrete-parameterization.html"><i class="fa fa-check"></i><b>5.2</b> Latent discrete parameterization</a></li>
<li class="chapter" data-level="5.3" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html"><i class="fa fa-check"></i><b>5.3</b> Summing out the responsibility parameter</a>
<ul>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#log-sum-of-exponentials-linear-sums-on-the-log-scale"><i class="fa fa-check"></i>Log sum of exponentials: linear Sums on the log scale</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#dropping-uniform-mixture-ratios"><i class="fa fa-check"></i>Dropping uniform mixture ratios</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#recovering-posterior-mixture-proportions"><i class="fa fa-check"></i>Recovering posterior mixture proportions</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#estimating-parameters-of-a-mixture"><i class="fa fa-check"></i>Estimating parameters of a mixture</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectorizing-mixtures.html"><a href="vectorizing-mixtures.html"><i class="fa fa-check"></i><b>5.4</b> Vectorizing mixtures</a></li>
<li class="chapter" data-level="5.5" data-path="mixture-inference.html"><a href="mixture-inference.html"><i class="fa fa-check"></i><b>5.5</b> Inferences supported by mixtures</a>
<ul>
<li class="chapter" data-level="" data-path="mixture-inference.html"><a href="mixture-inference.html#mixtures-with-unidentifiable-components"><i class="fa fa-check"></i>Mixtures with unidentifiable components</a></li>
<li class="chapter" data-level="" data-path="mixture-inference.html"><a href="mixture-inference.html#inference-under-label-switching"><i class="fa fa-check"></i>Inference under label switching</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="zero-inflated.html"><a href="zero-inflated.html"><i class="fa fa-check"></i><b>5.6</b> Zero-inflated and hurdle models</a>
<ul>
<li class="chapter" data-level="" data-path="zero-inflated.html"><a href="zero-inflated.html#zero-inflation"><i class="fa fa-check"></i>Zero inflation</a></li>
<li class="chapter" data-level="" data-path="zero-inflated.html"><a href="zero-inflated.html#hurdle-models"><i class="fa fa-check"></i>Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html"><i class="fa fa-check"></i><b>5.7</b> Priors and effective data size in mixture models</a>
<ul>
<li class="chapter" data-level="" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html#comparison-to-model-averaging"><i class="fa fa-check"></i>Comparison to model averaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="measurement-error-and-meta-analysis.html"><a href="measurement-error-and-meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Measurement Error and Meta-Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html"><i class="fa fa-check"></i><b>6.1</b> Bayesian measurement error model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#regression-with-measurement-error"><i class="fa fa-check"></i>Regression with measurement error</a></li>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#rounding"><i class="fa fa-check"></i>Rounding</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Meta-analysis</a>
<ul>
<li class="chapter" data-level="" data-path="meta-analysis.html"><a href="meta-analysis.html#treatment-effects-in-controlled-studies"><i class="fa fa-check"></i>Treatment effects in controlled studies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-discrete.html"><a href="latent-discrete.html"><i class="fa fa-check"></i><b>7</b> Latent Discrete Parameters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rao-blackwell.html"><a href="rao-blackwell.html"><i class="fa fa-check"></i><b>7.1</b> The benefits of marginalization</a></li>
<li class="chapter" data-level="7.2" data-path="change-point.html"><a href="change-point.html"><i class="fa fa-check"></i><b>7.2</b> Change point models</a>
<ul>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#model-with-latent-discrete-parameter"><i class="fa fa-check"></i>Model with latent discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#marginalizing-out-the-discrete-parameter"><i class="fa fa-check"></i>Marginalizing out the discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#coding-the-model-in-stan-1"><i class="fa fa-check"></i>Coding the model in Stan</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#fitting-the-model-with-mcmc"><i class="fa fa-check"></i>Fitting the model with MCMC</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#posterior-distribution-of-the-discrete-change-point"><i class="fa fa-check"></i>Posterior distribution of the discrete change point</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#discrete-sampling"><i class="fa fa-check"></i>Discrete sampling</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#posterior-covariance"><i class="fa fa-check"></i>Posterior covariance</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#multiple-change-points"><i class="fa fa-check"></i>Multiple change points</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html"><i class="fa fa-check"></i><b>7.3</b> Mark-recapture models</a>
<ul>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#simple-mark-recapture-model"><i class="fa fa-check"></i>Simple mark-recapture model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#cormack-jolly-seber-with-discrete-parameter"><i class="fa fa-check"></i>Cormack-Jolly-Seber with discrete parameter</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#collective-cormack-jolly-seber-model"><i class="fa fa-check"></i>Collective Cormack-Jolly-Seber model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#individual-cormack-jolly-seber-model"><i class="fa fa-check"></i>Individual Cormack-Jolly-Seber model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-coding-models.html"><a href="data-coding-models.html"><i class="fa fa-check"></i><b>7.4</b> Data coding and diagnostic accuracy models</a>
<ul>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#diagnostic-accuracy"><i class="fa fa-check"></i>Diagnostic accuracy</a></li>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#data-coding"><i class="fa fa-check"></i>Data coding</a></li>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#noisy-categorical-measurement-model"><i class="fa fa-check"></i>Noisy categorical measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#model-parameters"><i class="fa fa-check"></i>Model parameters</a></li>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#noisy-measurement-model"><i class="fa fa-check"></i>Noisy measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-models.html"><a href="data-coding-models.html#stan-implementation"><i class="fa fa-check"></i>Stan implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="marginalization-mathematics.html"><a href="marginalization-mathematics.html"><i class="fa fa-check"></i><b>7.5</b> The mathematics of recovering marginalized parameters</a>
<ul>
<li class="chapter" data-level="" data-path="marginalization-mathematics.html"><a href="marginalization-mathematics.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="marginalization-mathematics.html"><a href="marginalization-mathematics.html#estimating-expectations"><i class="fa fa-check"></i>Estimating expectations</a></li>
<li class="chapter" data-level="" data-path="marginalization-mathematics.html"><a href="marginalization-mathematics.html#evaluating-the-conditional-expectation"><i class="fa fa-check"></i>Evaluating the conditional expectation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sparse-ragged.html"><a href="sparse-ragged.html"><i class="fa fa-check"></i><b>8</b> Sparse and Ragged Data Structures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sparse-data-structures.html"><a href="sparse-data-structures.html"><i class="fa fa-check"></i><b>8.1</b> Sparse data structures</a></li>
<li class="chapter" data-level="8.2" data-path="ragged-data-structs.html"><a href="ragged-data-structs.html"><i class="fa fa-check"></i><b>8.2</b> Ragged data structures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="relation-to-finite-mixture-models.html"><a href="relation-to-finite-mixture-models.html"><i class="fa fa-check"></i><b>9.1</b> Relation to finite mixture models</a></li>
<li class="chapter" data-level="9.2" data-path="soft-k-means.html"><a href="soft-k-means.html"><i class="fa fa-check"></i><b>9.2</b> Soft <em>K</em>-means</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="soft-k-means.html"><a href="soft-k-means.html#geometric-hard-k-means-clustering"><i class="fa fa-check"></i><b>9.2.1</b> Geometric hard <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="9.2.2" data-path="soft-k-means.html"><a href="soft-k-means.html#soft-k-means-clustering"><i class="fa fa-check"></i><b>9.2.2</b> Soft <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="" data-path="soft-k-means.html"><a href="soft-k-means.html#stan-implementation-of-soft-k-means"><i class="fa fa-check"></i>Stan implementation of soft <em>K</em>-means</a></li>
<li class="chapter" data-level="" data-path="soft-k-means.html"><a href="soft-k-means.html#generalizing-soft-k-means"><i class="fa fa-check"></i>Generalizing soft <em>K</em>-means</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html"><i class="fa fa-check"></i><b>9.3</b> The difficulty of Bayesian inference for clustering</a>
<ul>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#non-identifiability"><i class="fa fa-check"></i>Non-identifiability</a></li>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#multimodality"><i class="fa fa-check"></i>Multimodality</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html"><i class="fa fa-check"></i><b>9.4</b> Naive Bayes classification and clustering</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#coding-ragged-arrays"><i class="fa fa-check"></i>Coding ragged arrays</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-with-category-labeled-training-data"><i class="fa fa-check"></i>Estimation with category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-without-category-labeled-training-data"><i class="fa fa-check"></i>Estimation without category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#full-bayesian-inference-for-naive-bayes"><i class="fa fa-check"></i>Full Bayesian inference for naive Bayes</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#prediction-without-model-updates"><i class="fa fa-check"></i>Prediction without model updates</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>9.5</b> Latent Dirichlet allocation</a>
<ul>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#the-lda-model"><i class="fa fa-check"></i>The LDA Model</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#summing-out-the-discrete-parameters"><i class="fa fa-check"></i>Summing out the discrete parameters</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#implementation-of-lda"><i class="fa fa-check"></i>Implementation of LDA</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#correlated-topic-model"><i class="fa fa-check"></i>Correlated topic model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gaussian-processes.html"><a href="gaussian-processes.html"><i class="fa fa-check"></i><b>10</b> Gaussian Processes</a>
<ul>
<li class="chapter" data-level="10.1" data-path="gaussian-process-regression.html"><a href="gaussian-process-regression.html"><i class="fa fa-check"></i><b>10.1</b> Gaussian process regression</a></li>
<li class="chapter" data-level="10.2" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html"><i class="fa fa-check"></i><b>10.2</b> Simulating from a Gaussian process</a>
<ul>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#multivariate-inputs"><i class="fa fa-check"></i>Multivariate inputs</a></li>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#cholesky-factored-and-transformed-implementation"><i class="fa fa-check"></i>Cholesky factored and transformed implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fit-gp.html"><a href="fit-gp.html"><i class="fa fa-check"></i><b>10.3</b> Fitting a Gaussian process</a>
<ul>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#gp-with-a-normal-outcome"><i class="fa fa-check"></i>GP with a normal outcome</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#discrete-outcomes-with-gaussian-processes"><i class="fa fa-check"></i>Discrete outcomes with Gaussian processes</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#automatic-relevance-determination"><i class="fa fa-check"></i>Automatic relevance determination</a></li>
<li class="chapter" data-level="10.3.1" data-path="fit-gp.html"><a href="fit-gp.html#priors-gp.section"><i class="fa fa-check"></i><b>10.3.1</b> Priors for Gaussian process parameters</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#predictive-inference-with-a-gaussian-process"><i class="fa fa-check"></i>Predictive inference with a Gaussian process</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#multiple-output-gaussian-processes"><i class="fa fa-check"></i>Multiple-output Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="directions-rotations-and-hyperspheres.html"><a href="directions-rotations-and-hyperspheres.html"><i class="fa fa-check"></i><b>11</b> Directions, Rotations, and Hyperspheres</a>
<ul>
<li class="chapter" data-level="11.1" data-path="unit-vectors.html"><a href="unit-vectors.html"><i class="fa fa-check"></i><b>11.1</b> Unit vectors</a></li>
<li class="chapter" data-level="11.2" data-path="circles-spheres-and-hyperspheres.html"><a href="circles-spheres-and-hyperspheres.html"><i class="fa fa-check"></i><b>11.2</b> Circles, spheres, and hyperspheres</a></li>
<li class="chapter" data-level="11.3" data-path="transforming-to-unconstrained-parameters.html"><a href="transforming-to-unconstrained-parameters.html"><i class="fa fa-check"></i><b>11.3</b> Transforming to unconstrained parameters</a></li>
<li class="chapter" data-level="11.4" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html"><i class="fa fa-check"></i><b>11.4</b> Unit vectors and rotations</a>
<ul>
<li class="chapter" data-level="" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html#angles-from-unit-vectors"><i class="fa fa-check"></i>Angles from unit vectors</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="circular-representations-of-days-and-years.html"><a href="circular-representations-of-days-and-years.html"><i class="fa fa-check"></i><b>11.5</b> Circular representations of days and years</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="algebra-solver.html"><a href="algebra-solver.html"><i class="fa fa-check"></i><b>12</b> Solving Algebraic Equations</a>
<ul>
<li class="chapter" data-level="12.1" data-path="example-system-of-nonlinear-algebraic-equations.html"><a href="example-system-of-nonlinear-algebraic-equations.html"><i class="fa fa-check"></i><b>12.1</b> Example: system of nonlinear algebraic equations</a></li>
<li class="chapter" data-level="12.2" data-path="coding-an-algebraic-system.html"><a href="coding-an-algebraic-system.html"><i class="fa fa-check"></i><b>12.2</b> Coding an algebraic system</a></li>
<li class="chapter" data-level="12.3" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html"><i class="fa fa-check"></i><b>12.3</b> Calling the algebraic solver</a>
<ul>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#data-versus-parameters"><i class="fa fa-check"></i>Data versus parameters</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#length-of-the-algebraic-function-and-of-the-vector-of-unknowns"><i class="fa fa-check"></i>Length of the algebraic function and of the vector of unknowns</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#pathological-solutions"><i class="fa fa-check"></i>Pathological solutions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="algebra-control.html"><a href="algebra-control.html"><i class="fa fa-check"></i><b>12.4</b> Control parameters for the algebraic solver</a>
<ul>
<li class="chapter" data-level="" data-path="algebra-control.html"><a href="algebra-control.html#tolerance"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="algebra-control.html"><a href="algebra-control.html#maximum-number-of-steps"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ode-solver.html"><a href="ode-solver.html"><i class="fa fa-check"></i><b>13</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>13.1</b> Notation</a></li>
<li class="chapter" data-level="13.2" data-path="example-simple-harmonic-oscillator.html"><a href="example-simple-harmonic-oscillator.html"><i class="fa fa-check"></i><b>13.2</b> Example: simple harmonic oscillator</a></li>
<li class="chapter" data-level="13.3" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html"><i class="fa fa-check"></i><b>13.3</b> Coding the ODE system function</a>
<ul>
<li class="chapter" data-level="" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html#strict-signature-1"><i class="fa fa-check"></i>Strict signature</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="measurement-error-models.html"><a href="measurement-error-models.html"><i class="fa fa-check"></i><b>13.4</b> Measurement error models</a>
<ul>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#simulating-noisy-measurements"><i class="fa fa-check"></i>Simulating noisy measurements</a></li>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#estimating-system-parameters-and-initial-state"><i class="fa fa-check"></i>Estimating system parameters and initial state</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="stiff-ode.html"><a href="stiff-ode.html"><i class="fa fa-check"></i><b>13.5</b> Stiff ODEs</a></li>
<li class="chapter" data-level="13.6" data-path="control-ode.html"><a href="control-ode.html"><i class="fa fa-check"></i><b>13.6</b> Control parameters for ODE solving</a>
<ul>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#discontinuous-ode-system-function"><i class="fa fa-check"></i>Discontinuous ODE system function</a></li>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#tolerance-1"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#maximum-number-of-steps-1"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="adjoint-ode.html"><a href="adjoint-ode.html"><i class="fa fa-check"></i><b>13.7</b> Adjoint ODE solver</a></li>
<li class="chapter" data-level="13.8" data-path="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><a href="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><i class="fa fa-check"></i><b>13.8</b> Solving a system of linear ODEs using a matrix exponential</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="integrate-1d.html"><a href="integrate-1d.html"><i class="fa fa-check"></i><b>14</b> Computing One Dimensional Integrals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html"><i class="fa fa-check"></i><b>14.1</b> Calling the integrator</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#limits-of-integration"><i class="fa fa-check"></i><b>14.1.1</b> Limits of integration</a></li>
<li class="chapter" data-level="14.1.2" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#data-vs.-parameters"><i class="fa fa-check"></i><b>14.1.2</b> Data vs. parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html"><i class="fa fa-check"></i><b>14.2</b> Integrator convergence</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="integrator-convergence.html"><a href="integrator-convergence.html#zero-crossing"><i class="fa fa-check"></i><b>14.2.1</b> Zero-crossing integrals</a></li>
<li class="chapter" data-level="14.2.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html#integral-precision"><i class="fa fa-check"></i><b>14.2.2</b> Avoiding precision loss near limits of integration in definite integrals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="complex-numbers.html"><a href="complex-numbers.html"><i class="fa fa-check"></i><b>15</b> Complex Numbers</a>
<ul>
<li class="chapter" data-level="15.1" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html"><i class="fa fa-check"></i><b>15.1</b> Working with complex numbers</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#constructing-and-accessing-complex-numbers"><i class="fa fa-check"></i><b>15.1.1</b> Constructing and accessing complex numbers</a></li>
<li class="chapter" data-level="15.1.2" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-assignment-and-promotion"><i class="fa fa-check"></i><b>15.1.2</b> Complex assignment and promotion</a></li>
<li class="chapter" data-level="15.1.3" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-arrays"><i class="fa fa-check"></i><b>15.1.3</b> Complex arrays</a></li>
<li class="chapter" data-level="15.1.4" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-functions"><i class="fa fa-check"></i><b>15.1.4</b> Complex functions</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="complex-random-variables.html"><a href="complex-random-variables.html"><i class="fa fa-check"></i><b>15.2</b> Complex random variables</a></li>
<li class="chapter" data-level="15.3" data-path="complex-matrices-and-vectors.html"><a href="complex-matrices-and-vectors.html"><i class="fa fa-check"></i><b>15.3</b> Complex matrices and vectors</a></li>
<li class="chapter" data-level="15.4" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html"><i class="fa fa-check"></i><b>15.4</b> Complex linear regression</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html#independent-real-and-imaginary-error"><i class="fa fa-check"></i><b>15.4.1</b> Independent real and imaginary error</a></li>
<li class="chapter" data-level="15.4.2" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html#dependent-complex-error"><i class="fa fa-check"></i><b>15.4.2</b> Dependent complex error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dae-solver.html"><a href="dae-solver.html"><i class="fa fa-check"></i><b>16</b> Differential-Algebraic Equations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="notation-1.html"><a href="notation-1.html"><i class="fa fa-check"></i><b>16.1</b> Notation</a></li>
<li class="chapter" data-level="16.2" data-path="example-chemical-kinetics.html"><a href="example-chemical-kinetics.html"><i class="fa fa-check"></i><b>16.2</b> Example: chemical kinetics</a></li>
<li class="chapter" data-level="16.3" data-path="index-of-daes.html"><a href="index-of-daes.html"><i class="fa fa-check"></i><b>16.3</b> Index of DAEs</a></li>
<li class="chapter" data-level="16.4" data-path="coding-the-dae-system-function.html"><a href="coding-the-dae-system-function.html"><i class="fa fa-check"></i><b>16.4</b> Coding the DAE system function</a>
<ul>
<li class="chapter" data-level="" data-path="coding-the-dae-system-function.html"><a href="coding-the-dae-system-function.html#strict-signature-2"><i class="fa fa-check"></i>Strict signature</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="solving-daes.html"><a href="solving-daes.html"><i class="fa fa-check"></i><b>16.5</b> Solving DAEs</a></li>
<li class="chapter" data-level="16.6" data-path="control-dae.html"><a href="control-dae.html"><i class="fa fa-check"></i><b>16.6</b> Control parameters for DAE solving</a>
<ul>
<li class="chapter" data-level="" data-path="control-dae.html"><a href="control-dae.html#maximum-number-of-steps-2"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-2.-programming-techniques.html"><a href="part-2.-programming-techniques.html"><i class="fa fa-check"></i><i style="font-size: 110%; color:#990017;">Part 2. Programming Techniques</i></a></li>
<li class="chapter" data-level="17" data-path="floating-point-arithmetic.html"><a href="floating-point-arithmetic.html"><i class="fa fa-check"></i><b>17</b> Floating Point Arithmetic</a>
<ul>
<li class="chapter" data-level="17.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html"><i class="fa fa-check"></i><b>17.1</b> Floating-point representations</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html#finite-values"><i class="fa fa-check"></i><b>17.1.1</b> Finite values</a></li>
<li class="chapter" data-level="17.1.2" data-path="floating-point-representations.html"><a href="floating-point-representations.html#normality"><i class="fa fa-check"></i><b>17.1.2</b> Normality</a></li>
<li class="chapter" data-level="17.1.3" data-path="floating-point-representations.html"><a href="floating-point-representations.html#ranges-and-extreme-values"><i class="fa fa-check"></i><b>17.1.3</b> Ranges and extreme values</a></li>
<li class="chapter" data-level="17.1.4" data-path="floating-point-representations.html"><a href="floating-point-representations.html#signed-zero"><i class="fa fa-check"></i><b>17.1.4</b> Signed zero</a></li>
<li class="chapter" data-level="17.1.5" data-path="floating-point-representations.html"><a href="floating-point-representations.html#not-a-number-values"><i class="fa fa-check"></i><b>17.1.5</b> Not-a-number values</a></li>
<li class="chapter" data-level="17.1.6" data-path="floating-point-representations.html"><a href="floating-point-representations.html#positive-and-negative-infinity"><i class="fa fa-check"></i><b>17.1.6</b> Positive and negative infinity</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="literals-decimal-and-scientific-notation.html"><a href="literals-decimal-and-scientific-notation.html"><i class="fa fa-check"></i><b>17.2</b> Literals: decimal and scientific notation</a></li>
<li class="chapter" data-level="17.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html"><i class="fa fa-check"></i><b>17.3</b> Arithmetic precision</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#rounding-and-probabilities"><i class="fa fa-check"></i><b>17.3.1</b> Rounding and probabilities</a></li>
<li class="chapter" data-level="17.3.2" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#machine-precision-and-the-asymmetry-of-0-and-1"><i class="fa fa-check"></i><b>17.3.2</b> Machine precision and the asymmetry of 0 and 1</a></li>
<li class="chapter" data-level="17.3.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#complementary-and-epsilon-functions"><i class="fa fa-check"></i><b>17.3.3</b> Complementary and epsilon functions</a></li>
<li class="chapter" data-level="17.3.4" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#catastrophic-cancellation"><i class="fa fa-check"></i><b>17.3.4</b> Catastrophic cancellation</a></li>
<li class="chapter" data-level="17.3.5" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#overflow"><i class="fa fa-check"></i><b>17.3.5</b> Overflow</a></li>
<li class="chapter" data-level="17.3.6" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#underflow-and-the-log-scale"><i class="fa fa-check"></i><b>17.3.6</b> Underflow and the log scale</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html"><i class="fa fa-check"></i><b>17.4</b> Log sum of exponentials</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#log-sum-exp-function"><i class="fa fa-check"></i><b>17.4.1</b> Log-sum-exp function</a></li>
<li class="chapter" data-level="17.4.2" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#applying-log-sum-exp-to-a-sequence"><i class="fa fa-check"></i><b>17.4.2</b> Applying log-sum-exp to a sequence</a></li>
<li class="chapter" data-level="17.4.3" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#calculating-means-with-log-sum-exp"><i class="fa fa-check"></i><b>17.4.3</b> Calculating means with log-sum-exp</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="comparing-floating-point-numbers.html"><a href="comparing-floating-point-numbers.html"><i class="fa fa-check"></i><b>17.5</b> Comparing floating-point numbers</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="matrices-vectors-arrays-and-tuples.html"><a href="matrices-vectors-arrays-and-tuples.html"><i class="fa fa-check"></i><b>18</b> Matrices, Vectors, Arrays, and Tuples</a>
<ul>
<li class="chapter" data-level="18.1" data-path="basic-motivation.html"><a href="basic-motivation.html"><i class="fa fa-check"></i><b>18.1</b> Basic motivation</a></li>
<li class="chapter" data-level="18.2" data-path="tuple-types.html"><a href="tuple-types.html"><i class="fa fa-check"></i><b>18.2</b> Tuple types</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="tuple-types.html"><a href="tuple-types.html#tuple-syntax"><i class="fa fa-check"></i><b>18.2.1</b> Tuple syntax</a></li>
<li class="chapter" data-level="" data-path="tuple-types.html"><a href="tuple-types.html#applications-of-tuples"><i class="fa fa-check"></i>Applications of tuples</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="fixed-sizes-and-indexing-out-of-bounds.html"><a href="fixed-sizes-and-indexing-out-of-bounds.html"><i class="fa fa-check"></i><b>18.3</b> Fixed sizes and indexing out of bounds</a></li>
<li class="chapter" data-level="18.4" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html"><i class="fa fa-check"></i><b>18.4</b> Data type and indexing efficiency</a>
<ul>
<li class="chapter" data-level="" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html#matrices-vs.-two-dimensional-arrays"><i class="fa fa-check"></i>Matrices vs. two-dimensional arrays</a></li>
<li class="chapter" data-level="" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html#row-vectors-vs.-one-dimensional-arrays"><i class="fa fa-check"></i>(Row) vectors vs. one-dimensional arrays</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="memory-locality.html"><a href="memory-locality.html"><i class="fa fa-check"></i><b>18.5</b> Memory locality</a>
<ul>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#memory-locality-1"><i class="fa fa-check"></i>Memory locality</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#arrays"><i class="fa fa-check"></i>Arrays</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="converting-among-matrix-vector-and-array-types.html"><a href="converting-among-matrix-vector-and-array-types.html"><i class="fa fa-check"></i><b>18.6</b> Converting among matrix, vector, and array types</a></li>
<li class="chapter" data-level="18.7" data-path="aliasing-in-stan-containers.html"><a href="aliasing-in-stan-containers.html"><i class="fa fa-check"></i><b>18.7</b> Aliasing in Stan containers</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="multi-indexing.html"><a href="multi-indexing.html"><i class="fa fa-check"></i><b>19</b> Multiple Indexing and Range Indexing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="multiple-indexing.html"><a href="multiple-indexing.html"><i class="fa fa-check"></i><b>19.1</b> Multiple indexing</a></li>
<li class="chapter" data-level="19.2" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html"><i class="fa fa-check"></i><b>19.2</b> Slicing with range indexes</a>
<ul>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-and-upper-bound-indexes"><i class="fa fa-check"></i>Lower and upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-or-upper-bound-indexes"><i class="fa fa-check"></i>Lower or upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#full-range-indexes"><i class="fa fa-check"></i>Full range indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#slicing-functions"><i class="fa fa-check"></i>Slicing functions</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html"><i class="fa fa-check"></i><b>19.3</b> Multiple indexing on the left of assignments</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html#assign-by-value-and-aliasing"><i class="fa fa-check"></i>Assign-by-value and aliasing</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html"><i class="fa fa-check"></i><b>19.4</b> Multiple indexes with vectors and matrices</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-1"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-with-one-multiple-index"><i class="fa fa-check"></i>Matrices with one multiple index</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#arrays-of-vectors-or-matrices"><i class="fa fa-check"></i>Arrays of vectors or matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#block-row-and-column-extraction-for-matrices"><i class="fa fa-check"></i>Block, row, and column extraction for matrices</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="matrices-with-parameters-and-constants.html"><a href="matrices-with-parameters-and-constants.html"><i class="fa fa-check"></i><b>19.5</b> Matrices with parameters and constants</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="functions-programming.html"><a href="functions-programming.html"><i class="fa fa-check"></i><b>20</b> User-Defined Functions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="basic-functions.html"><a href="basic-functions.html"><i class="fa fa-check"></i><b>20.1</b> Basic functions</a>
<ul>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#user-defined-functions-block"><i class="fa fa-check"></i>User-defined functions block</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#function-bodies"><i class="fa fa-check"></i>Function bodies</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#return-statements"><i class="fa fa-check"></i>Return statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#reject-statements"><i class="fa fa-check"></i>Reject statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#type-declarations-for-functions"><i class="fa fa-check"></i>Type declarations for functions</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#array-types-for-function-declarations"><i class="fa fa-check"></i>Array types for function declarations</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#data-only-function-arguments"><i class="fa fa-check"></i>Data-only function arguments</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="functions-as-statements.html"><a href="functions-as-statements.html"><i class="fa fa-check"></i><b>20.2</b> Functions as statements</a></li>
<li class="chapter" data-level="20.3" data-path="functions-accessing-the-log-probability-accumulator.html"><a href="functions-accessing-the-log-probability-accumulator.html"><i class="fa fa-check"></i><b>20.3</b> Functions accessing the log probability accumulator</a></li>
<li class="chapter" data-level="20.4" data-path="functions-acting-as-random-number-generators.html"><a href="functions-acting-as-random-number-generators.html"><i class="fa fa-check"></i><b>20.4</b> Functions acting as random number generators</a></li>
<li class="chapter" data-level="20.5" data-path="user-defined-probability-functions.html"><a href="user-defined-probability-functions.html"><i class="fa fa-check"></i><b>20.5</b> User-defined probability functions</a></li>
<li class="chapter" data-level="20.6" data-path="overloading-functions.html"><a href="overloading-functions.html"><i class="fa fa-check"></i><b>20.6</b> Overloading functions</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="overloading-functions.html"><a href="overloading-functions.html#warning-on-usage"><i class="fa fa-check"></i><b>20.6.1</b> Warning on usage</a></li>
<li class="chapter" data-level="20.6.2" data-path="overloading-functions.html"><a href="overloading-functions.html#function-resolution"><i class="fa fa-check"></i><b>20.6.2</b> Function resolution</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="documenting-functions.html"><a href="documenting-functions.html"><i class="fa fa-check"></i><b>20.7</b> Documenting functions</a></li>
<li class="chapter" data-level="20.8" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html"><i class="fa fa-check"></i><b>20.8</b> Summary of function types</a>
<ul>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#void-vs.-non-void-return"><i class="fa fa-check"></i>Void vs. non-void return</a></li>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#suffixed-or-non-suffixed"><i class="fa fa-check"></i>Suffixed or non-suffixed</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="recursive-functions.html"><a href="recursive-functions.html"><i class="fa fa-check"></i><b>20.9</b> Recursive functions</a></li>
<li class="chapter" data-level="20.10" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html"><i class="fa fa-check"></i><b>20.10</b> Truncated random number generation</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#generation-with-inverse-cdfs"><i class="fa fa-check"></i>Generation with inverse CDFs</a></li>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#truncated-variate-generation"><i class="fa fa-check"></i>Truncated variate generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="custom-probability-functions.html"><a href="custom-probability-functions.html"><i class="fa fa-check"></i><b>21</b> Custom Probability Functions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>21.1</b> Examples</a>
<ul>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#triangle-distribution"><i class="fa fa-check"></i>Triangle distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#bivariate-normal-cumulative-distribution-function"><i class="fa fa-check"></i>Bivariate normal cumulative distribution function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="proportionality-constants.html"><a href="proportionality-constants.html"><i class="fa fa-check"></i><b>22</b> Proportionality Constants</a>
<ul>
<li class="chapter" data-level="22.1" data-path="dropping-proportionality-constants.html"><a href="dropping-proportionality-constants.html"><i class="fa fa-check"></i><b>22.1</b> Dropping Proportionality Constants</a></li>
<li class="chapter" data-level="22.2" data-path="keeping-proportionality-constants.html"><a href="keeping-proportionality-constants.html"><i class="fa fa-check"></i><b>22.2</b> Keeping Proportionality Constants</a></li>
<li class="chapter" data-level="22.3" data-path="user-defined-distributions.html"><a href="user-defined-distributions.html"><i class="fa fa-check"></i><b>22.3</b> User-defined Distributions</a></li>
<li class="chapter" data-level="22.4" data-path="limitations-on-using-_lupdf-and-_lupmf-functions.html"><a href="limitations-on-using-_lupdf-and-_lupmf-functions.html"><i class="fa fa-check"></i><b>22.4</b> Limitations on Using <code>_lupdf</code> and <code>_lupmf</code> Functions</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="problematic-posteriors.html"><a href="problematic-posteriors.html"><i class="fa fa-check"></i><b>23</b> Problematic Posteriors</a>
<ul>
<li class="chapter" data-level="23.1" data-path="collinearity.html"><a href="collinearity.html"><i class="fa fa-check"></i><b>23.1</b> Collinearity of predictors in regressions</a>
<ul>
<li class="chapter" data-level="" data-path="collinearity.html"><a href="collinearity.html#examples-of-collinearity"><i class="fa fa-check"></i>Examples of collinearity</a></li>
<li class="chapter" data-level="" data-path="collinearity.html"><a href="collinearity.html#mitigating-the-invariances"><i class="fa fa-check"></i>Mitigating the invariances</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html"><i class="fa fa-check"></i><b>23.2</b> Label switching in mixture models</a>
<ul>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#mixture-models"><i class="fa fa-check"></i>Mixture models</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#convergence-monitoring-and-effective-sample-size"><i class="fa fa-check"></i>Convergence monitoring and effective sample size</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#some-inferences-are-invariant"><i class="fa fa-check"></i>Some inferences are invariant</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#highly-multimodal-posteriors"><i class="fa fa-check"></i>Highly multimodal posteriors</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#hacks-as-fixes"><i class="fa fa-check"></i>Hacks as fixes</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="component-collapsing-in-mixture-models.html"><a href="component-collapsing-in-mixture-models.html"><i class="fa fa-check"></i><b>23.3</b> Component collapsing in mixture models</a></li>
<li class="chapter" data-level="23.4" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html"><i class="fa fa-check"></i><b>23.4</b> Posteriors with unbounded densities</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#mixture-models-with-varying-scales"><i class="fa fa-check"></i>Mixture models with varying scales</a></li>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#beta-binomial-models-with-skewed-data-and-weak-priors"><i class="fa fa-check"></i>Beta-binomial models with skewed data and weak priors</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html"><i class="fa fa-check"></i><b>23.5</b> Posteriors with unbounded parameters</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html#separability-in-logistic-regression"><i class="fa fa-check"></i>Separability in logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="uniform-posteriors.html"><a href="uniform-posteriors.html"><i class="fa fa-check"></i><b>23.6</b> Uniform posteriors</a></li>
<li class="chapter" data-level="23.7" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html"><i class="fa fa-check"></i><b>23.7</b> Sampling difficulties with problematic priors</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#gibbs-sampling"><i class="fa fa-check"></i>Gibbs sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#hamiltonian-monte-carlo-sampling"><i class="fa fa-check"></i>Hamiltonian Monte Carlo sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#no-u-turn-sampling"><i class="fa fa-check"></i>No-U-turn sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#examples-fits-in-stan"><i class="fa fa-check"></i>Examples: fits in Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="change-of-variables.html"><a href="change-of-variables.html"><i class="fa fa-check"></i><b>24</b> Reparameterization and Change of Variables</a>
<ul>
<li class="chapter" data-level="24.1" data-path="theoretical-and-practical-background.html"><a href="theoretical-and-practical-background.html"><i class="fa fa-check"></i><b>24.1</b> Theoretical and practical background</a></li>
<li class="chapter" data-level="24.2" data-path="reparameterizations.html"><a href="reparameterizations.html"><i class="fa fa-check"></i><b>24.2</b> Reparameterizations</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#beta-and-dirichlet-priors"><i class="fa fa-check"></i>Beta and Dirichlet priors</a></li>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#transforming-unconstrained-priors-probit-and-logit"><i class="fa fa-check"></i>Transforming unconstrained priors: probit and logit</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="changes-of-variables.html"><a href="changes-of-variables.html"><i class="fa fa-check"></i><b>24.3</b> Changes of variables</a>
<ul>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#change-of-variables-vs.-transformations"><i class="fa fa-check"></i>Change of variables vs. transformations</a></li>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#multivariate-changes-of-variables"><i class="fa fa-check"></i>Multivariate changes of variables</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html"><i class="fa fa-check"></i><b>24.4</b> Vectors with varying bounds</a>
<ul>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-lower-bounds"><i class="fa fa-check"></i>Varying lower bounds</a></li>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-upper-and-lower-bounds"><i class="fa fa-check"></i>Varying upper and lower bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="efficiency-tuning.html"><a href="efficiency-tuning.html"><i class="fa fa-check"></i><b>25</b> Efficiency Tuning</a>
<ul>
<li class="chapter" data-level="25.1" data-path="what-is-efficiency.html"><a href="what-is-efficiency.html"><i class="fa fa-check"></i><b>25.1</b> What is efficiency?</a></li>
<li class="chapter" data-level="25.2" data-path="efficiency-for-probabilistic-models-and-algorithms.html"><a href="efficiency-for-probabilistic-models-and-algorithms.html"><i class="fa fa-check"></i><b>25.2</b> Efficiency for probabilistic models and algorithms</a></li>
<li class="chapter" data-level="25.3" data-path="statistical-vs.-computational-efficiency.html"><a href="statistical-vs.-computational-efficiency.html"><i class="fa fa-check"></i><b>25.3</b> Statistical vs.  computational efficiency</a></li>
<li class="chapter" data-level="25.4" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html"><i class="fa fa-check"></i><b>25.4</b> Model conditioning and curvature</a>
<ul>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#condition-number-and-adaptation"><i class="fa fa-check"></i>Condition number and adaptation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#unit-scales-without-correlation"><i class="fa fa-check"></i>Unit scales without correlation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#varying-curvature"><i class="fa fa-check"></i>Varying curvature</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#reparameterizing-with-a-change-of-variables"><i class="fa fa-check"></i>Reparameterizing with a change of variables</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="well-specified-models.html"><a href="well-specified-models.html"><i class="fa fa-check"></i><b>25.5</b> Well-specified models</a></li>
<li class="chapter" data-level="25.6" data-path="avoiding-validation.html"><a href="avoiding-validation.html"><i class="fa fa-check"></i><b>25.6</b> Avoiding validation</a></li>
<li class="chapter" data-level="25.7" data-path="reparameterization.html"><a href="reparameterization.html"><i class="fa fa-check"></i><b>25.7</b> Reparameterization</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#funnel.figure"><i class="fa fa-check"></i>Example: Neal’s funnel</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#reparameterizing-the-cauchy"><i class="fa fa-check"></i>Reparameterizing the Cauchy</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#reparameterizing-a-student-t-distribution"><i class="fa fa-check"></i>Reparameterizing a Student-t distribution</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#hierarchical-models-and-the-non-centered-parameterization"><i class="fa fa-check"></i>Hierarchical models and the non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#non-centered-parameterization"><i class="fa fa-check"></i>Non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#multivariate-reparameterizations"><i class="fa fa-check"></i>Multivariate reparameterizations</a></li>
</ul></li>
<li class="chapter" data-level="25.8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>25.8</b> Vectorization</a>
<ul>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#gradient-bottleneck"><i class="fa fa-check"></i>Gradient bottleneck</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorizing-summations"><i class="fa fa-check"></i>Vectorizing summations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorization-through-matrix-operations"><i class="fa fa-check"></i>Vectorization through matrix operations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorized-probability-functions"><i class="fa fa-check"></i>Vectorized probability functions</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#reshaping-data-for-vectorization"><i class="fa fa-check"></i>Reshaping data for vectorization</a></li>
</ul></li>
<li class="chapter" data-level="25.9" data-path="exploiting-sufficient-statistics.html"><a href="exploiting-sufficient-statistics.html"><i class="fa fa-check"></i><b>25.9</b> Exploiting sufficient statistics</a></li>
<li class="chapter" data-level="25.10" data-path="aggregating-common-subexpressions.html"><a href="aggregating-common-subexpressions.html"><i class="fa fa-check"></i><b>25.10</b> Aggregating common subexpressions</a></li>
<li class="chapter" data-level="25.11" data-path="exploiting-conjugacy.html"><a href="exploiting-conjugacy.html"><i class="fa fa-check"></i><b>25.11</b> Exploiting conjugacy</a></li>
<li class="chapter" data-level="25.12" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html"><i class="fa fa-check"></i><b>25.12</b> Standardizing predictors and outputs</a>
<ul>
<li class="chapter" data-level="" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html#standard-normal-distribution"><i class="fa fa-check"></i>Standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="25.13" data-path="using-map-reduce.html"><a href="using-map-reduce.html"><i class="fa fa-check"></i><b>25.13</b> Using map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>26</b> Parallelization</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reduce-sum.html"><a href="reduce-sum.html"><i class="fa fa-check"></i><b>26.1</b> Reduce-sum</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reduce-sum.html"><a href="reduce-sum.html#example-logistic-regression"><i class="fa fa-check"></i><b>26.1.1</b> Example: logistic regression</a></li>
<li class="chapter" data-level="26.1.2" data-path="reduce-sum.html"><a href="reduce-sum.html#reduce-sum-grainsize"><i class="fa fa-check"></i><b>26.1.2</b> Picking the grainsize</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="map-rect.html"><a href="map-rect.html"><i class="fa fa-check"></i><b>26.2</b> Map-rect</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="map-rect.html"><a href="map-rect.html#map-function"><i class="fa fa-check"></i><b>26.2.1</b> Map function</a></li>
<li class="chapter" data-level="" data-path="map-rect.html"><a href="map-rect.html#map-function-signature"><i class="fa fa-check"></i>Map function signature</a></li>
<li class="chapter" data-level="26.2.2" data-path="map-rect.html"><a href="map-rect.html#example-logistic-regression-1"><i class="fa fa-check"></i><b>26.2.2</b> Example: logistic regression</a></li>
<li class="chapter" data-level="26.2.3" data-path="map-rect.html"><a href="map-rect.html#example-hierarchical-logistic-regression"><i class="fa fa-check"></i><b>26.2.3</b> Example: hierarchical logistic regression</a></li>
<li class="chapter" data-level="26.2.4" data-path="map-rect.html"><a href="map-rect.html#ragged-inputs-and-outputs"><i class="fa fa-check"></i><b>26.2.4</b> Ragged inputs and outputs</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="opencl.html"><a href="opencl.html"><i class="fa fa-check"></i><b>26.3</b> OpenCL</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meta-models.html"><a href="meta-models.html"><i class="fa fa-check"></i><i style="font-size: 110%; color:#990017;">Part 3. Posterior Inference &amp; Model Checking</i></a></li>
<li class="chapter" data-level="27" data-path="posterior-prediction.html"><a href="posterior-prediction.html"><i class="fa fa-check"></i><b>27</b> Posterior Predictive Sampling</a>
<ul>
<li class="chapter" data-level="27.1" data-path="posterior-predictive-distribution.html"><a href="posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.1</b> Posterior predictive distribution</a></li>
<li class="chapter" data-level="27.2" data-path="computing-the-posterior-predictive-distribution.html"><a href="computing-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.2</b> Computing the posterior predictive distribution</a></li>
<li class="chapter" data-level="27.3" data-path="sampling-from-the-posterior-predictive-distribution.html"><a href="sampling-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.3</b> Sampling from the posterior predictive distribution</a></li>
<li class="chapter" data-level="27.4" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html"><i class="fa fa-check"></i><b>27.4</b> Posterior predictive simulation in Stan</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#simple-poisson-model"><i class="fa fa-check"></i><b>27.4.1</b> Simple Poisson model</a></li>
<li class="chapter" data-level="27.4.2" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#stan-code"><i class="fa fa-check"></i><b>27.4.2</b> Stan code</a></li>
<li class="chapter" data-level="27.4.3" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#analytic-posterior-and-posterior-predictive"><i class="fa fa-check"></i><b>27.4.3</b> Analytic posterior and posterior predictive</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html"><i class="fa fa-check"></i><b>27.5</b> Posterior prediction for regressions</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#posterior-predictive-distributions-for-regressions"><i class="fa fa-check"></i><b>27.5.1</b> Posterior predictive distributions for regressions</a></li>
<li class="chapter" data-level="27.5.2" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#stan-program"><i class="fa fa-check"></i><b>27.5.2</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="estimating-event-probabilities.html"><a href="estimating-event-probabilities.html"><i class="fa fa-check"></i><b>27.6</b> Estimating event probabilities</a></li>
<li class="chapter" data-level="27.7" data-path="stand-alone-generated-quantities-and-ongoing-prediction.html"><a href="stand-alone-generated-quantities-and-ongoing-prediction.html"><i class="fa fa-check"></i><b>27.7</b> Stand-alone generated quantities and ongoing prediction</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="simulation-based-calibration.html"><a href="simulation-based-calibration.html"><i class="fa fa-check"></i><b>28</b> Simulation-Based Calibration</a>
<ul>
<li class="chapter" data-level="28.1" data-path="bayes-is-calibrated-by-construction.html"><a href="bayes-is-calibrated-by-construction.html"><i class="fa fa-check"></i><b>28.1</b> Bayes is calibrated by construction</a></li>
<li class="chapter" data-level="28.2" data-path="simulation-based-calibration-1.html"><a href="simulation-based-calibration-1.html"><i class="fa fa-check"></i><b>28.2</b> Simulation-based calibration</a></li>
<li class="chapter" data-level="28.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html"><i class="fa fa-check"></i><b>28.3</b> SBC in Stan</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#example-model"><i class="fa fa-check"></i><b>28.3.1</b> Example model</a></li>
<li class="chapter" data-level="28.3.2" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#testing-a-stan-program-with-simulation-based-calibration"><i class="fa fa-check"></i><b>28.3.2</b> Testing a Stan program with simulation-based calibration</a></li>
<li class="chapter" data-level="28.3.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#pseudocode-for-simulation-based-calibration"><i class="fa fa-check"></i><b>28.3.3</b> Pseudocode for simulation-based calibration</a></li>
<li class="chapter" data-level="28.3.4" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#the-importance-of-thinning"><i class="fa fa-check"></i><b>28.3.4</b> The importance of thinning</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="testing-uniformity.html"><a href="testing-uniformity.html"><i class="fa fa-check"></i><b>28.4</b> Testing uniformity</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="testing-uniformity.html"><a href="testing-uniformity.html#indexing-to-simplify-arithmetic"><i class="fa fa-check"></i><b>28.4.1</b> Indexing to simplify arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html"><i class="fa fa-check"></i><b>28.5</b> Examples of simulation-based calibration</a>
<ul>
<li class="chapter" data-level="28.5.1" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-right"><i class="fa fa-check"></i><b>28.5.1</b> When things go right</a></li>
<li class="chapter" data-level="28.5.2" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-wrong"><i class="fa fa-check"></i><b>28.5.2</b> When things go wrong</a></li>
<li class="chapter" data-level="28.5.3" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-stans-sampler-goes-wrong"><i class="fa fa-check"></i><b>28.5.3</b> When Stan’s sampler goes wrong</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ppcs.html"><a href="ppcs.html"><i class="fa fa-check"></i><b>29</b> Posterior and Prior Predictive Checks</a>
<ul>
<li class="chapter" data-level="29.1" data-path="simulating-from-the-posterior-predictive-distribution.html"><a href="simulating-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>29.1</b> Simulating from the posterior predictive distribution</a></li>
<li class="chapter" data-level="29.2" data-path="plotting-multiples.html"><a href="plotting-multiples.html"><i class="fa fa-check"></i><b>29.2</b> Plotting multiples</a></li>
<li class="chapter" data-level="29.3" data-path="posterior-p-values.html"><a href="posterior-p-values.html"><i class="fa fa-check"></i><b>29.3</b> Posterior ``p-values’’</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="posterior-p-values.html"><a href="posterior-p-values.html#which-statistics-to-test"><i class="fa fa-check"></i><b>29.3.1</b> Which statistics to test?</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html"><i class="fa fa-check"></i><b>29.4</b> Prior predictive checks</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html#coding-prior-predictive-checks-in-stan"><i class="fa fa-check"></i><b>29.4.1</b> Coding prior predictive checks in Stan</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="example-of-prior-predictive-checks.html"><a href="example-of-prior-predictive-checks.html"><i class="fa fa-check"></i><b>29.5</b> Example of prior predictive checks</a></li>
<li class="chapter" data-level="29.6" data-path="mixed-replication.html"><a href="mixed-replication.html"><i class="fa fa-check"></i><b>29.6</b> Mixed predictive replication for hierarchical models</a></li>
<li class="chapter" data-level="29.7" data-path="joint-model-representation.html"><a href="joint-model-representation.html"><i class="fa fa-check"></i><b>29.7</b> Joint model representation</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="joint-model-representation.html"><a href="joint-model-representation.html#posterior-predictive-model"><i class="fa fa-check"></i><b>29.7.1</b> Posterior predictive model</a></li>
<li class="chapter" data-level="29.7.2" data-path="joint-model-representation.html"><a href="joint-model-representation.html#prior-predictive-model"><i class="fa fa-check"></i><b>29.7.2</b> Prior predictive model</a></li>
<li class="chapter" data-level="29.7.3" data-path="joint-model-representation.html"><a href="joint-model-representation.html#mixed-replication-for-hierarchical-models"><i class="fa fa-check"></i><b>29.7.3</b> Mixed replication for hierarchical models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="held-out-evaluation-and-cross-validation.html"><a href="held-out-evaluation-and-cross-validation.html"><i class="fa fa-check"></i><b>30</b> Held-Out Evaluation and Cross-Validation</a>
<ul>
<li class="chapter" data-level="30.1" data-path="evaluating-posterior-predictive.html"><a href="evaluating-posterior-predictive.html"><i class="fa fa-check"></i><b>30.1</b> Evaluating posterior predictive densities</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="evaluating-posterior-predictive.html"><a href="evaluating-posterior-predictive.html#stan-program-1"><i class="fa fa-check"></i><b>30.1.1</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="estimation-error.html"><a href="estimation-error.html"><i class="fa fa-check"></i><b>30.2</b> Estimation error</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="estimation-error.html"><a href="estimation-error.html#parameter-estimates"><i class="fa fa-check"></i><b>30.2.1</b> Parameter estimates</a></li>
<li class="chapter" data-level="30.2.2" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates"><i class="fa fa-check"></i><b>30.2.2</b> Predictive estimates</a></li>
<li class="chapter" data-level="30.2.3" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates-in-stan"><i class="fa fa-check"></i><b>30.2.3</b> Predictive estimates in Stan</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>30.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="cross-validation.html"><a href="cross-validation.html#stan-implementation-with-random-folds"><i class="fa fa-check"></i><b>30.3.1</b> Stan implementation with random folds</a></li>
<li class="chapter" data-level="30.3.2" data-path="cross-validation.html"><a href="cross-validation.html#user-defined-permutations"><i class="fa fa-check"></i><b>30.3.2</b> User-defined permutations</a></li>
<li class="chapter" data-level="30.3.3" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-structured-data"><i class="fa fa-check"></i><b>30.3.3</b> Cross-validation with structured data</a></li>
<li class="chapter" data-level="30.3.4" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-spatio-temporal-data"><i class="fa fa-check"></i><b>30.3.4</b> Cross-validation with spatio-temporal data</a></li>
<li class="chapter" data-level="30.3.5" data-path="cross-validation.html"><a href="cross-validation.html#approximate-cross-validation"><i class="fa fa-check"></i><b>30.3.5</b> Approximate cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="poststratification.html"><a href="poststratification.html"><i class="fa fa-check"></i><b>31</b> Poststratification</a>
<ul>
<li class="chapter" data-level="31.1" data-path="some-examples.html"><a href="some-examples.html"><i class="fa fa-check"></i><b>31.1</b> Some examples</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="some-examples.html"><a href="some-examples.html#earth-science"><i class="fa fa-check"></i><b>31.1.1</b> Earth science</a></li>
<li class="chapter" data-level="31.1.2" data-path="some-examples.html"><a href="some-examples.html#polling"><i class="fa fa-check"></i><b>31.1.2</b> Polling</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="bayesian-poststratification.html"><a href="bayesian-poststratification.html"><i class="fa fa-check"></i><b>31.2</b> Bayesian poststratification</a></li>
<li class="chapter" data-level="31.3" data-path="poststratification-in-stan.html"><a href="poststratification-in-stan.html"><i class="fa fa-check"></i><b>31.3</b> Poststratification in Stan</a></li>
<li class="chapter" data-level="31.4" data-path="regression-and-poststratification.html"><a href="regression-and-poststratification.html"><i class="fa fa-check"></i><b>31.4</b> Regression and poststratification</a></li>
<li class="chapter" data-level="31.5" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>31.5</b> Multilevel regression and poststratification</a>
<ul>
<li class="chapter" data-level="31.5.1" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html#dealing-with-small-partitions-and-non-identifiability"><i class="fa fa-check"></i><b>31.5.1</b> Dealing with small partitions and non-identifiability</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html"><i class="fa fa-check"></i><b>31.6</b> Coding MRP in Stan</a>
<ul>
<li class="chapter" data-level="31.6.1" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#binomial-coding"><i class="fa fa-check"></i><b>31.6.1</b> Binomial coding</a></li>
<li class="chapter" data-level="31.6.2" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#coding-binary-groups"><i class="fa fa-check"></i><b>31.6.2</b> Coding binary groups</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="adding-group-level-predictors.html"><a href="adding-group-level-predictors.html"><i class="fa fa-check"></i><b>31.7</b> Adding group-level predictors</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="decision-analysis.html"><a href="decision-analysis.html"><i class="fa fa-check"></i><b>32</b> Decision Analysis</a>
<ul>
<li class="chapter" data-level="32.1" data-path="outline-of-decision-analysis.html"><a href="outline-of-decision-analysis.html"><i class="fa fa-check"></i><b>32.1</b> Outline of decision analysis</a></li>
<li class="chapter" data-level="32.2" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html"><i class="fa fa-check"></i><b>32.2</b> Example decision analysis</a>
<ul>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-1.-define-decisions-and-outcomes"><i class="fa fa-check"></i>Step 1. Define decisions and outcomes</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-2.-define-density-of-outcome-conditioned-on-decision"><i class="fa fa-check"></i>Step 2. Define density of outcome conditioned on decision</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-3.-define-the-utility-function"><i class="fa fa-check"></i>Step 3. Define the utility function</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-4.-maximize-expected-utility"><i class="fa fa-check"></i>Step 4. Maximize expected utility</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="continuous-choices.html"><a href="continuous-choices.html"><i class="fa fa-check"></i><b>32.3</b> Continuous choices</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="the-bootstrap-and-bagging.html"><a href="the-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>33</b> The Bootstrap and Bagging</a>
<ul>
<li class="chapter" data-level="33.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>33.1</b> The bootstrap</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html#estimators"><i class="fa fa-check"></i><b>33.1.1</b> Estimators</a></li>
<li class="chapter" data-level="33.1.2" data-path="the-bootstrap.html"><a href="the-bootstrap.html#the-bootstrap-in-pseudocode"><i class="fa fa-check"></i><b>33.1.2</b> The bootstrap in pseudocode</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="coding-the-bootstrap-in-stan.html"><a href="coding-the-bootstrap-in-stan.html"><i class="fa fa-check"></i><b>33.2</b> Coding the bootstrap in Stan</a></li>
<li class="chapter" data-level="33.3" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html"><i class="fa fa-check"></i><b>33.3</b> Error statistics from the bootstrap</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#standard-errors"><i class="fa fa-check"></i><b>33.3.1</b> Standard errors</a></li>
<li class="chapter" data-level="33.3.2" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#confidence-intervals"><i class="fa fa-check"></i><b>33.3.2</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>33.4</b> Bagging</a></li>
<li class="chapter" data-level="33.5" data-path="bayesian-bootstrap-and-bagging.html"><a href="bayesian-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>33.5</b> Bayesian bootstrap and bagging</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendices.html"><a href="appendices.html"><i class="fa fa-check"></i><i style="font-size: 110%; color:#990017;">Appendices</i></a></li>
<li class="chapter" data-level="34" data-path="using-the-stan-compiler.html"><a href="using-the-stan-compiler.html"><i class="fa fa-check"></i><b>34</b> Using the Stan Compiler</a>
<ul>
<li class="chapter" data-level="34.1" data-path="stanc-args.html"><a href="stanc-args.html"><i class="fa fa-check"></i><b>34.1</b> Command-line options for stanc3</a></li>
<li class="chapter" data-level="34.2" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html"><i class="fa fa-check"></i><b>34.2</b> Understanding stanc3 errors and warnings</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html#warnings"><i class="fa fa-check"></i><b>34.2.1</b> Warnings</a></li>
<li class="chapter" data-level="34.2.2" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html#errors"><i class="fa fa-check"></i><b>34.2.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="pedantic-mode.html"><a href="pedantic-mode.html"><i class="fa fa-check"></i><b>34.3</b> Pedantic mode</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="pedantic-mode.html"><a href="pedantic-mode.html#distribution-argument-and-variate-constraint-issues"><i class="fa fa-check"></i><b>34.3.1</b> Distribution argument and variate constraint issues</a></li>
<li class="chapter" data-level="34.3.2" data-path="pedantic-mode.html"><a href="pedantic-mode.html#special-case-distribution-issues"><i class="fa fa-check"></i><b>34.3.2</b> Special-case distribution issues</a></li>
<li class="chapter" data-level="34.3.3" data-path="pedantic-mode.html"><a href="pedantic-mode.html#unused-parameters"><i class="fa fa-check"></i><b>34.3.3</b> Unused parameters</a></li>
<li class="chapter" data-level="34.3.4" data-path="pedantic-mode.html"><a href="pedantic-mode.html#large-or-small-constants-in-a-distribution"><i class="fa fa-check"></i><b>34.3.4</b> Large or small constants in a distribution</a></li>
<li class="chapter" data-level="34.3.5" data-path="pedantic-mode.html"><a href="pedantic-mode.html#control-flow-depends-on-a-parameter"><i class="fa fa-check"></i><b>34.3.5</b> Control flow depends on a parameter</a></li>
<li class="chapter" data-level="34.3.6" data-path="pedantic-mode.html"><a href="pedantic-mode.html#parameters-with-multiple-tildes"><i class="fa fa-check"></i><b>34.3.6</b> Parameters with multiple tildes</a></li>
<li class="chapter" data-level="34.3.7" data-path="pedantic-mode.html"><a href="pedantic-mode.html#parameters-with-zero-or-multiple-priors"><i class="fa fa-check"></i><b>34.3.7</b> Parameters with zero or multiple priors</a></li>
<li class="chapter" data-level="34.3.8" data-path="pedantic-mode.html"><a href="pedantic-mode.html#variables-used-before-assignment"><i class="fa fa-check"></i><b>34.3.8</b> Variables used before assignment</a></li>
<li class="chapter" data-level="34.3.9" data-path="pedantic-mode.html"><a href="pedantic-mode.html#strict-or-nonsensical-parameter-bounds"><i class="fa fa-check"></i><b>34.3.9</b> Strict or nonsensical parameter bounds</a></li>
<li class="chapter" data-level="34.3.10" data-path="pedantic-mode.html"><a href="pedantic-mode.html#nonlinear-transformations"><i class="fa fa-check"></i><b>34.3.10</b> Nonlinear transformations</a></li>
<li class="chapter" data-level="34.3.11" data-path="pedantic-mode.html"><a href="pedantic-mode.html#pedantic-mode-limitations"><i class="fa fa-check"></i><b>34.3.11</b> Pedantic mode limitations</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html"><i class="fa fa-check"></i><b>34.4</b> Automatic updating and formatting of Stan programs</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#automatic-formatting"><i class="fa fa-check"></i><b>34.4.1</b> Automatic formatting</a></li>
<li class="chapter" data-level="34.4.2" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#canonicalizing"><i class="fa fa-check"></i><b>34.4.2</b> Canonicalizing</a></li>
<li class="chapter" data-level="34.4.3" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#known-issues"><i class="fa fa-check"></i><b>34.4.3</b> Known issues</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>34.5</b> Optimization</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="optimization.html"><a href="optimization.html#optimization-levels"><i class="fa fa-check"></i><b>34.5.1</b> Optimization levels</a></li>
<li class="chapter" data-level="34.5.2" data-path="optimization.html"><a href="optimization.html#o1-optimizations"><i class="fa fa-check"></i><b>34.5.2</b> <strong>O1</strong> Optimizations</a></li>
<li class="chapter" data-level="34.5.3" data-path="optimization.html"><a href="optimization.html#oexperimental-optimizations"><i class="fa fa-check"></i><b>34.5.3</b> <strong>Oexperimental</strong> Optimizations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="stan-program-style-guide.html"><a href="stan-program-style-guide.html"><i class="fa fa-check"></i><b>35</b> Stan Program Style Guide</a>
<ul>
<li class="chapter" data-level="35.1" data-path="choose-a-consistent-style.html"><a href="choose-a-consistent-style.html"><i class="fa fa-check"></i><b>35.1</b> Choose a consistent style</a></li>
<li class="chapter" data-level="35.2" data-path="line-length.html"><a href="line-length.html"><i class="fa fa-check"></i><b>35.2</b> Line length</a></li>
<li class="chapter" data-level="35.3" data-path="file-extensions.html"><a href="file-extensions.html"><i class="fa fa-check"></i><b>35.3</b> File extensions</a></li>
<li class="chapter" data-level="35.4" data-path="variable-naming.html"><a href="variable-naming.html"><i class="fa fa-check"></i><b>35.4</b> Variable naming</a></li>
<li class="chapter" data-level="35.5" data-path="local-variable-scope.html"><a href="local-variable-scope.html"><i class="fa fa-check"></i><b>35.5</b> Local variable scope</a></li>
<li class="chapter" data-level="35.6" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html"><i class="fa fa-check"></i><b>35.6</b> Parentheses and brackets</a>
<ul>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#braces-for-single-statement-blocks"><i class="fa fa-check"></i>Braces for single-statement blocks</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#parentheses-in-nested-operator-expressions"><i class="fa fa-check"></i>Parentheses in nested operator expressions</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#no-open-brackets-on-own-line"><i class="fa fa-check"></i>No open brackets on own line</a></li>
</ul></li>
<li class="chapter" data-level="35.7" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>35.7</b> Conditionals</a></li>
<li class="chapter" data-level="35.8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>35.8</b> Functions</a></li>
<li class="chapter" data-level="35.9" data-path="white-space.html"><a href="white-space.html"><i class="fa fa-check"></i><b>35.9</b> White space</a>
<ul>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#line-breaks-between-statements-and-declarations"><i class="fa fa-check"></i>Line breaks between statements and declarations</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-tabs"><i class="fa fa-check"></i>No tabs</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#two-character-indents"><i class="fa fa-check"></i>Two-character indents</a></li>
<li class="chapter" data-level="35.9.1" data-path="white-space.html"><a href="white-space.html#space-between-if-and-condition"><i class="fa fa-check"></i><b>35.9.1</b> Space between <code>if</code>, <code>{</code> and condition</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-space-for-function-calls"><i class="fa fa-check"></i>No space for function calls</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-around-operators"><i class="fa fa-check"></i>Spaces around operators</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-spaces-in-type-constraints"><i class="fa fa-check"></i>No spaces in type constraints</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#breaking-expressions-across-lines"><i class="fa fa-check"></i>Breaking expressions across lines</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-after-commas"><i class="fa fa-check"></i>Spaces after commas</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#unix-newlines"><i class="fa fa-check"></i>Unix newlines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="36" data-path="stan-for-bugs.html"><a href="stan-for-bugs.html"><i class="fa fa-check"></i><b>36</b> Transitioning from BUGS</a>
<ul>
<li class="chapter" data-level="36.1" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html"><i class="fa fa-check"></i><b>36.1</b> Some differences in how BUGS and Stan work</a>
<ul>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-is-interpreted-stan-is-compiled"><i class="fa fa-check"></i>BUGS is interpreted, Stan is compiled</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-performs-mcmc-updating-one-scalar-parameter-at-a-time-stan-uses-hmc-which-moves-in-the-entire-space-of-all-the-parameters-at-each-step"><i class="fa fa-check"></i>BUGS performs MCMC updating one scalar parameter at a time, Stan uses HMC which moves in the entire space of all the parameters at each step</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-tuning-during-warmup"><i class="fa fa-check"></i>Differences in tuning during warmup</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#the-stan-language-is-directly-executable-the-bugs-modeling-language-is-not"><i class="fa fa-check"></i>The Stan language is directly executable, the BUGS modeling language is not</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-statement-order"><i class="fa fa-check"></i>Differences in statement order</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#stan-computes-the-gradient-of-the-log-density-bugs-computes-the-log-density-but-not-its-gradient"><i class="fa fa-check"></i>Stan computes the gradient of the log density, BUGS computes the log density but not its gradient</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#both-bugs-and-stan-are-semi-automatic"><i class="fa fa-check"></i>Both BUGS and Stan are semi-automatic</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#licensing"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#interfaces"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#platforms"><i class="fa fa-check"></i>Platforms</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="some-differences-in-the-modeling-languages.html"><a href="some-differences-in-the-modeling-languages.html"><i class="fa fa-check"></i><b>36.2</b> Some differences in the modeling languages</a></li>
<li class="chapter" data-level="36.3" data-path="some-differences-in-the-statistical-models-that-are-allowed.html"><a href="some-differences-in-the-statistical-models-that-are-allowed.html"><i class="fa fa-check"></i><b>36.3</b> Some differences in the statistical models that are allowed</a></li>
<li class="chapter" data-level="36.4" data-path="some-differences-when-running-from-r.html"><a href="some-differences-when-running-from-r.html"><i class="fa fa-check"></i><b>36.4</b> Some differences when running from R</a></li>
<li class="chapter" data-level="36.5" data-path="the-stan-community.html"><a href="the-stan-community.html"><i class="fa fa-check"></i><b>36.5</b> The Stan community</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div>
This is an old version, <a href="https://mc-stan.org/docs/stan-users-guide/gaussian-processes.html#fit-gp.section">view current version</a>.
</div>
<div id="fit-gp.section" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Fitting a Gaussian process<a href="fit-gp.html#fit-gp.section" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="gp-with-a-normal-outcome" class="section level3 unnumbered hasAnchor">
<h3>GP with a normal outcome<a href="fit-gp.html#gp-with-a-normal-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The full generative model for a GP with a normal outcome,
<span class="math inline">\(y \in \mathbb{R}^N\)</span>, with inputs <span class="math inline">\(x \in \mathbb{R}^N\)</span>, for a finite <span class="math inline">\(N\)</span>:
<span class="math display">\[\begin{align*}
\rho   &amp;\sim \textsf{InvGamma}(5, 5) \\
\alpha &amp;\sim \textsf{normal}(0, 1) \\
\sigma &amp;\sim \textsf{normal}(0, 1) \\
f      &amp;\sim \textsf{multivariate normal}\left(0, K(x \mid \alpha, \rho)\right) \\
y_i    &amp;\sim \textsf{normal}(f_i, \sigma) \, \forall i \in \{1, \dots, N\}
\end{align*}\]</span>
With a normal outcome, it is possible to integrate out the Gaussian
process <span class="math inline">\(f\)</span>, yielding the more parsimonious model:
<span class="math display">\[\begin{align*}
\rho   &amp;\sim \textsf{InvGamma}(5, 5) \\
\alpha &amp;\sim \textsf{normal}(0, 1) \\
\sigma &amp;\sim \textsf{normal}(0, 1) \\
y      &amp;\sim \textsf{multivariate normal}
         \left(0, K(x \mid \alpha, \rho) + \textbf{I}_N \sigma^2\right) \\
\end{align*}\]</span></p>
<p>It can be more computationally efficient when dealing with a normal
outcome to integrate out the Gaussian process, because this yields a
lower-dimensional parameter space over which to do inference. We’ll fit
both models in Stan. The former model will be referred to as the latent
variable GP, while the latter will be called the marginal likelihood
GP.</p>
<p>The hyperparameters controlling the covariance function of a Gaussian
process can be fit by assigning them priors, like we have in the
generative models above, and then computing the posterior distribution
of the hyperparameters given observed data. The priors on the
parameters should be defined based on prior knowledge of the scale of
the output values (<span class="math inline">\(\alpha\)</span>), the scale of the output noise
(<span class="math inline">\(\sigma\)</span>), and the scale at which distances are measured among inputs
(<span class="math inline">\(\rho\)</span>). See the <a href="fit-gp.html#priors-gp.section">Gaussian process priors section</a>
for more information about how to specify
appropriate priors for the hyperparameters.</p>
<p>The Stan program implementing the marginal likelihood GP is shown below. The
program is similar to the Stan programs that implement the simulation GPs
above, but because we are doing inference on the hyperparameters, we need to
calculate the covariance matrix <code>K</code> in the model block, rather than
the transformed data block.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb161-1"><a href="fit-gp.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb161-2"><a href="fit-gp.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;</span>
<span id="cb161-3"><a href="fit-gp.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> x;</span>
<span id="cb161-4"><a href="fit-gp.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] y;</span>
<span id="cb161-5"><a href="fit-gp.html#cb161-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-6"><a href="fit-gp.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb161-7"><a href="fit-gp.html#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] mu = rep_vector(<span class="dv">0</span>, N);</span>
<span id="cb161-8"><a href="fit-gp.html#cb161-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-9"><a href="fit-gp.html#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb161-10"><a href="fit-gp.html#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb161-11"><a href="fit-gp.html#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb161-12"><a href="fit-gp.html#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb161-13"><a href="fit-gp.html#cb161-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-14"><a href="fit-gp.html#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb161-15"><a href="fit-gp.html#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N, N] L_K;</span>
<span id="cb161-16"><a href="fit-gp.html#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N, N] K = cov_exp_quad(x, alpha, rho);</span>
<span id="cb161-17"><a href="fit-gp.html#cb161-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> sq_sigma = square(sigma);</span>
<span id="cb161-18"><a href="fit-gp.html#cb161-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-19"><a href="fit-gp.html#cb161-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// diagonal elements</span></span>
<span id="cb161-20"><a href="fit-gp.html#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb161-21"><a href="fit-gp.html#cb161-21" aria-hidden="true" tabindex="-1"></a>    K[n, n] = K[n, n] + sq_sigma;</span>
<span id="cb161-22"><a href="fit-gp.html#cb161-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb161-23"><a href="fit-gp.html#cb161-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-24"><a href="fit-gp.html#cb161-24" aria-hidden="true" tabindex="-1"></a>  L_K = cholesky_decompose(K);</span>
<span id="cb161-25"><a href="fit-gp.html#cb161-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-26"><a href="fit-gp.html#cb161-26" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb161-27"><a href="fit-gp.html#cb161-27" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb161-28"><a href="fit-gp.html#cb161-28" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb161-29"><a href="fit-gp.html#cb161-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-30"><a href="fit-gp.html#cb161-30" aria-hidden="true" tabindex="-1"></a>  y ~ multi_normal_cholesky(mu, L_K);</span>
<span id="cb161-31"><a href="fit-gp.html#cb161-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The data block declares a vector <code>y</code> of observed values <code>y[n]</code>
for inputs <code>x[n]</code>. The transformed data block now only defines the mean
vector to be zero. The three hyperparameters are defined as parameters
constrained to be non-negative. The computation of the covariance matrix
<code>K</code> is now in the model block because it involves unknown parameters and
thus can’t simply be precomputed as transformed data. The rest of the model
consists of the priors for the hyperparameters and the multivariate
Cholesky-parameterized normal likelihood, only now the value <code>y</code> is known
and the covariance matrix <code>K</code> is an unknown dependent on the
hyperparameters, allowing us to learn the hyperparameters.</p>
<p>We have used the Cholesky parameterized multivariate normal rather
than the standard parameterization because it allows us to the
<code>cholesky_decompose</code> function which has been optimized for both small
and large matrices. When working with small matrices the differences
in computational speed between the two approaches will not be
noticeable, but for larger matrices (<span class="math inline">\(N \gtrsim 100\)</span>) the Cholesky
decomposition version will be faster.</p>
<p>Hamiltonian Monte Carlo sampling is fast and effective for hyperparameter
inference in this model <span class="citation">(<a href="#ref-Neal:1997" role="doc-biblioref">Neal 1997</a>)</span>. If the posterior is
well-concentrated for the hyperparameters the Stan implementation will fit
hyperparameters in models with a few hundred data points in seconds.</p>
<div id="latent-variable-gp" class="section level4 unnumbered hasAnchor">
<h4>Latent variable GP<a href="fit-gp.html#latent-variable-gp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can also explicitly code the latent variable formulation of a GP in Stan.
This will be useful for when the outcome is not normal. We’ll need to add a
small positive term, <span class="math inline">\(\delta\)</span> to the diagonal of the covariance matrix in order
to ensure that our covariance matrix remains positive definite.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb162-1"><a href="fit-gp.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb162-2"><a href="fit-gp.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;</span>
<span id="cb162-3"><a href="fit-gp.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> x;</span>
<span id="cb162-4"><a href="fit-gp.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] y;</span>
<span id="cb162-5"><a href="fit-gp.html#cb162-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-6"><a href="fit-gp.html#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb162-7"><a href="fit-gp.html#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb162-8"><a href="fit-gp.html#cb162-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-9"><a href="fit-gp.html#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb162-10"><a href="fit-gp.html#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb162-11"><a href="fit-gp.html#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb162-12"><a href="fit-gp.html#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb162-13"><a href="fit-gp.html#cb162-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] eta;</span>
<span id="cb162-14"><a href="fit-gp.html#cb162-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-15"><a href="fit-gp.html#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb162-16"><a href="fit-gp.html#cb162-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] f;</span>
<span id="cb162-17"><a href="fit-gp.html#cb162-17" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb162-18"><a href="fit-gp.html#cb162-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] L_K;</span>
<span id="cb162-19"><a href="fit-gp.html#cb162-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] K = cov_exp_quad(x, alpha, rho);</span>
<span id="cb162-20"><a href="fit-gp.html#cb162-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-21"><a href="fit-gp.html#cb162-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// diagonal elements</span></span>
<span id="cb162-22"><a href="fit-gp.html#cb162-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb162-23"><a href="fit-gp.html#cb162-23" aria-hidden="true" tabindex="-1"></a>      K[n, n] = K[n, n] + delta;</span>
<span id="cb162-24"><a href="fit-gp.html#cb162-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb162-25"><a href="fit-gp.html#cb162-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-26"><a href="fit-gp.html#cb162-26" aria-hidden="true" tabindex="-1"></a>    L_K = cholesky_decompose(K);</span>
<span id="cb162-27"><a href="fit-gp.html#cb162-27" aria-hidden="true" tabindex="-1"></a>    f = L_K * eta;</span>
<span id="cb162-28"><a href="fit-gp.html#cb162-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb162-29"><a href="fit-gp.html#cb162-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-30"><a href="fit-gp.html#cb162-30" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb162-31"><a href="fit-gp.html#cb162-31" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb162-32"><a href="fit-gp.html#cb162-32" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb162-33"><a href="fit-gp.html#cb162-33" aria-hidden="true" tabindex="-1"></a>  eta ~ std_normal();</span>
<span id="cb162-34"><a href="fit-gp.html#cb162-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-35"><a href="fit-gp.html#cb162-35" aria-hidden="true" tabindex="-1"></a>  y ~ normal(f, sigma);</span>
<span id="cb162-36"><a href="fit-gp.html#cb162-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Two differences between the latent variable GP and the marginal likelihood GP
are worth noting. The first is that we have augmented our parameter block with
a new parameter vector of length <span class="math inline">\(N\)</span> called <code>eta</code>. This is used in the model
block to generate a multivariate normal vector called <span class="math inline">\(f\)</span>, corresponding to the
latent GP. We put a <span class="math inline">\(\textsf{normal}(0,1)\)</span> prior on <code>eta</code> like we did in the
Cholesky-parameterized GP in the simulation section. The second difference is
that our likelihood is now univariate, though we could code <span class="math inline">\(N\)</span> likelihood
terms as one <span class="math inline">\(N\)</span>-dimensional multivariate normal with an identity covariance
matrix multiplied by <span class="math inline">\(\sigma^2\)</span>. However, it is more efficient to use the
vectorized statement as shown above.</p>
</div>
</div>
<div id="discrete-outcomes-with-gaussian-processes" class="section level3 unnumbered hasAnchor">
<h3>Discrete outcomes with Gaussian processes<a href="fit-gp.html#discrete-outcomes-with-gaussian-processes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Gaussian processes can be generalized the same way as standard linear
models by introducing a link function. This allows them to be used as
discrete data models.</p>
<div id="poisson-gp" class="section level4 unnumbered hasAnchor">
<h4>Poisson GP<a href="fit-gp.html#poisson-gp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we want to model count data, we can remove the <span class="math inline">\(\sigma\)</span> parameter, and use
<code>poisson_log</code>, which implements a log link, for our likelihood rather
than <code>normal</code>. We can also add an overall mean parameter, <span class="math inline">\(a\)</span>, which
will account for the marginal expected value for <span class="math inline">\(y\)</span>. We do this because we
cannot center count data like we would for normally distributed data.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb163-1"><a href="fit-gp.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb163-2"><a href="fit-gp.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb163-3"><a href="fit-gp.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; y;</span>
<span id="cb163-4"><a href="fit-gp.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb163-5"><a href="fit-gp.html#cb163-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-6"><a href="fit-gp.html#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb163-7"><a href="fit-gp.html#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb163-8"><a href="fit-gp.html#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb163-9"><a href="fit-gp.html#cb163-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb163-10"><a href="fit-gp.html#cb163-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> a;</span>
<span id="cb163-11"><a href="fit-gp.html#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] eta;</span>
<span id="cb163-12"><a href="fit-gp.html#cb163-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-13"><a href="fit-gp.html#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb163-14"><a href="fit-gp.html#cb163-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb163-15"><a href="fit-gp.html#cb163-15" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb163-16"><a href="fit-gp.html#cb163-16" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb163-17"><a href="fit-gp.html#cb163-17" aria-hidden="true" tabindex="-1"></a>  a ~ std_normal();</span>
<span id="cb163-18"><a href="fit-gp.html#cb163-18" aria-hidden="true" tabindex="-1"></a>  eta ~ std_normal();</span>
<span id="cb163-19"><a href="fit-gp.html#cb163-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-20"><a href="fit-gp.html#cb163-20" aria-hidden="true" tabindex="-1"></a>  y ~ poisson_log(a + f);</span>
<span id="cb163-21"><a href="fit-gp.html#cb163-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="logistic-gaussian-process-regression" class="section level4 unnumbered hasAnchor">
<h4>Logistic Gaussian process regression<a href="fit-gp.html#logistic-gaussian-process-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For binary classification problems, the observed outputs <span class="math inline">\(z_n \in \{ 0,1 \}\)</span> are binary. These outputs are modeled using a Gaussian
process with (unobserved) outputs <span class="math inline">\(y_n\)</span> through the logistic link,
<span class="math display">\[
z_n \sim \textsf{Bernoulli}(\operatorname{logit}^{-1}(y_n)),
\]</span>
or in other words,
<span class="math display">\[
\textsf{Pr}[z_n = 1] = \operatorname{logit}^{-1}(y_n).
\]</span></p>
<p>We can extend our latent variable GP Stan program to deal with classification
problems. Below <code>a</code> is the bias term, which can help account for imbalanced
classes in the training data:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb164-1"><a href="fit-gp.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb164-2"><a href="fit-gp.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb164-3"><a href="fit-gp.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; z;</span>
<span id="cb164-4"><a href="fit-gp.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb164-5"><a href="fit-gp.html#cb164-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-6"><a href="fit-gp.html#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb164-7"><a href="fit-gp.html#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb164-8"><a href="fit-gp.html#cb164-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb164-9"><a href="fit-gp.html#cb164-9" aria-hidden="true" tabindex="-1"></a>  y ~ bernoulli_logit(a + f);</span>
<span id="cb164-10"><a href="fit-gp.html#cb164-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="automatic-relevance-determination" class="section level3 unnumbered hasAnchor">
<h3>Automatic relevance determination<a href="fit-gp.html#automatic-relevance-determination" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we have multivariate inputs <span class="math inline">\(x \in \mathbb{R}^D\)</span>, the squared exponential
covariance function can be further generalized by fitting a scale
parameter <span class="math inline">\(\rho_d\)</span> for each dimension <span class="math inline">\(d\)</span>,
<span class="math display">\[
  k(x \mid \alpha, \vec{\rho}, \sigma)_{i, j} = \alpha^2 \exp
\left(-\dfrac{1}{2}
\sum_{d=1}^D \dfrac{1}{\rho_d^2} (x_{i,d} - x_{j,d})^2
\right)
+ \delta_{i, j}\sigma^2.
\]</span>
The estimation of <span class="math inline">\(\rho\)</span> was termed “automatic relevance determination” by
<span class="citation">Neal (<a href="#ref-Neal:1996" role="doc-biblioref">1996a</a>)</span>, but this is misleading, because the magnitude of the scale of
the posterior for each <span class="math inline">\(\rho_d\)</span> is dependent on the scaling of the input data
along dimension <span class="math inline">\(d\)</span>. Moreover, the scale of the parameters <span class="math inline">\(\rho_d\)</span> measures
non-linearity along the <span class="math inline">\(d\)</span>-th dimension, rather than “relevance”
<span class="citation">(<a href="#ref-PiironenVehtari:2016" role="doc-biblioref">Piironen and Vehtari 2016</a>)</span>.</p>
<p>A priori, the closer <span class="math inline">\(\rho_d\)</span> is to zero, the more nonlinear the
conditional mean in dimension <span class="math inline">\(d\)</span> is. A posteriori, the actual dependencies
between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> play a role. With one covariate <span class="math inline">\(x_1\)</span> having a
linear effect and another covariate <span class="math inline">\(x_2\)</span> having a nonlinear effect,
it is possible that <span class="math inline">\(\rho_1 &gt; \rho_2\)</span> even if the predictive relevance
of <span class="math inline">\(x_1\)</span> is higher <span class="citation">(<a href="#ref-RasmussenWilliams:2006" role="doc-biblioref">Rasmussen and Williams 2006, 80</a>)</span>.
The collection of <span class="math inline">\(\rho_d\)</span> (or <span class="math inline">\(1/\rho_d\)</span>) parameters can also be
modeled hierarchically.</p>
<p>The implementation of automatic relevance determination in Stan is
straightforward, though it currently requires the user to directly code the
covariance matrix. We’ll write a function to generate the Cholesky of the
covariance matrix called <code>L_cov_exp_quad_ARD</code>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb165-1"><a href="fit-gp.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">functions</span> {</span>
<span id="cb165-2"><a href="fit-gp.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span> L_cov_exp_quad_ARD(<span class="dt">vector</span>[] x,</span>
<span id="cb165-3"><a href="fit-gp.html#cb165-3" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">real</span> alpha,</span>
<span id="cb165-4"><a href="fit-gp.html#cb165-4" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">vector</span> rho,</span>
<span id="cb165-5"><a href="fit-gp.html#cb165-5" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">real</span> delta) {</span>
<span id="cb165-6"><a href="fit-gp.html#cb165-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N = size(x);</span>
<span id="cb165-7"><a href="fit-gp.html#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] K;</span>
<span id="cb165-8"><a href="fit-gp.html#cb165-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">real</span> sq_alpha = square(alpha);</span>
<span id="cb165-9"><a href="fit-gp.html#cb165-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:(N<span class="dv">-1</span>)) {</span>
<span id="cb165-10"><a href="fit-gp.html#cb165-10" aria-hidden="true" tabindex="-1"></a>      K[i, i] = sq_alpha + delta;</span>
<span id="cb165-11"><a href="fit-gp.html#cb165-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> (i + <span class="dv">1</span>):N) {</span>
<span id="cb165-12"><a href="fit-gp.html#cb165-12" aria-hidden="true" tabindex="-1"></a>        K[i, j] = sq_alpha</span>
<span id="cb165-13"><a href="fit-gp.html#cb165-13" aria-hidden="true" tabindex="-1"></a>                      * exp(-<span class="fl">0.5</span> * dot_self((x[i] - x[j]) ./ rho));</span>
<span id="cb165-14"><a href="fit-gp.html#cb165-14" aria-hidden="true" tabindex="-1"></a>        K[j, i] = K[i, j];</span>
<span id="cb165-15"><a href="fit-gp.html#cb165-15" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb165-16"><a href="fit-gp.html#cb165-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb165-17"><a href="fit-gp.html#cb165-17" aria-hidden="true" tabindex="-1"></a>    K[N, N] = sq_alpha + delta;</span>
<span id="cb165-18"><a href="fit-gp.html#cb165-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cholesky_decompose(K);</span>
<span id="cb165-19"><a href="fit-gp.html#cb165-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb165-20"><a href="fit-gp.html#cb165-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-21"><a href="fit-gp.html#cb165-21" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb165-22"><a href="fit-gp.html#cb165-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;</span>
<span id="cb165-23"><a href="fit-gp.html#cb165-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; D;</span>
<span id="cb165-24"><a href="fit-gp.html#cb165-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">vector</span>[D] x;</span>
<span id="cb165-25"><a href="fit-gp.html#cb165-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] y;</span>
<span id="cb165-26"><a href="fit-gp.html#cb165-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-27"><a href="fit-gp.html#cb165-27" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb165-28"><a href="fit-gp.html#cb165-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb165-29"><a href="fit-gp.html#cb165-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-30"><a href="fit-gp.html#cb165-30" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb165-31"><a href="fit-gp.html#cb165-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt;[D] rho;</span>
<span id="cb165-32"><a href="fit-gp.html#cb165-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb165-33"><a href="fit-gp.html#cb165-33" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb165-34"><a href="fit-gp.html#cb165-34" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] eta;</span>
<span id="cb165-35"><a href="fit-gp.html#cb165-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-36"><a href="fit-gp.html#cb165-36" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb165-37"><a href="fit-gp.html#cb165-37" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] f;</span>
<span id="cb165-38"><a href="fit-gp.html#cb165-38" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb165-39"><a href="fit-gp.html#cb165-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] L_K = L_cov_exp_quad_ARD(x, alpha, rho, delta);</span>
<span id="cb165-40"><a href="fit-gp.html#cb165-40" aria-hidden="true" tabindex="-1"></a>    f = L_K * eta;</span>
<span id="cb165-41"><a href="fit-gp.html#cb165-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb165-42"><a href="fit-gp.html#cb165-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-43"><a href="fit-gp.html#cb165-43" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb165-44"><a href="fit-gp.html#cb165-44" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb165-45"><a href="fit-gp.html#cb165-45" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb165-46"><a href="fit-gp.html#cb165-46" aria-hidden="true" tabindex="-1"></a>  eta ~ std_normal();</span>
<span id="cb165-47"><a href="fit-gp.html#cb165-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-48"><a href="fit-gp.html#cb165-48" aria-hidden="true" tabindex="-1"></a>  y ~ normal(f, sigma);</span>
<span id="cb165-49"><a href="fit-gp.html#cb165-49" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="priors-gp.section" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Priors for Gaussian process parameters<a href="fit-gp.html#priors-gp.section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formulating priors for GP hyperparameters requires the analyst to consider the
inherent statistical properties of a GP, the GP’s purpose in the model, and the
numerical issues that may arise in Stan when estimating a GP.</p>
<p>Perhaps most importantly, the parameters <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\alpha\)</span> are weakly
identified <span class="citation">(<a href="#ref-zhang-gp:2004" role="doc-biblioref">Zhang 2004</a>)</span>. The ratio of the two
parameters is well-identified, but in practice we put independent priors on the
two hyperparameters because these two quantities are more interpretable than
their ratio.</p>
<div id="priors-for-length-scale" class="section level4 unnumbered hasAnchor">
<h4>Priors for length-scale<a href="fit-gp.html#priors-for-length-scale" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GPs are a flexible class of priors and, as such, can represent a wide spectrum
of functions. For length scales below the minimum spacing of the covariates
the GP likelihood plateaus. Unless regularized by a prior, this flat
likelihood induces considerable posterior mass at small length scales where the
observation variance drops to zero and the functions supported by the GP begin
to exactly interpolate between the input data. The resulting posterior not
only significantly overfits to the input data, it also becomes hard to
accurately sample using Euclidean HMC.</p>
<p>We may wish to put further soft constraints on the length-scale, but these are
dependent on how the GP is used in our statistical model.</p>
<p>If our model consists of only the GP, i.e.:
<span class="math display">\[\begin{align*}
f   &amp;\sim \textsf{multivariate normal}\left(0, K(x \mid \alpha, \rho)\right) \\
y_i &amp;\sim \textsf{normal}(f_i, \sigma) \, \forall i \in \{1, \dots, N\} \\
    &amp; x \in \mathbb{R}^{N \times D}, \quad
      f \in \mathbb{R}^N
\end{align*}\]</span></p>
<p>we likely don’t need constraints beyond penalizing small
length-scales. We’d like to allow the GP prior to represent both
high-frequency and low-frequency functions, so our prior should put
non-negligible mass on both sets of functions. In this case, an
inverse gamma, <code>inv_gamma_lpdf</code> in Stan’s language, will work well as
it has a sharp left tail that puts negligible mass on infinitesimal
length-scales, but a generous right tail, allowing for large
length-scales. Inverse gamma priors will avoid infinitesimal
length-scales because the density is zero at zero, so the posterior
for length-scale will be pushed away from zero. An inverse gamma
distribution is one of many zero-avoiding or boundary-avoiding
distributions.<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>.</p>
<p>If we’re using the GP as a component in a larger model that includes an overall
mean and fixed effects for the same variables we’re using as the domain for the
GP, i.e.:
<span class="math display">\[\begin{align*}
f   &amp;\sim \textsf{multivariate normal}\big(0, K(x \mid \alpha, \rho)\big) \\
y_i &amp;\sim \textsf{normal}\left(\beta_0 + x_i \beta_{[1:D]} + f_i, \sigma\right) \, \forall i
  \in \{1, \dots, N\} \\
    &amp; x_i^T, \beta_{[1:D]} \in \mathbb{R}^D,\quad
      x \in \mathbb{R}^{N \times D},\quad
      f \in \mathbb{R}^N
\end{align*}\]</span></p>
<p>we’ll likely want to constrain large length-scales as well. A length scale
that is larger than the scale of the data yields a GP posterior that is
practically linear (with respect to the particular covariate) and increasing
the length scale has little impact on the likelihood. This will introduce
nonidentifiability in our model, as both the fixed effects and the GP will
explain similar variation. In order to limit the amount of overlap between the
GP and the linear regression, we should use a prior with a sharper right tail
to limit the GP to higher-frequency functions. We can use a generalized inverse
Gaussian distribution:
<span class="math display">\[\begin{align*}
f(x \mid a, b, p) &amp;= \dfrac{\left(a/b\right)^{p/2}}{2K_p\left(\sqrt{ab}\right)} x^{p - 1}\exp\big(-(ax + b
  / x)/2\big) \\
  &amp; x, a, b \in \mathbb{R}^{+},\quad
    p \in \mathbb{Z}
\end{align*}\]</span></p>
<p>which has an inverse gamma left tail if <span class="math inline">\(p \leq 0\)</span> and an inverse Gaussian
right tail. This has not yet been implemented in Stan’s math library, but it
is possible to implement as a user defined function:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb166-1"><a href="fit-gp.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">functions</span> {</span>
<span id="cb166-2"><a href="fit-gp.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> generalized_inverse_gaussian_lpdf(<span class="dt">real</span> x, <span class="dt">int</span> p,</span>
<span id="cb166-3"><a href="fit-gp.html#cb166-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="dt">real</span> a, <span class="dt">real</span> b) {</span>
<span id="cb166-4"><a href="fit-gp.html#cb166-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p * <span class="fl">0.5</span> * log(a / b)</span>
<span id="cb166-5"><a href="fit-gp.html#cb166-5" aria-hidden="true" tabindex="-1"></a>      - log(<span class="dv">2</span> * modified_bessel_second_kind(p, sqrt(a * b)))</span>
<span id="cb166-6"><a href="fit-gp.html#cb166-6" aria-hidden="true" tabindex="-1"></a>      + (p - <span class="dv">1</span>) * log(x)</span>
<span id="cb166-7"><a href="fit-gp.html#cb166-7" aria-hidden="true" tabindex="-1"></a>      - (a * x + b / x) * <span class="fl">0.5</span>;</span>
<span id="cb166-8"><a href="fit-gp.html#cb166-8" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb166-9"><a href="fit-gp.html#cb166-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-10"><a href="fit-gp.html#cb166-10" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb166-11"><a href="fit-gp.html#cb166-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb166-12"><a href="fit-gp.html#cb166-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>If we have high-frequency covariates in our fixed effects, we may wish to
further regularize the GP away from high-frequency functions, which means we’ll
need to penalize smaller length-scales. Luckily, we have a useful way of
thinking about how length-scale affects the frequency of the functions
supported the GP. If we were to repeatedly draw from a zero-mean GP with a
length-scale of <span class="math inline">\(\rho\)</span> in a fixed-domain <span class="math inline">\([0,T]\)</span>, we would get a distribution
for the number of times each draw of the GP crossed the zero axis. The
expectation of this random variable, the number of zero crossings, is <span class="math inline">\(T / \pi \rho\)</span>. You can see that as <span class="math inline">\(\rho\)</span> decreases, the expectation of the number of
upcrossings increases as the GP is representing higher-frequency functions.
Thus, this is a good statistic to keep in mind when setting a lower-bound for
our prior on length-scale in the presence of high-frequency covariates.
However, this statistic is only valid for one-dimensional inputs.</p>
</div>
<div id="priors-for-marginal-standard-deviation" class="section level4 unnumbered hasAnchor">
<h4>Priors for marginal standard deviation<a href="fit-gp.html#priors-for-marginal-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The parameter <span class="math inline">\(\alpha\)</span> corresponds to how much of the variation is
explained by the regression function and has a similar role to the
prior variance for linear model weights. This means the prior can be
the same as used in linear models, such as a half-<span class="math inline">\(t\)</span> prior on <span class="math inline">\(\alpha\)</span>.</p>
<p>A half-<span class="math inline">\(t\)</span> or half-Gaussian prior on alpha also has the benefit of putting
nontrivial prior mass around zero. This allows the GP support the zero
functions and allows the possibility that the GP won’t contribute to the
conditional mean of the total output.</p>
</div>
</div>
<div id="predictive-inference-with-a-gaussian-process" class="section level3 unnumbered hasAnchor">
<h3>Predictive inference with a Gaussian process<a href="fit-gp.html#predictive-inference-with-a-gaussian-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose for a given sequence of inputs <span class="math inline">\(x\)</span> that the corresponding
outputs <span class="math inline">\(y\)</span> are observed. Given a new sequence of inputs <span class="math inline">\(\tilde{x}\)</span>,
the posterior predictive distribution of their labels is computed by
sampling outputs <span class="math inline">\(\tilde{y}\)</span> according to
<span class="math display">\[
p\left(\tilde{y} \mid \tilde{x},x,y\right)
\ = \
\frac{p\left(\tilde{y}, y \mid \tilde{x},x\right)}
     {p(y \mid x)}
\ \propto \
p\left(\tilde{y}, y \mid \tilde{x},x\right).
\]</span></p>
<p>A direct implementation in Stan defines a model in terms of the
joint distribution of the observed <span class="math inline">\(y\)</span> and unobserved <span class="math inline">\(\tilde{y}\)</span>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb167-1"><a href="fit-gp.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb167-2"><a href="fit-gp.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N1;</span>
<span id="cb167-3"><a href="fit-gp.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N1] <span class="dt">real</span> x1;</span>
<span id="cb167-4"><a href="fit-gp.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N1] y1;</span>
<span id="cb167-5"><a href="fit-gp.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N2;</span>
<span id="cb167-6"><a href="fit-gp.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N2] <span class="dt">real</span> x2;</span>
<span id="cb167-7"><a href="fit-gp.html#cb167-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-8"><a href="fit-gp.html#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb167-9"><a href="fit-gp.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb167-10"><a href="fit-gp.html#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N = N1 + N2;</span>
<span id="cb167-11"><a href="fit-gp.html#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> x;</span>
<span id="cb167-12"><a href="fit-gp.html#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n1 <span class="cf">in</span> <span class="dv">1</span>:N1) {</span>
<span id="cb167-13"><a href="fit-gp.html#cb167-13" aria-hidden="true" tabindex="-1"></a>    x[n1] = x1[n1];</span>
<span id="cb167-14"><a href="fit-gp.html#cb167-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-15"><a href="fit-gp.html#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n2 <span class="cf">in</span> <span class="dv">1</span>:N2) {</span>
<span id="cb167-16"><a href="fit-gp.html#cb167-16" aria-hidden="true" tabindex="-1"></a>    x[N1 + n2] = x2[n2];</span>
<span id="cb167-17"><a href="fit-gp.html#cb167-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-18"><a href="fit-gp.html#cb167-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-19"><a href="fit-gp.html#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb167-20"><a href="fit-gp.html#cb167-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb167-21"><a href="fit-gp.html#cb167-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb167-22"><a href="fit-gp.html#cb167-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb167-23"><a href="fit-gp.html#cb167-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] eta;</span>
<span id="cb167-24"><a href="fit-gp.html#cb167-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-25"><a href="fit-gp.html#cb167-25" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb167-26"><a href="fit-gp.html#cb167-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] f;</span>
<span id="cb167-27"><a href="fit-gp.html#cb167-27" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb167-28"><a href="fit-gp.html#cb167-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] L_K;</span>
<span id="cb167-29"><a href="fit-gp.html#cb167-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] K = cov_exp_quad(x, alpha, rho);</span>
<span id="cb167-30"><a href="fit-gp.html#cb167-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-31"><a href="fit-gp.html#cb167-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// diagonal elements</span></span>
<span id="cb167-32"><a href="fit-gp.html#cb167-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb167-33"><a href="fit-gp.html#cb167-33" aria-hidden="true" tabindex="-1"></a>      K[n, n] = K[n, n] + delta;</span>
<span id="cb167-34"><a href="fit-gp.html#cb167-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb167-35"><a href="fit-gp.html#cb167-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-36"><a href="fit-gp.html#cb167-36" aria-hidden="true" tabindex="-1"></a>    L_K = cholesky_decompose(K);</span>
<span id="cb167-37"><a href="fit-gp.html#cb167-37" aria-hidden="true" tabindex="-1"></a>    f = L_K * eta;</span>
<span id="cb167-38"><a href="fit-gp.html#cb167-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-39"><a href="fit-gp.html#cb167-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-40"><a href="fit-gp.html#cb167-40" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb167-41"><a href="fit-gp.html#cb167-41" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb167-42"><a href="fit-gp.html#cb167-42" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb167-43"><a href="fit-gp.html#cb167-43" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb167-44"><a href="fit-gp.html#cb167-44" aria-hidden="true" tabindex="-1"></a>  eta ~ std_normal();</span>
<span id="cb167-45"><a href="fit-gp.html#cb167-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-46"><a href="fit-gp.html#cb167-46" aria-hidden="true" tabindex="-1"></a>  y1 ~ normal(f[<span class="dv">1</span>:N1], sigma);</span>
<span id="cb167-47"><a href="fit-gp.html#cb167-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-48"><a href="fit-gp.html#cb167-48" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb167-49"><a href="fit-gp.html#cb167-49" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N2] y2;</span>
<span id="cb167-50"><a href="fit-gp.html#cb167-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n2 <span class="cf">in</span> <span class="dv">1</span>:N2) {</span>
<span id="cb167-51"><a href="fit-gp.html#cb167-51" aria-hidden="true" tabindex="-1"></a>    y2[n2] = normal_rng(f[N1 + n2], sigma);</span>
<span id="cb167-52"><a href="fit-gp.html#cb167-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-53"><a href="fit-gp.html#cb167-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The input vectors <code>x1</code> and <code>x2</code> are declared as data, as is the
observed output vector <code>y1</code>. The unknown output vector <code>y2</code>, which
corresponds to input vector <code>x2</code>, is declared in the generated quantities
block and will be sampled when the model is executed.</p>
<p>A transformed data block is used to combine the input vectors
<code>x1</code> and <code>x2</code> into a single vector <code>x</code>.</p>
<p>The model block declares and defines a local variable for the combined output
vector <code>f</code>, which consists of the concatenation of the conditional mean
for known outputs <code>y1</code> and unknown outputs <code>y2</code>. Thus the
combined output vector <code>f</code> is aligned with the combined
input vector <code>x</code>. All that is left is to define the univariate
normal sampling statement for <code>y</code>.</p>
<p>The generated quantities block defines the quantity <code>y2</code>. We generate
<code>y2</code> by sampling <code>N2</code> univariate normals with each mean corresponding
to the appropriate element in <code>f</code>.</p>
<div id="predictive-inference-in-non-gaussian-gps" class="section level4 unnumbered hasAnchor">
<h4>Predictive inference in non-Gaussian GPs<a href="fit-gp.html#predictive-inference-in-non-gaussian-gps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can do predictive inference in non-Gaussian GPs in much the
same way as we do with Gaussian GPs.</p>
<p>Consider the following full model for prediction using logistic Gaussian
process regression.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb168-1"><a href="fit-gp.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb168-2"><a href="fit-gp.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N1;</span>
<span id="cb168-3"><a href="fit-gp.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N1] <span class="dt">real</span> x1;</span>
<span id="cb168-4"><a href="fit-gp.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N1] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; z1;</span>
<span id="cb168-5"><a href="fit-gp.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N2;</span>
<span id="cb168-6"><a href="fit-gp.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N2] <span class="dt">real</span> x2;</span>
<span id="cb168-7"><a href="fit-gp.html#cb168-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-8"><a href="fit-gp.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb168-9"><a href="fit-gp.html#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb168-10"><a href="fit-gp.html#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N = N1 + N2;</span>
<span id="cb168-11"><a href="fit-gp.html#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> x;</span>
<span id="cb168-12"><a href="fit-gp.html#cb168-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n1 <span class="cf">in</span> <span class="dv">1</span>:N1) {</span>
<span id="cb168-13"><a href="fit-gp.html#cb168-13" aria-hidden="true" tabindex="-1"></a>    x[n1] = x1[n1];</span>
<span id="cb168-14"><a href="fit-gp.html#cb168-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-15"><a href="fit-gp.html#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n2 <span class="cf">in</span> <span class="dv">1</span>:N2) {</span>
<span id="cb168-16"><a href="fit-gp.html#cb168-16" aria-hidden="true" tabindex="-1"></a>    x[N1 + n2] = x2[n2];</span>
<span id="cb168-17"><a href="fit-gp.html#cb168-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-18"><a href="fit-gp.html#cb168-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-19"><a href="fit-gp.html#cb168-19" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb168-20"><a href="fit-gp.html#cb168-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb168-21"><a href="fit-gp.html#cb168-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb168-22"><a href="fit-gp.html#cb168-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> a;</span>
<span id="cb168-23"><a href="fit-gp.html#cb168-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] eta;</span>
<span id="cb168-24"><a href="fit-gp.html#cb168-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-25"><a href="fit-gp.html#cb168-25" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb168-26"><a href="fit-gp.html#cb168-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] f;</span>
<span id="cb168-27"><a href="fit-gp.html#cb168-27" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb168-28"><a href="fit-gp.html#cb168-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] L_K;</span>
<span id="cb168-29"><a href="fit-gp.html#cb168-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] K = cov_exp_quad(x, alpha, rho);</span>
<span id="cb168-30"><a href="fit-gp.html#cb168-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-31"><a href="fit-gp.html#cb168-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// diagonal elements</span></span>
<span id="cb168-32"><a href="fit-gp.html#cb168-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb168-33"><a href="fit-gp.html#cb168-33" aria-hidden="true" tabindex="-1"></a>      K[n, n] = K[n, n] + delta;</span>
<span id="cb168-34"><a href="fit-gp.html#cb168-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb168-35"><a href="fit-gp.html#cb168-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-36"><a href="fit-gp.html#cb168-36" aria-hidden="true" tabindex="-1"></a>    L_K = cholesky_decompose(K);</span>
<span id="cb168-37"><a href="fit-gp.html#cb168-37" aria-hidden="true" tabindex="-1"></a>    f = L_K * eta;</span>
<span id="cb168-38"><a href="fit-gp.html#cb168-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-39"><a href="fit-gp.html#cb168-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-40"><a href="fit-gp.html#cb168-40" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb168-41"><a href="fit-gp.html#cb168-41" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb168-42"><a href="fit-gp.html#cb168-42" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb168-43"><a href="fit-gp.html#cb168-43" aria-hidden="true" tabindex="-1"></a>  a ~ std_normal();</span>
<span id="cb168-44"><a href="fit-gp.html#cb168-44" aria-hidden="true" tabindex="-1"></a>  eta ~ std_normal();</span>
<span id="cb168-45"><a href="fit-gp.html#cb168-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-46"><a href="fit-gp.html#cb168-46" aria-hidden="true" tabindex="-1"></a>  z1 ~ bernoulli_logit(a + f[<span class="dv">1</span>:N1]);</span>
<span id="cb168-47"><a href="fit-gp.html#cb168-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-48"><a href="fit-gp.html#cb168-48" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb168-49"><a href="fit-gp.html#cb168-49" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N2] <span class="dt">int</span> z2;</span>
<span id="cb168-50"><a href="fit-gp.html#cb168-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n2 <span class="cf">in</span> <span class="dv">1</span>:N2) {</span>
<span id="cb168-51"><a href="fit-gp.html#cb168-51" aria-hidden="true" tabindex="-1"></a>    z2[n2] = bernoulli_logit_rng(a + f[N1 + n2]);</span>
<span id="cb168-52"><a href="fit-gp.html#cb168-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-53"><a href="fit-gp.html#cb168-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="analytical-form-of-joint-predictive-inference" class="section level4 unnumbered hasAnchor">
<h4>Analytical form of joint predictive inference<a href="fit-gp.html#analytical-form-of-joint-predictive-inference" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Bayesian predictive inference for Gaussian processes with Gaussian observations
can be sped up by deriving the posterior analytically, then directly sampling
from it.</p>
<p>Jumping straight to the result,
<span class="math display">\[
p\left(\tilde{y} \mid \tilde{x},y,x\right)
=
\textsf{normal}\left(K^{\top}\Sigma^{-1}y,\
                \Omega - K^{\top}\Sigma^{-1}K\right),
\]</span>
where <span class="math inline">\(\Sigma = K(x \mid \alpha, \rho, \sigma)\)</span> is the result of applying the covariance
function to the inputs <span class="math inline">\(x\)</span> with observed outputs <span class="math inline">\(y\)</span>, <span class="math inline">\(\Omega = K(\tilde{x} \mid \alpha, \rho)\)</span> is the result of applying the covariance function to the
inputs <span class="math inline">\(\tilde{x}\)</span> for which predictions are to be inferred, and <span class="math inline">\(K\)</span>
is the matrix of covariances between inputs <span class="math inline">\(x\)</span> and <span class="math inline">\(\tilde{x}\)</span>, which
in the case of the exponentiated quadratic covariance function
would be
<span class="math display">\[
K(x \mid \alpha, \rho)_{i, j} = \eta^2 \exp\left(-\dfrac{1}{2 \rho^2}
\sum_{d=1}^D \left(x_{i,d} - \tilde{x}_{j,d}\right)^2\right).
\]</span></p>
<p>There is no noise term including <span class="math inline">\(\sigma^2\)</span> because the indexes of
elements in <span class="math inline">\(x\)</span> and <span class="math inline">\(\tilde{x}\)</span> are never the same.</p>
<p>This Stan code below uses the analytic form of the posterior and provides
sampling of the resulting multivariate normal through the Cholesky
decomposition. The data declaration is the same as for the latent variable
example, but we’ve defined a function called <code>gp_pred_rng</code> which will
generate a draw from the posterior predictive mean conditioned on observed data
<code>y1</code>. The code uses a Cholesky decomposition in triangular solves in order
to cut down on the number of matrix-matrix multiplications when computing
the conditional mean and the conditional covariance of <span class="math inline">\(p(\tilde{y})\)</span>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb169-1"><a href="fit-gp.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="kw">functions</span> {</span>
<span id="cb169-2"><a href="fit-gp.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span> gp_pred_rng(<span class="dt">array</span>[] <span class="dt">real</span> x2,</span>
<span id="cb169-3"><a href="fit-gp.html#cb169-3" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">vector</span> y1,</span>
<span id="cb169-4"><a href="fit-gp.html#cb169-4" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">array</span>[] <span class="dt">real</span> x1,</span>
<span id="cb169-5"><a href="fit-gp.html#cb169-5" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">real</span> alpha,</span>
<span id="cb169-6"><a href="fit-gp.html#cb169-6" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">real</span> rho,</span>
<span id="cb169-7"><a href="fit-gp.html#cb169-7" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">real</span> sigma,</span>
<span id="cb169-8"><a href="fit-gp.html#cb169-8" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">real</span> delta) {</span>
<span id="cb169-9"><a href="fit-gp.html#cb169-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N1 = rows(y1);</span>
<span id="cb169-10"><a href="fit-gp.html#cb169-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N2 = size(x2);</span>
<span id="cb169-11"><a href="fit-gp.html#cb169-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vector</span>[N2] f2;</span>
<span id="cb169-12"><a href="fit-gp.html#cb169-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb169-13"><a href="fit-gp.html#cb169-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N1, N1] L_K;</span>
<span id="cb169-14"><a href="fit-gp.html#cb169-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vector</span>[N1] K_div_y1;</span>
<span id="cb169-15"><a href="fit-gp.html#cb169-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N1, N2] k_x1_x2;</span>
<span id="cb169-16"><a href="fit-gp.html#cb169-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N1, N2] v_pred;</span>
<span id="cb169-17"><a href="fit-gp.html#cb169-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vector</span>[N2] f2_mu;</span>
<span id="cb169-18"><a href="fit-gp.html#cb169-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N2, N2] cov_f2;</span>
<span id="cb169-19"><a href="fit-gp.html#cb169-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N2, N2] diag_delta;</span>
<span id="cb169-20"><a href="fit-gp.html#cb169-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">matrix</span>[N1, N1] K;</span>
<span id="cb169-21"><a href="fit-gp.html#cb169-21" aria-hidden="true" tabindex="-1"></a>      K = cov_exp_quad(x1, alpha, rho);</span>
<span id="cb169-22"><a href="fit-gp.html#cb169-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N1) {</span>
<span id="cb169-23"><a href="fit-gp.html#cb169-23" aria-hidden="true" tabindex="-1"></a>        K[n, n] = K[n, n] + square(sigma);</span>
<span id="cb169-24"><a href="fit-gp.html#cb169-24" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb169-25"><a href="fit-gp.html#cb169-25" aria-hidden="true" tabindex="-1"></a>      L_K = cholesky_decompose(K);</span>
<span id="cb169-26"><a href="fit-gp.html#cb169-26" aria-hidden="true" tabindex="-1"></a>      K_div_y1 = mdivide_left_tri_low(L_K, y1);</span>
<span id="cb169-27"><a href="fit-gp.html#cb169-27" aria-hidden="true" tabindex="-1"></a>      K_div_y1 = mdivide_right_tri_low(K_div_y1&#39;, L_K)&#39;;</span>
<span id="cb169-28"><a href="fit-gp.html#cb169-28" aria-hidden="true" tabindex="-1"></a>      k_x1_x2 = cov_exp_quad(x1, x2, alpha, rho);</span>
<span id="cb169-29"><a href="fit-gp.html#cb169-29" aria-hidden="true" tabindex="-1"></a>      f2_mu = (k_x1_x2&#39; * K_div_y1);</span>
<span id="cb169-30"><a href="fit-gp.html#cb169-30" aria-hidden="true" tabindex="-1"></a>      v_pred = mdivide_left_tri_low(L_K, k_x1_x2);</span>
<span id="cb169-31"><a href="fit-gp.html#cb169-31" aria-hidden="true" tabindex="-1"></a>      cov_f2 = cov_exp_quad(x2, alpha, rho) - v_pred&#39; * v_pred;</span>
<span id="cb169-32"><a href="fit-gp.html#cb169-32" aria-hidden="true" tabindex="-1"></a>      diag_delta = diag_matrix(rep_vector(delta, N2));</span>
<span id="cb169-33"><a href="fit-gp.html#cb169-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-34"><a href="fit-gp.html#cb169-34" aria-hidden="true" tabindex="-1"></a>      f2 = multi_normal_rng(f2_mu, cov_f2 + diag_delta);</span>
<span id="cb169-35"><a href="fit-gp.html#cb169-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb169-36"><a href="fit-gp.html#cb169-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f2;</span>
<span id="cb169-37"><a href="fit-gp.html#cb169-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-38"><a href="fit-gp.html#cb169-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-39"><a href="fit-gp.html#cb169-39" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb169-40"><a href="fit-gp.html#cb169-40" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N1;</span>
<span id="cb169-41"><a href="fit-gp.html#cb169-41" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N1] <span class="dt">real</span> x1;</span>
<span id="cb169-42"><a href="fit-gp.html#cb169-42" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N1] y1;</span>
<span id="cb169-43"><a href="fit-gp.html#cb169-43" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N2;</span>
<span id="cb169-44"><a href="fit-gp.html#cb169-44" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N2] <span class="dt">real</span> x2;</span>
<span id="cb169-45"><a href="fit-gp.html#cb169-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-46"><a href="fit-gp.html#cb169-46" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb169-47"><a href="fit-gp.html#cb169-47" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N1] mu = rep_vector(<span class="dv">0</span>, N1);</span>
<span id="cb169-48"><a href="fit-gp.html#cb169-48" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb169-49"><a href="fit-gp.html#cb169-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-50"><a href="fit-gp.html#cb169-50" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb169-51"><a href="fit-gp.html#cb169-51" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb169-52"><a href="fit-gp.html#cb169-52" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; alpha;</span>
<span id="cb169-53"><a href="fit-gp.html#cb169-53" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb169-54"><a href="fit-gp.html#cb169-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-55"><a href="fit-gp.html#cb169-55" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb169-56"><a href="fit-gp.html#cb169-56" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N1, N1] L_K;</span>
<span id="cb169-57"><a href="fit-gp.html#cb169-57" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb169-58"><a href="fit-gp.html#cb169-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N1, N1] K = cov_exp_quad(x1, alpha, rho);</span>
<span id="cb169-59"><a href="fit-gp.html#cb169-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">real</span> sq_sigma = square(sigma);</span>
<span id="cb169-60"><a href="fit-gp.html#cb169-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-61"><a href="fit-gp.html#cb169-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">// diagonal elements</span></span>
<span id="cb169-62"><a href="fit-gp.html#cb169-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n1 <span class="cf">in</span> <span class="dv">1</span>:N1) {</span>
<span id="cb169-63"><a href="fit-gp.html#cb169-63" aria-hidden="true" tabindex="-1"></a>      K[n1, n1] = K[n1, n1] + sq_sigma;</span>
<span id="cb169-64"><a href="fit-gp.html#cb169-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb169-65"><a href="fit-gp.html#cb169-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-66"><a href="fit-gp.html#cb169-66" aria-hidden="true" tabindex="-1"></a>    L_K = cholesky_decompose(K);</span>
<span id="cb169-67"><a href="fit-gp.html#cb169-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-68"><a href="fit-gp.html#cb169-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-69"><a href="fit-gp.html#cb169-69" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb169-70"><a href="fit-gp.html#cb169-70" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb169-71"><a href="fit-gp.html#cb169-71" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb169-72"><a href="fit-gp.html#cb169-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-73"><a href="fit-gp.html#cb169-73" aria-hidden="true" tabindex="-1"></a>  y1 ~ multi_normal_cholesky(mu, L_K);</span>
<span id="cb169-74"><a href="fit-gp.html#cb169-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-75"><a href="fit-gp.html#cb169-75" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb169-76"><a href="fit-gp.html#cb169-76" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N2] f2;</span>
<span id="cb169-77"><a href="fit-gp.html#cb169-77" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N2] y2;</span>
<span id="cb169-78"><a href="fit-gp.html#cb169-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-79"><a href="fit-gp.html#cb169-79" aria-hidden="true" tabindex="-1"></a>  f2 = gp_pred_rng(x2, y1, x1, alpha, rho, sigma, delta);</span>
<span id="cb169-80"><a href="fit-gp.html#cb169-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n2 <span class="cf">in</span> <span class="dv">1</span>:N2) {</span>
<span id="cb169-81"><a href="fit-gp.html#cb169-81" aria-hidden="true" tabindex="-1"></a>    y2[n2] = normal_rng(f2[n2], sigma);</span>
<span id="cb169-82"><a href="fit-gp.html#cb169-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-83"><a href="fit-gp.html#cb169-83" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="multiple-output-gaussian-processes" class="section level3 unnumbered hasAnchor">
<h3>Multiple-output Gaussian processes<a href="fit-gp.html#multiple-output-gaussian-processes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have observations <span class="math inline">\(y_i \in \mathbb{R}^M\)</span> observed at
<span class="math inline">\(x_i \in \mathbb{R}^K\)</span>. One can model the data like so:
<span class="math display">\[\begin{align*}
y_i  &amp;\sim \textsf{multivariate normal}\left(f(x_i), \textbf{I}_M \sigma^2\right) \\
f(x) &amp;\sim \textsf{GP}\big(m(x), K(x \mid \theta, \phi)\big) \\
     &amp; K(x \mid \theta) \in \mathbb{R}^{M \times M}, \quad
       f(x), m(x) \in \mathbb{R}^M
\end{align*}\]</span>
where the <span class="math inline">\(K(x, x^\prime \mid \theta, \phi)_{[m, m^\prime]}\)</span> entry defines the
covariance between <span class="math inline">\(f_m(x)\)</span> and <span class="math inline">\(f_{m^\prime}(x^\prime)(x)\)</span>. This construction
of Gaussian processes allows us to learn the covariance between the output
dimensions of <span class="math inline">\(f(x)\)</span>. If we parameterize our kernel <span class="math inline">\(K\)</span>:
<span class="math display">\[
K(x, x^\prime \mid \theta, \phi)_{[m, m^\prime]} = k\left(x, x^\prime \mid
\theta\right) k\left(m, m^\prime \mid \phi\right)
\]</span>
then our finite dimensional generative model for the above is:
<span class="math display">\[\begin{align*}
f        &amp;\sim \textsf{matrixnormal}\big(m(x), K(x \mid \alpha, \rho), C(\phi)\big) \\
y_{i, m} &amp;\sim \textsf{normal}(f_{i,m}, \sigma) \\
f        &amp;\in  \mathbb{R}^{N \times M}
\end{align*}\]</span>
where <span class="math inline">\(K(x \mid \alpha, \rho)\)</span> is the exponentiated quadratic kernel we’ve used
throughout this chapter, and <span class="math inline">\(C(\phi)\)</span> is a positive-definite matrix,
parameterized by some vector <span class="math inline">\(\phi\)</span>.</p>
<p>The matrix normal distribution has two covariance matrices: <span class="math inline">\(K(x \mid \alpha, \rho)\)</span> to encode column covariance, and <span class="math inline">\(C(\phi)\)</span> to define row
covariance. The salient features of the matrix normal are that the rows
of the matrix <span class="math inline">\(f\)</span> are distributed:
<span class="math display">\[
f_{[n,]} \sim \textsf{multivariate normal}\big(m(x)_{[n,]}, K(x \mid \alpha,
\rho)_{[n,n]} C(\phi)\big)
\]</span>
and that the columns of the matrix <span class="math inline">\(f\)</span> are
distributed:
<span class="math display">\[
f_{[,m]} \sim \textsf{multivariate normal}\big(m(x)_{[,m]}, K(x
  \mid \alpha, \rho) C(\phi)_{[m,m]}\big)
\]</span>
This also means means that <span class="math inline">\(\mathbb{E}\left[f^T f\right]\)</span> is equal to
<span class="math inline">\(\operatorname{trace}\!\big(K(x \mid \alpha, \rho)\big) \times C\)</span>, whereas <span class="math inline">\(\mathbb{E}\left[ff^T\right]\)</span>
is <span class="math inline">\(\operatorname{trace}(C) \times K(x \mid \alpha, \rho)\)</span>. We can derive this using
properties of expectation and the matrix normal density.</p>
<p>We should set <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(1.0\)</span> because the parameter is not identified unless
we constrain <span class="math inline">\(\operatorname{trace}(C) = 1\)</span>. Otherwise, we can multiply <span class="math inline">\(\alpha\)</span> by a scalar <span class="math inline">\(d\)</span> and
<span class="math inline">\(C\)</span> by <span class="math inline">\(1/d\)</span> and our likelihood will not change.</p>
<p>We can generate a random variable <span class="math inline">\(f\)</span> from a matrix normal density in
<span class="math inline">\(\mathbb{R}^{N \times M}\)</span> using the following algorithm:
<span class="math display">\[\begin{align*}
\eta_{i,j} &amp;\sim \textsf{normal}(0, 1) \, \forall i,j \\
f          &amp;= L_{K(x \mid 1.0, \rho)} \, \eta \, L_C(\phi)^T \\
f          &amp;\sim \textsf{matrixnormal}\big(0, K(x \mid 1.0, \rho), C(\phi)\big) \\
\eta       &amp;\in \mathbb{R}^{N \times M} \\
L_C(\phi)  &amp;= \texttt{cholesky}\mathtt{\_}\texttt{decompose}\big(C(\phi)\big) \\
L_{K(x \mid 1.0, \rho)} &amp;= \texttt{cholesky}\mathtt{\_}\texttt{decompose}\big(K(x \mid 1.0, \rho)\big)
\end{align*}\]</span></p>
<p>This can be implemented in Stan using a latent-variable GP formulation. We’ve used
<span class="math inline">\(\textsf{LKJCorr}\)</span> for <span class="math inline">\(C(\phi)\)</span>, but any positive-definite matrix will do.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb170-1"><a href="fit-gp.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb170-2"><a href="fit-gp.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;</span>
<span id="cb170-3"><a href="fit-gp.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; D;</span>
<span id="cb170-4"><a href="fit-gp.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> x;</span>
<span id="cb170-5"><a href="fit-gp.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N, D] y;</span>
<span id="cb170-6"><a href="fit-gp.html#cb170-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-7"><a href="fit-gp.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb170-8"><a href="fit-gp.html#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> delta = <span class="fl">1e-9</span>;</span>
<span id="cb170-9"><a href="fit-gp.html#cb170-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-10"><a href="fit-gp.html#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb170-11"><a href="fit-gp.html#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; rho;</span>
<span id="cb170-12"><a href="fit-gp.html#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt;[D] alpha;</span>
<span id="cb170-13"><a href="fit-gp.html#cb170-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb170-14"><a href="fit-gp.html#cb170-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">cholesky_factor_corr</span>[D] L_Omega;</span>
<span id="cb170-15"><a href="fit-gp.html#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N, D] eta;</span>
<span id="cb170-16"><a href="fit-gp.html#cb170-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-17"><a href="fit-gp.html#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb170-18"><a href="fit-gp.html#cb170-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[N, D] f;</span>
<span id="cb170-19"><a href="fit-gp.html#cb170-19" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb170-20"><a href="fit-gp.html#cb170-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] K = cov_exp_quad(x, <span class="fl">1.0</span>, rho);</span>
<span id="cb170-21"><a href="fit-gp.html#cb170-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">matrix</span>[N, N] L_K;</span>
<span id="cb170-22"><a href="fit-gp.html#cb170-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-23"><a href="fit-gp.html#cb170-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// diagonal elements</span></span>
<span id="cb170-24"><a href="fit-gp.html#cb170-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb170-25"><a href="fit-gp.html#cb170-25" aria-hidden="true" tabindex="-1"></a>      K[n, n] = K[n, n] + delta;</span>
<span id="cb170-26"><a href="fit-gp.html#cb170-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-27"><a href="fit-gp.html#cb170-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-28"><a href="fit-gp.html#cb170-28" aria-hidden="true" tabindex="-1"></a>    L_K = cholesky_decompose(K);</span>
<span id="cb170-29"><a href="fit-gp.html#cb170-29" aria-hidden="true" tabindex="-1"></a>    f = L_K * eta</span>
<span id="cb170-30"><a href="fit-gp.html#cb170-30" aria-hidden="true" tabindex="-1"></a>        * diag_pre_multiply(alpha, L_Omega)&#39;;</span>
<span id="cb170-31"><a href="fit-gp.html#cb170-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb170-32"><a href="fit-gp.html#cb170-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-33"><a href="fit-gp.html#cb170-33" aria-hidden="true" tabindex="-1"></a>  rho ~ inv_gamma(<span class="dv">5</span>, <span class="dv">5</span>);</span>
<span id="cb170-34"><a href="fit-gp.html#cb170-34" aria-hidden="true" tabindex="-1"></a>  alpha ~ std_normal();</span>
<span id="cb170-35"><a href="fit-gp.html#cb170-35" aria-hidden="true" tabindex="-1"></a>  sigma ~ std_normal();</span>
<span id="cb170-36"><a href="fit-gp.html#cb170-36" aria-hidden="true" tabindex="-1"></a>  L_Omega ~ lkj_corr_cholesky(<span class="dv">3</span>);</span>
<span id="cb170-37"><a href="fit-gp.html#cb170-37" aria-hidden="true" tabindex="-1"></a>  to_vector(eta) ~ std_normal();</span>
<span id="cb170-38"><a href="fit-gp.html#cb170-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-39"><a href="fit-gp.html#cb170-39" aria-hidden="true" tabindex="-1"></a>  to_vector(y) ~ normal(to_vector(f), sigma);</span>
<span id="cb170-40"><a href="fit-gp.html#cb170-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-41"><a href="fit-gp.html#cb170-41" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb170-42"><a href="fit-gp.html#cb170-42" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matrix</span>[D, D] Omega;</span>
<span id="cb170-43"><a href="fit-gp.html#cb170-43" aria-hidden="true" tabindex="-1"></a>  Omega = L_Omega * L_Omega&#39;;</span>
<span id="cb170-44"><a href="fit-gp.html#cb170-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
<!-- </div> -->
<h3><i style="font-size: 110%; color:#990017;">References</i><a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Neal:1996" class="csl-entry">
Neal, Radford M. 1996a. <em>Bayesian Learning for Neural Networks</em>. Lecture Notes in Statistics 118. New York: Springer.
</div>
<div id="ref-Neal:1997" class="csl-entry">
———. 1997. <span>“Monte <span>C</span>arlo Implementation of <span>G</span>aussian Process Models for <span>B</span>ayesian Regression and Classification.”</span> 9702. University of Toronto, Department of Statistics.
</div>
<div id="ref-PiironenVehtari:2016" class="csl-entry">
Piironen, Juho, and Aki Vehtari. 2016. <span>“Projection Predictive Model Selection for <span>Gaussian</span> Processes.”</span> In <em>Machine Learning for Signal Processing (MLSP), 2016 IEEE 26th International Workshop on</em>. IEEE.
</div>
<div id="ref-RasmussenWilliams:2006" class="csl-entry">
Rasmussen, Carl Edward, and Christopher K. I. Williams. 2006. <em>Gaussian Processes for Machine Learning</em>. MIT Press.
</div>
<div id="ref-zhang-gp:2004" class="csl-entry">
Zhang, Hao. 2004. <span>“Inconsistent Estimation and Asymptotically Equal Interpolations in Model-Based Geostatistics.”</span> <em>Journal of the American Statistical Association</em> 99 (465): 250–61.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="24">
<li id="fn24"><p>A boundary-avoiding prior is just one where the limit of the density is zero at the boundary, the result of which is estimates that are pushed away from the boundary.<a href="fit-gp.html#fnref24" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulating-from-a-gaussian-process.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="directions-rotations-and-hyperspheres.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/stan-dev/docs/tree/master/src/stan-users-guide/gaussian-processes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
