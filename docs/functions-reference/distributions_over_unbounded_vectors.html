<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Distributions over Unbounded Vectors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../functions-reference/simplex_distributions.html" rel="next">
<link href="../functions-reference/bounded_continuous_distributions.html" rel="prev">
<link href="../img/logo_tm.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 200,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../quarto_styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo_tm.png" alt="Stan logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../stan-users-guide/index.html"> 
<span class="menu-text">Stan Users Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../reference-manual/index.html"> 
<span class="menu-text">Reference Manual</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../functions-reference/index.html" aria-current="page"> 
<span class="menu-text">Functions Reference</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-interfaces" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Interfaces</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-interfaces">    
        <li>
    <a class="dropdown-item" href="../cmdstan-guide/index.html">
 <span class="dropdown-text">CmdStan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/cmdstanpy">
 <span class="dropdown-text">CmdStanPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/cmdstanr">
 <span class="dropdown-text">CmdStanR</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/users/interfaces/pystan.html">
 <span class="dropdown-text">PyStan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/rstan">
 <span class="dropdown-text">RStan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="http://stanjulia.github.io/Stan.jl/stable/INTRO/">
 <span class="dropdown-text">Stan.jl</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other-packages" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other Packages</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-other-packages">    
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/bayesplot/">
 <span class="dropdown-text">bayesplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://roualdes.github.io/bridgestan/latest/">
 <span class="dropdown-text">BridgeStan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://paul-buerkner.github.io/brms/">
 <span class="dropdown-text">brms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/loo/">
 <span class="dropdown-text">loo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/posterior">
 <span class="dropdown-text">posterior</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/projpred">
 <span class="dropdown-text">projpred</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/rstanarm">
 <span class="dropdown-text">rstanarm</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/rstantools">
 <span class="dropdown-text">rstantools</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mc-stan.org/shinystan">
 <span class="dropdown-text">shinystan</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/stan-dev" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://discourse.mc-stan.org" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-chat-text-fill"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../functions-reference/unbounded_continuous_distributions.html">Continuous Distributions</a></li><li class="breadcrumb-item"><a href="../functions-reference/distributions_over_unbounded_vectors.html">Distributions over Unbounded Vectors</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stan Functions Reference</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Version 2.34</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Built-in Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/void_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Void Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/integer-valued_basic_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integer-Valued Basic Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/real-valued_basic_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Real-Valued Basic Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/complex-valued_basic_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complex-Valued Basic Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/array_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Array Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/complex_matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complex Matrix Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/sparse_matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sparse Matrix Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/mixed_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/compound_arithmetic_and_assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compound Arithmetic and Assignment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/higher-order_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Higher-Order Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/deprecated_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deprecated Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/removed_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Removed Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/conventions_for_probability_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conventions for Probability Functions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Discrete Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/binary_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/bounded_discrete_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bounded Discrete Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/unbounded_discrete_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unbounded Discrete Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/multivariate_discrete_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate Discrete Distributions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Continuous Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/unbounded_continuous_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unbounded Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/positive_continuous_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positive Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/positive_lower-bounded_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positive Lower-Bounded Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/continuous_distributions_on_0_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous Distributions on [0, 1]</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/circular_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Circular Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/bounded_continuous_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bounded Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/distributions_over_unbounded_vectors.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Distributions over Unbounded Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/simplex_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simplex Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/correlation_matrix_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation Matrix Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/covariance_matrix_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Covariance Matrix Distributions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Additional Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/hidden_markov_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/mathematical_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mathematical Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions-reference/functions_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alphabetical Index</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#distributions-over-unbounded-vectors" id="toc-distributions-over-unbounded-vectors" class="nav-link active" data-scroll-target="#distributions-over-unbounded-vectors">Distributions over Unbounded Vectors</a>
  <ul class="collapse">
  <li><a href="#multivariate-normal-distribution" id="toc-multivariate-normal-distribution" class="nav-link" data-scroll-target="#multivariate-normal-distribution">Multivariate normal distribution</a>
  <ul class="collapse">
  <li><a href="#probability-density-function" id="toc-probability-density-function" class="nav-link" data-scroll-target="#probability-density-function">Probability density function</a></li>
  <li><a href="#sampling-statement" id="toc-sampling-statement" class="nav-link" data-scroll-target="#sampling-statement">Sampling statement</a></li>
  <li><a href="#stan-functions" id="toc-stan-functions" class="nav-link" data-scroll-target="#stan-functions">Stan functions</a></li>
  </ul></li>
  <li><a href="#multivariate-normal-distribution-precision-parameterization" id="toc-multivariate-normal-distribution-precision-parameterization" class="nav-link" data-scroll-target="#multivariate-normal-distribution-precision-parameterization">Multivariate normal distribution, precision parameterization</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-1" id="toc-probability-density-function-1" class="nav-link" data-scroll-target="#probability-density-function-1">Probability density function</a></li>
  <li><a href="#sampling-statement-1" id="toc-sampling-statement-1" class="nav-link" data-scroll-target="#sampling-statement-1">Sampling statement</a></li>
  <li><a href="#stan-functions-1" id="toc-stan-functions-1" class="nav-link" data-scroll-target="#stan-functions-1">Stan functions</a></li>
  </ul></li>
  <li><a href="#multi-normal-cholesky-fun" id="toc-multi-normal-cholesky-fun" class="nav-link" data-scroll-target="#multi-normal-cholesky-fun">Multivariate normal distribution, Cholesky parameterization</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-2" id="toc-probability-density-function-2" class="nav-link" data-scroll-target="#probability-density-function-2">Probability density function</a></li>
  <li><a href="#sampling-statement-2" id="toc-sampling-statement-2" class="nav-link" data-scroll-target="#sampling-statement-2">Sampling statement</a></li>
  <li><a href="#stan-functions-2" id="toc-stan-functions-2" class="nav-link" data-scroll-target="#stan-functions-2">Stan functions</a></li>
  </ul></li>
  <li><a href="#multivariate-gaussian-process-distribution" id="toc-multivariate-gaussian-process-distribution" class="nav-link" data-scroll-target="#multivariate-gaussian-process-distribution">Multivariate Gaussian process distribution</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-3" id="toc-probability-density-function-3" class="nav-link" data-scroll-target="#probability-density-function-3">Probability density function</a></li>
  <li><a href="#sampling-statement-3" id="toc-sampling-statement-3" class="nav-link" data-scroll-target="#sampling-statement-3">Sampling statement</a></li>
  <li><a href="#stan-functions-3" id="toc-stan-functions-3" class="nav-link" data-scroll-target="#stan-functions-3">Stan functions</a></li>
  </ul></li>
  <li><a href="#multivariate-gaussian-process-distribution-cholesky-parameterization" id="toc-multivariate-gaussian-process-distribution-cholesky-parameterization" class="nav-link" data-scroll-target="#multivariate-gaussian-process-distribution-cholesky-parameterization">Multivariate Gaussian process distribution, Cholesky parameterization</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-4" id="toc-probability-density-function-4" class="nav-link" data-scroll-target="#probability-density-function-4">Probability density function</a></li>
  <li><a href="#sampling-statement-4" id="toc-sampling-statement-4" class="nav-link" data-scroll-target="#sampling-statement-4">Sampling statement</a></li>
  <li><a href="#stan-functions-4" id="toc-stan-functions-4" class="nav-link" data-scroll-target="#stan-functions-4">Stan functions</a></li>
  </ul></li>
  <li><a href="#multivariate-student-t-distribution" id="toc-multivariate-student-t-distribution" class="nav-link" data-scroll-target="#multivariate-student-t-distribution">Multivariate Student-t distribution</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-5" id="toc-probability-density-function-5" class="nav-link" data-scroll-target="#probability-density-function-5">Probability density function</a></li>
  <li><a href="#sampling-statement-5" id="toc-sampling-statement-5" class="nav-link" data-scroll-target="#sampling-statement-5">Sampling statement</a></li>
  <li><a href="#stan-functions-5" id="toc-stan-functions-5" class="nav-link" data-scroll-target="#stan-functions-5">Stan functions</a></li>
  </ul></li>
  <li><a href="#multi-student-t-cholesky-fun" id="toc-multi-student-t-cholesky-fun" class="nav-link" data-scroll-target="#multi-student-t-cholesky-fun">Multivariate Student-t distribution, Cholesky parameterization</a>
  <ul class="collapse">
  <li><a href="#probability-density-function-6" id="toc-probability-density-function-6" class="nav-link" data-scroll-target="#probability-density-function-6">Probability density function</a></li>
  <li><a href="#sampling-statement-6" id="toc-sampling-statement-6" class="nav-link" data-scroll-target="#sampling-statement-6">Sampling statement</a></li>
  <li><a href="#stan-functions-6" id="toc-stan-functions-6" class="nav-link" data-scroll-target="#stan-functions-6">Stan functions</a></li>
  </ul></li>
  <li><a href="#gaussian-dynamic-linear-models" id="toc-gaussian-dynamic-linear-models" class="nav-link" data-scroll-target="#gaussian-dynamic-linear-models">Gaussian dynamic linear models</a>
  <ul class="collapse">
  <li><a href="#sampling-statement-7" id="toc-sampling-statement-7" class="nav-link" data-scroll-target="#sampling-statement-7">Sampling statement</a></li>
  <li><a href="#stan-functions-7" id="toc-stan-functions-7" class="nav-link" data-scroll-target="#stan-functions-7">Stan functions</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/stan-dev/docs/edit/master/src/functions-reference/distributions_over_unbounded_vectors.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/stan-dev/docs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="distributions-over-unbounded-vectors" class="level1">
<h1>Distributions over Unbounded Vectors</h1>
<p>The unbounded vector probability distributions have support on all of <span class="math inline">\(\mathbb{R}^K\)</span> for some fixed <span class="math inline">\(K\)</span>.</p>
<section id="multivariate-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-normal-distribution">Multivariate normal distribution</h2>
<section id="probability-density-function" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function">Probability density function</h3>
<p>If <span class="math inline">\(K \in \mathbb{N}\)</span>, <span class="math inline">\(\mu \in \mathbb{R}^K\)</span>, and <span class="math inline">\(\Sigma \in
\mathbb{R}^{K \times   K}\)</span> is symmetric and positive definite, then for <span class="math inline">\(y \in \mathbb{R}^K\)</span>, <span class="math display">\[\begin{equation*}
\text{MultiNormal}(y|\mu,\Sigma) =
\frac{1}{\left( 2 \pi \right)^{K/2}} \ \frac{1}{\sqrt{|\Sigma|}}
\  \exp \! \left( \! - \frac{1}{2} (y - \mu)^{\top} \, \Sigma^{-1} \, (y - \mu) \right) \! ,
\end{equation*}\]</span> where <span class="math inline">\(|\Sigma|\)</span> is the absolute determinant of <span class="math inline">\(\Sigma\)</span>.</p>
</section>
<section id="sampling-statement" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_normal</code></strong><code>(mu, Sigma)</code></p>
<p>Increment target log probability density with <code>multi_normal_lupdf(y | mu, Sigma)</code>.</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-55bcd96ac570a9cd0612aa8c9853df2ef3ca7750" class="index-entry"></a> <!-- real; multi_normal ~; -->
<p></p>
</section>
<section id="stan-functions" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions">Stan functions</h3>
<p>The multivariate normal probability function is overloaded to allow the variate vector <span class="math inline">\(y\)</span> and location vector <span class="math inline">\(\mu\)</span> to be vectors or row vectors (or to mix the two types). The density function is also vectorized, so it allows arrays of row vectors or vectors as arguments; see section <a href="../functions-reference/conventions_for_probability_functions.html#prob-vectorization">vectorized function signatures</a> for a description of vectorization.</p>
<a id="index-entry-ea7d4337cebac7fdbfa928b24a3626208823e80e" class="index-entry"></a> <!-- real; multi_normal_lpdf; (vectors y | vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lpdf</code></strong><code>(vectors y | vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and covariance matrix Sigma</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-7786848b839eeda0bfa728760464ac4a8369550d" class="index-entry"></a> <!-- real; multi_normal_lupdf; (vectors y | vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lupdf</code></strong><code>(vectors y | vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and covariance matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-c1e8d116401a5e7f66812da95e1285dc2a3b111a" class="index-entry"></a> <!-- real; multi_normal_lpdf; (vectors y | row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lpdf</code></strong><code>(vectors y | row_vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and covariance matrix Sigma</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-a0fb7f94e06645589741da551fba4a55a0a33e44" class="index-entry"></a> <!-- real; multi_normal_lupdf; (vectors y | row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lupdf</code></strong><code>(vectors y | row_vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and covariance matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-fe635d231edc36e95bda6936e3dc7f58cf04d7b9" class="index-entry"></a> <!-- real; multi_normal_lpdf; (row_vectors y | vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lpdf</code></strong><code>(row_vectors y | vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and covariance matrix Sigma</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-69f99f5b6cefce126adc27f7b20728705d7e8a53" class="index-entry"></a> <!-- real; multi_normal_lupdf; (row_vectors y | vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lupdf</code></strong><code>(row_vectors y | vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and covariance matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-7d157b823f0ae33310094712caff4096b644a282" class="index-entry"></a> <!-- real; multi_normal_lpdf; (row_vectors y | row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lpdf</code></strong><code>(row_vectors y | row_vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and covariance matrix Sigma</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-86c5dd8e6cf2c484c3c76fffcadc99f786b7265b" class="index-entry"></a> <!-- real; multi_normal_lupdf; (row_vectors y | row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_lupdf</code></strong><code>(row_vectors y | row_vectors mu, matrix Sigma)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and covariance matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<p>Although there is a direct multi-normal RNG function, if more than one result is required, it’s much more efficient to Cholesky factor the covariance matrix and call <code>multi_normal_cholesky_rng</code>; see section <a href="#multi-normal-cholesky-fun">multi-variate normal, cholesky parameterization</a>.</p>
<a id="index-entry-d83a51f846b5823f2e419d6189b27cd98643a584" class="index-entry"></a> <!-- vector; multi_normal_rng; (vector mu, matrix Sigma); -->
<p></p>
<p><code>vector</code> <strong><code>multi_normal_rng</code></strong><code>(vector mu, matrix Sigma)</code><br> Generate a multivariate normal variate with location mu and covariance matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-70771ae7e3296e2a09378f81d64a16d0ffdebe49" class="index-entry"></a> <!-- vector; multi_normal_rng; (row_vector mu, matrix Sigma); -->
<p></p>
<p><code>vector</code> <strong><code>multi_normal_rng</code></strong><code>(row_vector mu, matrix Sigma)</code><br> Generate a multivariate normal variate with location mu and covariance matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-ba20f2e8644cf2fff8761565c61ae10f1160df3a" class="index-entry"></a> <!-- vectors; multi_normal_rng; (vectors mu, matrix Sigma); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_normal_rng</code></strong><code>(vectors mu, matrix Sigma)</code><br> Generate an array of multivariate normal variates with locations mu and covariance matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-214830eeea24ebd3c375e92411ceab1101a15b6c" class="index-entry"></a> <!-- vectors; multi_normal_rng; (row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_normal_rng</code></strong><code>(row_vectors mu, matrix Sigma)</code><br> Generate an array of multivariate normal variates with locations mu and covariance matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
</section>
</section>
<section id="multivariate-normal-distribution-precision-parameterization" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-normal-distribution-precision-parameterization">Multivariate normal distribution, precision parameterization</h2>
<section id="probability-density-function-1" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-1">Probability density function</h3>
<p>If <span class="math inline">\(K \in \mathbb{N}\)</span>, <span class="math inline">\(\mu \in \mathbb{R}^K\)</span>, and <span class="math inline">\(\Omega \in
\mathbb{R}^{K \times   K}\)</span> is symmetric and positive definite, then for <span class="math inline">\(y \in \mathbb{R}^K\)</span>, <span class="math display">\[\begin{equation*} \text{MultiNormalPrecision}(y|\mu,\Omega)
= \text{MultiNormal}(y|\mu,\Omega^{-1}) \end{equation*}\]</span></p>
</section>
<section id="sampling-statement-1" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-1">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_normal_prec</code></strong><code>(mu, Omega)</code></p>
<p>Increment target log probability density with <code>multi_normal_prec_lupdf(y | mu, Omega)</code>.</p>
<small><i>Available since 2.3</i></small>
<a id="index-entry-541ca6516f2a9c57d99c4d0b57a2b0a1df8a105d" class="index-entry"></a> <!-- real; multi_normal_prec ~; -->
<p></p>
</section>
<section id="stan-functions-1" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-1">Stan functions</h3>
<a id="index-entry-6a00a4a10d9e84eaa51e885395294f4b4e1272dd" class="index-entry"></a> <!-- real; multi_normal_prec_lpdf; (vectors y | vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lpdf</code></strong><code>(vectors y | vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and positive definite precision matrix Omega</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-e4db099421dc8d5cb5ccaf22226497142e4ad656" class="index-entry"></a> <!-- real; multi_normal_prec_lupdf; (vectors y | vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lupdf</code></strong><code>(vectors y | vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and positive definite precision matrix Omega dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-dcfb9bff5f659aa499401ffd77ffd7bbaa784936" class="index-entry"></a> <!-- real; multi_normal_prec_lpdf; (vectors y | row_vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lpdf</code></strong><code>(vectors y | row_vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and positive definite precision matrix Omega</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-ec0990b5c058b76b441e3132b8e4986f8fc3b9a6" class="index-entry"></a> <!-- real; multi_normal_prec_lupdf; (vectors y | row_vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lupdf</code></strong><code>(vectors y | row_vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and positive definite precision matrix Omega dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-8efc2d6f42f7fd5eeb961e3959b617201d45a58c" class="index-entry"></a> <!-- real; multi_normal_prec_lpdf; (row_vectors y | vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lpdf</code></strong><code>(row_vectors y | vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and positive definite precision matrix Omega</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-314ed87058998a1934a7cd80a00abca432768d68" class="index-entry"></a> <!-- real; multi_normal_prec_lupdf; (row_vectors y | vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lupdf</code></strong><code>(row_vectors y | vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and positive definite precision matrix Omega dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-eb92ca14c43c32d999ac0b10e2160f641a23f265" class="index-entry"></a> <!-- real; multi_normal_prec_lpdf; (row_vectors y | row_vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lpdf</code></strong><code>(row_vectors y | row_vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and positive definite precision matrix Omega</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-9cf50bfea31a9655df9c07627982295a3a884afa" class="index-entry"></a> <!-- real; multi_normal_prec_lupdf; (row_vectors y | row_vectors mu, matrix Omega); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_prec_lupdf</code></strong><code>(row_vectors y | row_vectors mu, matrix Omega)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and positive definite precision matrix Omega dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
</section>
</section>
<section id="multi-normal-cholesky-fun" class="level2">
<h2 class="anchored" data-anchor-id="multi-normal-cholesky-fun">Multivariate normal distribution, Cholesky parameterization</h2>
<section id="probability-density-function-2" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-2">Probability density function</h3>
<p>If <span class="math inline">\(K \in \mathbb{N}\)</span>, <span class="math inline">\(\mu \in \mathbb{R}^K\)</span>, and <span class="math inline">\(L \in
\mathbb{R}^{K \times K}\)</span> is lower triangular and such that <span class="math inline">\(LL^{\top}\)</span> is positive definite, then for <span class="math inline">\(y \in \mathbb{R}^K\)</span>, <span class="math display">\[\begin{equation*}
\text{MultiNormalCholesky}(y|\mu,L) =
\text{MultiNormal}(y|\mu,LL^{\top}). \end{equation*}\]</span> If <span class="math inline">\(L\)</span> is lower triangular and <span class="math inline">\(LL^{top}\)</span> is a <span class="math inline">\(K \times K\)</span> positive definite matrix, then <span class="math inline">\(L_{k,k}\)</span> must be strictly positive for <span class="math inline">\(k \in 1{:}K\)</span>. If an <span class="math inline">\(L\)</span> is provided that is not the Cholesky factor of a positive-definite matrix, the probability functions will raise errors.</p>
</section>
<section id="sampling-statement-2" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-2">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_normal_cholesky</code></strong><code>(mu, L)</code></p>
<p>Increment target log probability density with <code>multi_normal_cholesky_lupdf(y | mu, L)</code>.</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-478582106e708a75c36c3c557d30196407f15133" class="index-entry"></a> <!-- real; multi_normal_cholesky ~; -->
<p></p>
</section>
<section id="stan-functions-2" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-2">Stan functions</h3>
<a id="index-entry-b197f45c690e4b7dd4ebe29d9f75790be4acf177" class="index-entry"></a> <!-- real; multi_normal_cholesky_lpdf; (vectors y | vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lpdf</code></strong><code>(vectors y | vectors mu, matrix L)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-2ac54d7aebe6a22693ee5a9016fef469246a746c" class="index-entry"></a> <!-- real; multi_normal_cholesky_lupdf; (vectors y | vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lupdf</code></strong><code>(vectors y | vectors mu, matrix L)</code><br> The log of the multivariate normal density of vector(s) y given location vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-efdc316743c9c9f1a6ee782650494ee45cb045cd" class="index-entry"></a> <!-- real; multi_normal_cholesky_lpdf; (vectors y | row_vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lpdf</code></strong><code>(vectors y | row_vectors mu, matrix L)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-a04f4fcdecc170b474051229edff4d2358b9c619" class="index-entry"></a> <!-- real; multi_normal_cholesky_lupdf; (vectors y | row_vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lupdf</code></strong><code>(vectors y | row_vectors mu, matrix L)</code><br> The log of the multivariate normal density of vector(s) y given location row vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-69e5b64a11f77c97cd0fffeaee869c5358969237" class="index-entry"></a> <!-- real; multi_normal_cholesky_lpdf; (row_vectors y | vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lpdf</code></strong><code>(row_vectors y | vectors mu, matrix L)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-d3682df812ba6f35ad608d62b19f6c8ca23601f7" class="index-entry"></a> <!-- real; multi_normal_cholesky_lupdf; (row_vectors y | vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lupdf</code></strong><code>(row_vectors y | vectors mu, matrix L)</code><br> The log of the multivariate normal density of row vector(s) y given location vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-d5709f43c49fc57a5ef58e94e176962d2bff379a" class="index-entry"></a> <!-- real; multi_normal_cholesky_lpdf; (row_vectors y | row_vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lpdf</code></strong><code>(row_vectors y | row_vectors mu, matrix L)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-1606261a4f25b4e68b2bf4b1c8bf2513e62cdf5c" class="index-entry"></a> <!-- real; multi_normal_cholesky_lupdf; (row_vectors y | row_vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_normal_cholesky_lupdf</code></strong><code>(row_vectors y | row_vectors mu, matrix L)</code><br> The log of the multivariate normal density of row vector(s) y given location row vector(s) mu and lower-triangular Cholesky factor of the covariance matrix L dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-b2936af169906302b9686d4673d8c5a8da710efb" class="index-entry"></a> <!-- vector; multi_normal_cholesky_rng; (vector mu, matrix L); -->
<p></p>
<p><code>vector</code> <strong><code>multi_normal_cholesky_rng</code></strong><code>(vector mu, matrix L)</code><br> Generate a multivariate normal variate with location mu and lower-triangular Cholesky factor of the covariance matrix L; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.3</i></small>
<a id="index-entry-83a370eb75f07ac047e03e4dde9d64cf42e4c432" class="index-entry"></a> <!-- vector; multi_normal_cholesky_rng; (row_vector mu, matrix L); -->
<p></p>
<p><code>vector</code> <strong><code>multi_normal_cholesky_rng</code></strong><code>(row_vector mu, matrix L)</code><br> Generate a multivariate normal variate with location mu and lower-triangular Cholesky factor of the covariance matrix L; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-7e60f3380a18c3f7bbcc383bfa7fcd15c14c054b" class="index-entry"></a> <!-- vectors; multi_normal_cholesky_rng; (vectors mu, matrix L); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_normal_cholesky_rng</code></strong><code>(vectors mu, matrix L)</code><br> Generate an array of multivariate normal variates with locations mu and lower-triangular Cholesky factor of the covariance matrix L; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-e6934af3e7cb8c68c3aa044307129bbaf17ffabf" class="index-entry"></a> <!-- vectors; multi_normal_cholesky_rng; (row_vectors mu, matrix L); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_normal_cholesky_rng</code></strong><code>(row_vectors mu, matrix L)</code><br> Generate an array of multivariate normal variates with locations mu and lower-triangular Cholesky factor of the covariance matrix L; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
</section>
</section>
<section id="multivariate-gaussian-process-distribution" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-gaussian-process-distribution">Multivariate Gaussian process distribution</h2>
<section id="probability-density-function-3" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-3">Probability density function</h3>
<p>If <span class="math inline">\(K,N \in \mathbb{N}\)</span>, <span class="math inline">\(\Sigma \in \mathbb{R}^{N \times N}\)</span> is symmetric, positive definite kernel matrix and <span class="math inline">\(w \in \mathbb{R}^{K}\)</span> is a vector of positive inverse scales, then for <span class="math inline">\(y \in \mathbb{R}^{K
\times N}\)</span>, <span class="math display">\[\begin{equation*} \text{MultiGP}(y|\Sigma,w) = \prod_{i=1}^{K}
\text{MultiNormal}(y_i|0,w_i^{-1} \Sigma), \end{equation*}\]</span> where <span class="math inline">\(y_i\)</span> is the <span class="math inline">\(i\)</span>th row of <span class="math inline">\(y\)</span>. This is used to efficiently handle Gaussian Processes with multi-variate outputs where only the output dimensions share a kernel function but vary based on their scale. Note that this function does not take into account the mean prediction.</p>
</section>
<section id="sampling-statement-3" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-3">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_gp</code></strong><code>(Sigma, w)</code></p>
<p>Increment target log probability density with <code>multi_gp_lupdf(y | Sigma, w)</code>.</p>
<small><i>Available since 2.3</i></small>
<a id="index-entry-457f8d9e9ebaf6012b892a8241fe77b322473f49" class="index-entry"></a> <!-- real; multi_gp ~; -->
<p></p>
</section>
<section id="stan-functions-3" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-3">Stan functions</h3>
<a id="index-entry-fdd1f01264b88aa3f7a0cae0db463d1f87d5e0e8" class="index-entry"></a> <!-- real; multi_gp_lpdf; (matrix y | matrix Sigma, vector w); -->
<p></p>
<p><code>real</code> <strong><code>multi_gp_lpdf</code></strong><code>(matrix y | matrix Sigma, vector w)</code><br> The log of the multivariate GP density of matrix y given kernel matrix Sigma and inverses scales w</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-ead480cd44ceccdf956822e08476ca3b5ca14a76" class="index-entry"></a> <!-- real; multi_gp_lupdf; (matrix y | matrix Sigma, vector w); -->
<p></p>
<p><code>real</code> <strong><code>multi_gp_lupdf</code></strong><code>(matrix y | matrix Sigma, vector w)</code><br> The log of the multivariate GP density of matrix y given kernel matrix Sigma and inverses scales w dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
</section>
</section>
<section id="multivariate-gaussian-process-distribution-cholesky-parameterization" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-gaussian-process-distribution-cholesky-parameterization">Multivariate Gaussian process distribution, Cholesky parameterization</h2>
<section id="probability-density-function-4" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-4">Probability density function</h3>
<p>If <span class="math inline">\(K,N \in \mathbb{N}\)</span>, <span class="math inline">\(L \in \mathbb{R}^{N \times N}\)</span> is lower triangular and such that <span class="math inline">\(LL^{\top}\)</span> is positive definite kernel matrix (implying <span class="math inline">\(L_{n,n} &gt; 0\)</span> for <span class="math inline">\(n \in 1{:}N\)</span>), and <span class="math inline">\(w \in
\mathbb{R}^{K}\)</span> is a vector of positive inverse scales, then for <span class="math inline">\(y
\in \mathbb{R}^{K \times N}\)</span>, <span class="math display">\[\begin{equation*} \text{MultiGPCholesky}(y \, | \ L,w)
= \prod_{i=1}^{K} \text{MultiNormal}(y_i|0,w_i^{-1} LL^{\top}), \end{equation*}\]</span> where <span class="math inline">\(y_i\)</span> is the <span class="math inline">\(i\)</span>th row of <span class="math inline">\(y\)</span>. This is used to efficiently handle Gaussian Processes with multi-variate outputs where only the output dimensions share a kernel function but vary based on their scale. If the model allows parameterization in terms of Cholesky factor of the kernel matrix, this distribution is also more efficient than <span class="math inline">\(\text{MultiGP}()\)</span>. Note that this function does not take into account the mean prediction.</p>
</section>
<section id="sampling-statement-4" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-4">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_gp_cholesky</code></strong><code>(L, w)</code></p>
<p>Increment target log probability density with <code>multi_gp_cholesky_lupdf(y | L, w)</code>.</p>
<small><i>Available since 2.5</i></small>
<a id="index-entry-5a77e4209bc50ea87ef1dbcce3bad7b10b094a6b" class="index-entry"></a> <!-- real; multi_gp_cholesky ~; -->
<p></p>
</section>
<section id="stan-functions-4" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-4">Stan functions</h3>
<a id="index-entry-2903bb116c036e35d3cb81e008dcad2b7a6e6756" class="index-entry"></a> <!-- real; multi_gp_cholesky_lpdf; (matrix y | matrix L, vector w); -->
<p></p>
<p><code>real</code> <strong><code>multi_gp_cholesky_lpdf</code></strong><code>(matrix y | matrix L, vector w)</code><br> The log of the multivariate GP density of matrix y given lower-triangular Cholesky factor of the kernel matrix L and inverses scales w</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-df18f8bd56610fdd6df3192990ee5cb001142817" class="index-entry"></a> <!-- real; multi_gp_cholesky_lupdf; (matrix y | matrix L, vector w); -->
<p></p>
<p><code>real</code> <strong><code>multi_gp_cholesky_lupdf</code></strong><code>(matrix y | matrix L, vector w)</code><br> The log of the multivariate GP density of matrix y given lower-triangular Cholesky factor of the kernel matrix L and inverses scales w dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
</section>
</section>
<section id="multivariate-student-t-distribution" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-student-t-distribution">Multivariate Student-t distribution</h2>
<section id="probability-density-function-5" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-5">Probability density function</h3>
<p>If <span class="math inline">\(K \in \mathbb{N}\)</span>, <span class="math inline">\(\nu \in \mathbb{R}^+\)</span>, <span class="math inline">\(\mu \in \mathbb{R}^K\)</span>, and <span class="math inline">\(\Sigma \in \mathbb{R}^{K \times K}\)</span> is symmetric and positive definite, then for <span class="math inline">\(y \in \mathbb{R}^K\)</span>, <span class="math display">\[\begin{equation*} \begin{array}{l}
\text{MultiStudentT}(y\,|\,\nu,\,\mu,\,\Sigma) \\  =
\frac{1}{\pi^{K/2}} \ \frac{1}{\nu^{K/2}} \ \frac{\Gamma\!\left((\nu +
K)/2\right)}      {\Gamma(\nu/2)} \ \frac{1}{\sqrt{\left| \Sigma
\right|}} \ \left( 1 + \frac{1}{\nu} \, \left(y - \mu\right)^{\top} \,
\Sigma^{-1} \, \left(y - \mu\right) \right)^{-(\nu + K)/2} \! .
\end{array} \end{equation*}\]</span></p>
</section>
<section id="sampling-statement-5" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-5">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_student_t</code></strong><code>(nu, mu, Sigma)</code></p>
<p>Increment target log probability density with <code>multi_student_t_lupdf(y | nu, mu, Sigma)</code>.</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-6f17c5611de64710688848607c0edd592e244fe1" class="index-entry"></a> <!-- real; multi_student_t ~; -->
<p></p>
</section>
<section id="stan-functions-5" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-5">Stan functions</h3>
<a id="index-entry-69dbd18bfe0fa38bad7531c187ffd5ddbc68655e" class="index-entry"></a> <!-- real; multi_student_t_lpdf; (vectors y | real nu, vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lpdf</code></strong><code>(vectors y | real nu, vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector(s) y given degrees of freedom nu, location vector(s) mu, and scale matrix Sigma</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-ed2f0cb9d8bc8294e4c924451d7f556f82d5157c" class="index-entry"></a> <!-- real; multi_student_t_lupdf; (vectors y | real nu, vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lupdf</code></strong><code>(vectors y | real nu, vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector(s) y given degrees of freedom nu, location vector(s) mu, and scale matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-97bab7be0967824f68beadb09ab9fc5152e4b605" class="index-entry"></a> <!-- real; multi_student_t_lpdf; (vectors y | real nu, row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lpdf</code></strong><code>(vectors y | real nu, row_vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector(s) y given degrees of freedom nu, location row vector(s) mu, and scale matrix Sigma</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-74a88cd182b98cb2259da79ec60775f5d1f01084" class="index-entry"></a> <!-- real; multi_student_t_lupdf; (vectors y | real nu, row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lupdf</code></strong><code>(vectors y | real nu, row_vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector(s) y given degrees of freedom nu, location row vector(s) mu, and scale matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-b0e0974e59e75e19f6b6c4aa22d8395d7ef922de" class="index-entry"></a> <!-- real; multi_student_t_lpdf; (row_vectors y | real nu, vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lpdf</code></strong><code>(row_vectors y | real nu, vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of row vector(s) y given degrees of freedom nu, location vector(s) mu, and scale matrix Sigma</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-7b3d937ea2e301a8d2455c2939ef7fc5c815d5ca" class="index-entry"></a> <!-- real; multi_student_t_lupdf; (row_vectors y | real nu, vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lupdf</code></strong><code>(row_vectors y | real nu, vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of row vector(s) y given degrees of freedom nu, location vector(s) mu, and scale matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-5b6e5c7b1a5d8704f96553d2ccd4fb053bdb4917" class="index-entry"></a> <!-- real; multi_student_t_lpdf; (row_vectors y | real nu, row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lpdf</code></strong><code>(row_vectors y | real nu, row_vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of row vector(s) y given degrees of freedom nu, location row vector(s) mu, and scale matrix Sigma</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-d92dadb3604f6521420ca422b762d25b60b94dbf" class="index-entry"></a> <!-- real; multi_student_t_lupdf; (row_vectors y | real nu, row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_lupdf</code></strong><code>(row_vectors y | real nu, row_vectors mu, matrix Sigma)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of row vector(s) y given degrees of freedom nu, location row vector(s) mu, and scale matrix Sigma dropping constant additive terms</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-e2a99afdcb2cc3ec5ffc0367d7d241f2b511a575" class="index-entry"></a> <!-- vector; multi_student_t_rng; (real nu, vector mu, matrix Sigma); -->
<p></p>
<p><code>vector</code> <strong><code>multi_student_t_rng</code></strong><code>(real nu, vector mu, matrix Sigma)</code><br> Generate a multivariate Student-<span class="math inline">\(t\)</span> variate with degrees of freedom nu, location mu, and scale matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-18f756f159784f68dc00bac1706c5e31f805daf3" class="index-entry"></a> <!-- vector; multi_student_t_rng; (real nu, row_vector mu, matrix Sigma); -->
<p></p>
<p><code>vector</code> <strong><code>multi_student_t_rng</code></strong><code>(real nu, row_vector mu, matrix Sigma)</code><br> Generate a multivariate Student-<span class="math inline">\(t\)</span> variate with degrees of freedom nu, location mu, and scale matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-d65fa98b0f3f647ffd2cbe3f445ab17be93735dc" class="index-entry"></a> <!-- vectors; multi_student_t_rng; (real nu, vectors mu, matrix Sigma); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_student_t_rng</code></strong><code>(real nu, vectors mu, matrix Sigma)</code><br> Generate an array of multivariate Student-<span class="math inline">\(t\)</span> variates with degrees of freedom nu, locations mu, and scale matrix Sigma; may only be used in transformed data and generated quantities blocks</p>
<small><i>Available since 2.18</i></small>
<a id="index-entry-f05b8a3480e2360d1224acb270aca05c90674ba1" class="index-entry"></a> <!-- vectors; multi_student_t_rng; (real nu, row_vectors mu, matrix Sigma); -->
<p></p>
<p><code>vectors</code> <strong><code>multi_student_t_rng</code></strong><code>(real nu, row_vectors mu, matrix Sigma)</code><br> Generate an array of multivariate Student-<span class="math inline">\(t\)</span> variates with degrees of freedom nu, locations mu, and scale matrix Sigma; may only be used in transformed data andgenerated quantities blocks</p>
<small><i>Available since 2.18</i></small>
</section>
</section>
<section id="multi-student-t-cholesky-fun" class="level2">
<h2 class="anchored" data-anchor-id="multi-student-t-cholesky-fun">Multivariate Student-t distribution, Cholesky parameterization</h2>
<section id="probability-density-function-6" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-6">Probability density function</h3>
<p>Let <span class="math inline">\(K \in \mathbb{N}\)</span>, <span class="math inline">\(\nu \in \mathbb{R}^+\)</span>, <span class="math inline">\(\mu \in \mathbb{R}^K\)</span>, and <span class="math inline">\(L\)</span> a <span class="math inline">\(K \times K\)</span> lower-triangular matrix with strictly positive, finite diagonal then <span class="math display">\[\begin{equation*}
\begin{array}{l}
\text{MultiStudentTCholesky}(y\,\mid \nu,\,\mu,\,L) \\  =
\frac{1}{\pi^{K/2}} \ \frac{1}{\nu^{K/2}} \ \frac{\Gamma\!\left((\nu +
K)/2\right)}      {\Gamma(\nu/2)} \ \frac{1}{\left| L
\right|} \ \left( 1 + \frac{1}{\nu} \, \left(y - \mu\right)^{\top} \,
L^{-T}L^{-1} \, \left(y - \mu\right) \right)^{-(\nu + K)/2} \! .
\end{array}
\end{equation*}\]</span></p>
</section>
<section id="sampling-statement-6" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-6">Sampling statement</h3>
<p><code>y ~</code> <strong><code>multi_student_t_cholesky</code></strong><code>(nu, mu, L)</code></p>
<p>Increment target log probability density with <code>multi_student_t_cholesky_lupdf(y | nu, mu, L)</code>.</p>
<small><i>Available since 2.30</i></small>
<a id="index-entry-190447ef796a8d04715897b349d1433608a8a0e3" class="index-entry"></a> <!-- real; multi_student_t_cholesky ~; -->
<p></p>
</section>
<section id="stan-functions-6" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-6">Stan functions</h3>
<a id="index-entry-79368cb327eb8f4f3056a3e71077b92df2406595" class="index-entry"></a> <!-- real; multi_student_t_cholesky_lpdf; (vectors y | real nu, vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_cholesky_lpdf</code></strong><code>(vectors y | real nu, vectors mu, matrix L)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector or array of vectors <code>y</code> given degrees of freedom <code>nu</code>, location vector or array of vectors <code>mu</code>, and Cholesky factor of the scale matrix <code>L</code>. For a definition of the arguments compatible with the <code>vectors</code> type, see the <a href="../functions-reference/conventions_for_probability_functions.html#prob-vectorization">probability vectorization section</a>.</p>
<small><i>Available since 2.30</i></small>
<a id="index-entry-4b504cf934bd0448a4e3174a7a7b34f46cfa7d8c" class="index-entry"></a> <!-- real; multi_student_t_cholesky_lupdf; (vectors y | real nu, vectors mu, matrix L); -->
<p></p>
<p><code>real</code> <strong><code>multi_student_t_cholesky_lupdf</code></strong><code>(vectors y | real nu, vectors mu, matrix L)</code><br> The log of the multivariate Student-<span class="math inline">\(t\)</span> density of vector or vector array <code>y</code> given degrees of freedom <code>nu</code>, location vector or vector array <code>mu</code>, and Cholesky factor of the scale matrix <code>L</code>, dropping constant additive terms. For a definition of arguments compatible with the <code>vectors</code> type, see the <a href="../functions-reference/conventions_for_probability_functions.html#prob-vectorization">probability vectorization section</a>.</p>
<small><i>Available since 2.30</i></small>
<a id="index-entry-37c54942aa5cd7ed73303ca868eeb65b156be282" class="index-entry"></a> <!-- vector; multi_student_cholesky_t_rng; (real nu, vector mu, matrix L); -->
<p></p>
<p><code>vector</code> <strong><code>multi_student_t_cholesky_rng</code></strong><code>(real nu, vector mu, matrix L)</code><br> Generate a multivariate Student-<span class="math inline">\(t\)</span> variate with degrees of freedom <code>nu</code>, location <code>mu</code>, and Cholesky factor of the scale matrix <code>L</code>; may only be used in transformed data and generated quantities blocks.</p>
<small><i>Available since 2.30</i></small>
<a id="index-entry-da90fd4020ba98291c4e0c6ae45340c32e83bdc6" class="index-entry"></a> <!-- array[] vector; multi_student_t_cholesky_rng; (real nu, array[] vector mu, matrix L); -->
<p></p>
<p><code>array[] vector</code> <strong><code>multi_student_t_cholesky_rng</code></strong><code>(real nu, array[] vector mu, matrix L)</code><br> Generate a multivariate Student-<span class="math inline">\(t\)</span> variate with degrees of freedom <code>nu</code>, location array <code>mu</code>, and Cholesky factor of the scale matrix <code>L</code>; may only be used in transformed data and generated quantities blocks.</p>
<small><i>Available since 2.30</i></small>
<a id="index-entry-48a1c071b3760543bf2019dc6c37df56b26a25b4" class="index-entry"></a> <!-- array[] vector; multi_student_t_cholesky_rng; (real nu, array[] row_vector mu, matrix L); -->
<p></p>
<p><code>array[] vector</code> <strong><code>multi_student_t_cholesky_rng</code></strong><code>(real nu, array[] row_vector mu, matrix L)</code><br> Generate an array of multivariate Student-<span class="math inline">\(t\)</span> variate with degrees of freedom <code>nu</code>, location array <code>mu</code>, and Cholesky factor of the scale matrix <code>L</code>; may only be used in transformed data and generated quantities blocks.</p>
<small><i>Available since 2.30</i></small>
</section>
</section>
<section id="gaussian-dynamic-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="gaussian-dynamic-linear-models">Gaussian dynamic linear models</h2>
<p>A Gaussian Dynamic Linear model is defined as follows, For <span class="math inline">\(t \in 1,
\dots, T\)</span>, <span class="math display">\[\begin{equation*}   \begin{aligned}[t]     y_{t} &amp;\sim N(F' \theta_{t}, V)
\\     \theta_{t} &amp;\sim N(G \theta_{t - 1}, W) \\     \theta_{0} &amp;\sim
N(m_{0}, C_{0})   \end{aligned} \end{equation*}\]</span> where <span class="math inline">\(y\)</span> is <span class="math inline">\(n \times T\)</span> matrix where rows are variables and columns are observations. These functions calculate the log-likelihood of the observations marginalizing over the latent states (<span class="math inline">\(p(y | F, G, V, W, m_{0}, C_{0})\)</span>). This log-likelihood is a system that is calculated using the Kalman Filter. If <span class="math inline">\(V\)</span> is diagonal, then a more efficient algorithm which sequentially processes observations and avoids a matrix inversions can be used <span class="citation" data-cites="DurbinKoopman:2001">(<a href="#ref-DurbinKoopman:2001" role="doc-biblioref">Durbin and Koopman 2001, sec. 6.4</a>)</span>.</p>
<section id="sampling-statement-7" class="level3">
<h3 class="anchored" data-anchor-id="sampling-statement-7">Sampling statement</h3>
<p><code>y ~</code> <strong><code>gaussian_dlm_obs</code></strong><code>(F, G, V, W, m0, C0)</code></p>
<p>Increment target log probability density with <code>gaussian_dlm_obs_lupdf(y | F, G, V, W, m0, C0)</code>.</p>
<small><i>Available since 2.0</i></small>
<a id="index-entry-4fd242bf2dcd5be49146d526d8fbe39878489a73" class="index-entry"></a> <!-- real; gaussian_dlm_obs ~; -->
<p></p>
</section>
<section id="stan-functions-7" class="level3">
<h3 class="anchored" data-anchor-id="stan-functions-7">Stan functions</h3>
<p>The following two functions differ in the type of their V, the first taking a full observation covariance matrix V&nbsp;and the second a vector V&nbsp;representing the diagonal of the observation covariance matrix. The sampling statement defined in the previous section works with either type of observation V.</p>
<a id="index-entry-18a51c9f7a0d2635dc8adf29e702d2a918af65ed" class="index-entry"></a> <!-- real; gaussian_dlm_obs_lpdf; (matrix y | matrix F, matrix G, matrix V, matrix W, vector m0, matrix C0); -->
<p></p>
<p><code>real</code> <strong><code>gaussian_dlm_obs_lpdf</code></strong><code>(matrix y | matrix F, matrix G, matrix V, matrix W, vector m0, matrix C0)</code><br> The log of the density of the Gaussian Dynamic Linear model with observation matrix y in which rows are variables and columns are observations, design matrix F, transition matrix G, observation covariance matrix V, system covariance matrix W, and the initial state is distributed normal with mean m0 and covariance C0.</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-c55d98e7e02d60b3177dcb12f3f8a4d71d7b7770" class="index-entry"></a> <!-- real; gaussian_dlm_obs_lupdf; (matrix y | matrix F, matrix G, matrix V, matrix W, vector m0, matrix C0); -->
<p></p>
<p><code>real</code> <strong><code>gaussian_dlm_obs_lupdf</code></strong><code>(matrix y | matrix F, matrix G, matrix V, matrix W, vector m0, matrix C0)</code><br> The log of the density of the Gaussian Dynamic Linear model with observation matrix y in which rows are variables and columns are observations, design matrix F, transition matrix G, observation covariance matrix V, system covariance matrix W, and the initial state is distributed normal with mean m0 and covariance C0. This function drops constant additive terms.</p>
<small><i>Available since 2.25</i></small>
<a id="index-entry-8cca79a125123f82ff2e6982bc58099c4b4f2db4" class="index-entry"></a> <!-- real; gaussian_dlm_obs_lpdf; (matrix y | matrix F, matrix G, vector V, matrix W, vector m0, matrix C0); -->
<p></p>
<p><code>real</code> <strong><code>gaussian_dlm_obs_lpdf</code></strong><code>(matrix y | matrix F, matrix G, vector V, matrix W, vector m0, matrix C0)</code><br> The log of the density of the Gaussian Dynamic Linear model with observation matrix y in which rows are variables and columns are observations, design matrix F, transition matrix G, observation covariance matrix with diagonal V, system covariance matrix W, and the initial state is distributed normal with mean m0 and covariance C0.</p>
<small><i>Available since 2.12</i></small>
<a id="index-entry-14842eb0078230e2e500d5478fb688e1fd8c7fd3" class="index-entry"></a> <!-- real; gaussian_dlm_obs_lupdf; (matrix y | matrix F, matrix G, vector V, matrix W, vector m0, matrix C0); -->
<p></p>
<p><code>real</code> <strong><code>gaussian_dlm_obs_lupdf</code></strong><code>(matrix y | matrix F, matrix G, vector V, matrix W, vector m0, matrix C0)</code><br> The log of the density of the Gaussian Dynamic Linear model with observation matrix y in which rows are variables and columns are observations, design matrix F, transition matrix G, observation covariance matrix with diagonal V, system covariance matrix W, and the initial state is distributed normal with mean m0 and covariance C0. This function drops constant additive terms.</p>
<small><i>Available since 2.25</i></small>



</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-DurbinKoopman:2001" class="csl-entry" role="listitem">
Durbin, J., and S. J. Koopman. 2001. <em>Time Series Analysis by State Space Methods</em>. New York: Oxford University Press.
</div>
</div></section></div></main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../functions-reference/bounded_continuous_distributions.html" class="pagination-link" aria-label="Bounded Continuous Distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Bounded Continuous Distributions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../functions-reference/simplex_distributions.html" class="pagination-link" aria-label="Simplex Distributions">
        <span class="nav-page-text">Simplex Distributions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/stan-dev/docs/edit/master/src/functions-reference/distributions_over_unbounded_vectors.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/stan-dev/docs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>