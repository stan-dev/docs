<!DOCTYPE html>
<html >

<head>
<link rel="canonical" href="https://mc-stan.org/docs/reference-manual/analysis.html#notation-for-samples-chains-and-draws" />
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stan Reference Manual</title>
  <meta name="description" content="Stan reference manual specifying the syntax and semantics of the Stan programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Stan Reference Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/logo_tm.png" />
  <meta property="og:description" content="Stan reference manual specifying the syntax and semantics of the Stan programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stan Reference Manual" />
  
  <meta name="twitter:description" content="Stan reference manual specifying the syntax and semantics of the Stan programming language." />
  <meta name="twitter:image" content="img/logo_tm.png" />

<meta name="author" content="Stan Development Team">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="convergence.html">
<link rel="next" href="effective-sample-size-section.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="../stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/reference-manual/index.html" style="color:#4183C4">Stan Reference Manual</a></li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li><a href="language.html#language"><i style="font-size: 110%; color:#990017;">Language</i></a></li>
<li class="chapter" data-level="1" data-path="character-encoding.html"><a href="character-encoding.html"><i class="fa fa-check"></i><b>1</b> Character Encoding</a><ul>
<li class="chapter" data-level="1.1" data-path="content-characters.html"><a href="content-characters.html"><i class="fa fa-check"></i><b>1.1</b> Content Characters</a><ul>
<li class="chapter" data-level="" data-path="content-characters.html"><a href="content-characters.html#compatibility-with-latin-1-and-utf-8"><i class="fa fa-check"></i>Compatibility with Latin-1 and UTF-8</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="comment-characters.html"><a href="comment-characters.html"><i class="fa fa-check"></i><b>1.2</b> Comment Characters</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="includes-section.html"><a href="includes-section.html"><i class="fa fa-check"></i><b>2</b> Includes</a><ul>
<li class="chapter" data-level="2.0.1" data-path="includes-section.html"><a href="includes-section.html#space-before-includes"><i class="fa fa-check"></i><b>2.0.1</b> Space before includes</a></li>
<li class="chapter" data-level="2.0.2" data-path="includes-section.html"><a href="includes-section.html#comments-after-includes"><i class="fa fa-check"></i><b>2.0.2</b> Comments after includes</a></li>
<li class="chapter" data-level="2.1" data-path="recursive-includes.html"><a href="recursive-includes.html"><i class="fa fa-check"></i><b>2.1</b> Recursive Includes</a></li>
<li class="chapter" data-level="2.2" data-path="include-paths.html"><a href="include-paths.html"><i class="fa fa-check"></i><b>2.2</b> Include Paths</a><ul>
<li class="chapter" data-level="2.2.1" data-path="include-paths.html"><a href="include-paths.html#slashes-in-include-paths"><i class="fa fa-check"></i><b>2.2.1</b> Slashes in include paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="comments.html"><a href="comments.html"><i class="fa fa-check"></i><b>3</b> Comments</a><ul>
<li class="chapter" data-level="3.1" data-path="line-based-comments.html"><a href="line-based-comments.html"><i class="fa fa-check"></i><b>3.1</b> Line-Based Comments</a></li>
<li class="chapter" data-level="3.2" data-path="bracketed-comments.html"><a href="bracketed-comments.html"><i class="fa fa-check"></i><b>3.2</b> Bracketed Comments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="whitespace.html"><a href="whitespace.html"><i class="fa fa-check"></i><b>4</b> Whitespace</a><ul>
<li class="chapter" data-level="4.1" data-path="whitespace-characters.html"><a href="whitespace-characters.html"><i class="fa fa-check"></i><b>4.1</b> Whitespace Characters</a></li>
<li class="chapter" data-level="4.2" data-path="whitespace-neutrality.html"><a href="whitespace-neutrality.html"><i class="fa fa-check"></i><b>4.2</b> Whitespace Neutrality</a></li>
<li class="chapter" data-level="4.3" data-path="whitespace-location.html"><a href="whitespace-location.html"><i class="fa fa-check"></i><b>4.3</b> Whitespace Location</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-types-chapter.html"><a href="data-types-chapter.html"><i class="fa fa-check"></i><b>5</b> Data Types and Declarations</a><ul>
<li class="chapter" data-level="5.1" data-path="overview-of-data-types.html"><a href="overview-of-data-types.html"><i class="fa fa-check"></i><b>5.1</b> Overview of Data Types</a><ul>
<li class="chapter" data-level="" data-path="overview-of-data-types.html"><a href="overview-of-data-types.html#primitive-types"><i class="fa fa-check"></i>Primitive Types</a></li>
<li class="chapter" data-level="" data-path="overview-of-data-types.html"><a href="overview-of-data-types.html#vector-and-matrix-types"><i class="fa fa-check"></i>Vector and Matrix Types</a></li>
<li class="chapter" data-level="" data-path="overview-of-data-types.html"><a href="overview-of-data-types.html#array-types"><i class="fa fa-check"></i>Array Types</a></li>
<li class="chapter" data-level="" data-path="overview-of-data-types.html"><a href="overview-of-data-types.html#constrained-data-types"><i class="fa fa-check"></i>Constrained Data Types</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="numerical-data-types.html"><a href="numerical-data-types.html"><i class="fa fa-check"></i><b>5.2</b> Primitive Numerical Data Types</a><ul>
<li class="chapter" data-level="" data-path="numerical-data-types.html"><a href="numerical-data-types.html#integers"><i class="fa fa-check"></i>Integers</a></li>
<li class="chapter" data-level="" data-path="numerical-data-types.html"><a href="numerical-data-types.html#reals"><i class="fa fa-check"></i>Reals</a></li>
<li class="chapter" data-level="" data-path="numerical-data-types.html"><a href="numerical-data-types.html#promoting-integers-to-reals"><i class="fa fa-check"></i>Promoting Integers to Reals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html"><i class="fa fa-check"></i><b>5.3</b> Univariate Data Types and Variable Declarations</a><ul>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#unconstrained-integer"><i class="fa fa-check"></i>Unconstrained Integer</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#constrained-integer"><i class="fa fa-check"></i>Constrained Integer</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#unconstrained-real"><i class="fa fa-check"></i>Unconstrained Real</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#constrained-real"><i class="fa fa-check"></i>Constrained Real</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#affinely-transformed-real"><i class="fa fa-check"></i>Affinely Transformed Real</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#expressions-as-bounds-and-offsetmultiplier"><i class="fa fa-check"></i>Expressions as Bounds and Offset/Multiplier</a></li>
<li class="chapter" data-level="" data-path="univariate-data-types-and-variable-declarations.html"><a href="univariate-data-types-and-variable-declarations.html#declaring-optional-variables"><i class="fa fa-check"></i>Declaring Optional Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html"><i class="fa fa-check"></i><b>5.4</b> Vector and Matrix Data Types</a><ul>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#indexing-from-1"><i class="fa fa-check"></i>Indexing from 1</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#unit-simplexes"><i class="fa fa-check"></i>Unit Simplexes</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#unit-vectors"><i class="fa fa-check"></i>Unit Vectors</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#ordered-vectors"><i class="fa fa-check"></i>Ordered Vectors</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#positive-ordered-vectors"><i class="fa fa-check"></i>Positive, Ordered Vectors</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#row-vectors"><i class="fa fa-check"></i>Row Vectors</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#covariance-matrices"><i class="fa fa-check"></i>Covariance Matrices</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#correlation-matrices"><i class="fa fa-check"></i>Correlation Matrices</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#cholesky-factors-of-covariance-matrices"><i class="fa fa-check"></i>Cholesky Factors of Covariance Matrices</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#cholesky-factors-of-correlation-matrices"><i class="fa fa-check"></i>Cholesky Factors of Correlation Matrices</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#assigning-constrained-variables"><i class="fa fa-check"></i>Assigning Constrained Variables</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#expressions-as-size-declarations"><i class="fa fa-check"></i>Expressions as Size Declarations</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#accessing-vector-and-matrix-elements"><i class="fa fa-check"></i>Accessing Vector and Matrix Elements</a></li>
<li class="chapter" data-level="" data-path="vector-and-matrix-data-types.html"><a href="vector-and-matrix-data-types.html#size-declaration-restrictions"><i class="fa fa-check"></i>Size Declaration Restrictions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="array-data-types-section.html"><a href="array-data-types-section.html"><i class="fa fa-check"></i><b>5.5</b> Array Data Types</a><ul>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#declaring-array-variables"><i class="fa fa-check"></i>Declaring Array Variables</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#accessing-array-elements-and-subarrays"><i class="fa fa-check"></i>Accessing Array Elements and Subarrays</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#assigning"><i class="fa fa-check"></i>Assigning</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#arrays-of-matrices-and-vectors"><i class="fa fa-check"></i>Arrays of Matrices and Vectors</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#partial-array-assignment"><i class="fa fa-check"></i>Partial Array Assignment</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#mixing-array-vector-and-matrix-types"><i class="fa fa-check"></i>Mixing Array, Vector, and Matrix Types</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#size-declaration-restrictions-1"><i class="fa fa-check"></i>Size Declaration Restrictions</a></li>
<li class="chapter" data-level="" data-path="array-data-types-section.html"><a href="array-data-types-section.html#size-zero-arrays"><i class="fa fa-check"></i>Size Zero Arrays</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variable-types-vs-constraints-and-sizes.html"><a href="variable-types-vs-constraints-and-sizes.html"><i class="fa fa-check"></i><b>5.6</b> Variable Types vs.Constraints and Sizes</a><ul>
<li class="chapter" data-level="" data-path="variable-types-vs-constraints-and-sizes.html"><a href="variable-types-vs-constraints-and-sizes.html#type-information-excludes-sizes"><i class="fa fa-check"></i>Type Information Excludes Sizes</a></li>
<li class="chapter" data-level="" data-path="variable-types-vs-constraints-and-sizes.html"><a href="variable-types-vs-constraints-and-sizes.html#type-information-excludes-constraints"><i class="fa fa-check"></i>Type Information Excludes Constraints</a></li>
<li class="chapter" data-level="" data-path="variable-types-vs-constraints-and-sizes.html"><a href="variable-types-vs-constraints-and-sizes.html#type-naming-notation"><i class="fa fa-check"></i>Type Naming Notation</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="compound-variable-declaration-and-definition.html"><a href="compound-variable-declaration-and-definition.html"><i class="fa fa-check"></i><b>5.7</b> Compound Variable Declaration and Definition</a><ul>
<li class="chapter" data-level="" data-path="compound-variable-declaration-and-definition.html"><a href="compound-variable-declaration-and-definition.html#assignment-typing"><i class="fa fa-check"></i>Assignment Typing</a></li>
<li class="chapter" data-level="" data-path="compound-variable-declaration-and-definition.html"><a href="compound-variable-declaration-and-definition.html#right-hand-side-expressions"><i class="fa fa-check"></i>Right-Hand Side Expressions</a></li>
<li class="chapter" data-level="" data-path="compound-variable-declaration-and-definition.html"><a href="compound-variable-declaration-and-definition.html#scope-within-expressions"><i class="fa fa-check"></i>Scope within Expressions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>6</b> Expressions</a><ul>
<li class="chapter" data-level="6.1" data-path="numeric-literals.html"><a href="numeric-literals.html"><i class="fa fa-check"></i><b>6.1</b> Numeric Literals</a><ul>
<li class="chapter" data-level="" data-path="numeric-literals.html"><a href="numeric-literals.html#integer-literals"><i class="fa fa-check"></i>Integer Literals</a></li>
<li class="chapter" data-level="" data-path="numeric-literals.html"><a href="numeric-literals.html#real-literals"><i class="fa fa-check"></i>Real Literals</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="variables-section.html"><a href="variables-section.html"><i class="fa fa-check"></i><b>6.2</b> Variables</a><ul>
<li class="chapter" data-level="" data-path="variables-section.html"><a href="variables-section.html#reserved-names"><i class="fa fa-check"></i>Reserved Names</a></li>
<li class="chapter" data-level="" data-path="variables-section.html"><a href="variables-section.html#legal-characters"><i class="fa fa-check"></i>Legal Characters</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html"><i class="fa fa-check"></i><b>6.3</b> Vector, Matrix, and Array Expressions</a><ul>
<li class="chapter" data-level="" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html#vector-expressions"><i class="fa fa-check"></i>Vector Expressions</a></li>
<li class="chapter" data-level="" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html#matrix-expressions"><i class="fa fa-check"></i>Matrix Expressions</a></li>
<li class="chapter" data-level="" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html#array-expressions"><i class="fa fa-check"></i>Array Expressions</a></li>
<li class="chapter" data-level="" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html#array-expression-types"><i class="fa fa-check"></i>Array Expression Types</a></li>
<li class="chapter" data-level="" data-path="vector-matrix-array-expressions-section.html"><a href="vector-matrix-array-expressions-section.html#restrictions-on-values"><i class="fa fa-check"></i>Restrictions on Values</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="parentheses-for-grouping.html"><a href="parentheses-for-grouping.html"><i class="fa fa-check"></i><b>6.4</b> Parentheses for Grouping</a></li>
<li class="chapter" data-level="6.5" data-path="arithmetic-expressions-section.html"><a href="arithmetic-expressions-section.html"><i class="fa fa-check"></i><b>6.5</b> Arithmetic and Matrix Operations on Expressions</a><ul>
<li class="chapter" data-level="" data-path="arithmetic-expressions-section.html"><a href="arithmetic-expressions-section.html#operator-precedence-and-associativity"><i class="fa fa-check"></i>Operator Precedence and Associativity</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="conditional-operator-section.html"><a href="conditional-operator-section.html"><i class="fa fa-check"></i><b>6.6</b> Conditional Operator</a><ul>
<li class="chapter" data-level="" data-path="conditional-operator-section.html"><a href="conditional-operator-section.html#conditional-operator-syntax"><i class="fa fa-check"></i>Conditional Operator Syntax</a></li>
<li class="chapter" data-level="" data-path="conditional-operator-section.html"><a href="conditional-operator-section.html#conditional-operator-semantics"><i class="fa fa-check"></i>Conditional Operator Semantics</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="language-indexing-section.html"><a href="language-indexing-section.html"><i class="fa fa-check"></i><b>6.7</b> Indexing</a><ul>
<li class="chapter" data-level="" data-path="language-indexing-section.html"><a href="language-indexing-section.html#accessing-subarrays"><i class="fa fa-check"></i>Accessing Subarrays</a></li>
<li class="chapter" data-level="" data-path="language-indexing-section.html"><a href="language-indexing-section.html#accessing-matrix-rows"><i class="fa fa-check"></i>Accessing Matrix Rows</a></li>
<li class="chapter" data-level="" data-path="language-indexing-section.html"><a href="language-indexing-section.html#mixing-array-and-vectormatrix-indexes"><i class="fa fa-check"></i>Mixing Array and Vector/Matrix Indexes</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="language-multi-indexing-section.html"><a href="language-multi-indexing-section.html"><i class="fa fa-check"></i><b>6.8</b> Multiple Indexing and Range Indexing</a><ul>
<li class="chapter" data-level="" data-path="language-multi-indexing-section.html"><a href="language-multi-indexing-section.html#multiple-index-semantics"><i class="fa fa-check"></i>Multiple Index Semantics</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="function-application-section.html"><a href="function-application-section.html"><i class="fa fa-check"></i><b>6.9</b> Function Application</a><ul>
<li class="chapter" data-level="" data-path="function-application-section.html"><a href="function-application-section.html#type-signatures-and-result-type-inference"><i class="fa fa-check"></i>Type Signatures and Result Type Inference</a></li>
<li class="chapter" data-level="" data-path="function-application-section.html"><a href="function-application-section.html#constants"><i class="fa fa-check"></i>Constants</a></li>
<li class="chapter" data-level="" data-path="function-application-section.html"><a href="function-application-section.html#type-promotion-and-function-resolution"><i class="fa fa-check"></i>Type Promotion and Function Resolution</a></li>
<li class="chapter" data-level="" data-path="function-application-section.html"><a href="function-application-section.html#random-number-generating-functions"><i class="fa fa-check"></i>Random-Number Generating Functions</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="type-inference.html"><a href="type-inference.html"><i class="fa fa-check"></i><b>6.10</b> Type Inference</a><ul>
<li class="chapter" data-level="" data-path="type-inference.html"><a href="type-inference.html#implementation-types"><i class="fa fa-check"></i>Implementation Types</a></li>
<li class="chapter" data-level="" data-path="type-inference.html"><a href="type-inference.html#type-inference-rules"><i class="fa fa-check"></i>Type Inference Rules</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="higher-order-functions.html"><a href="higher-order-functions.html"><i class="fa fa-check"></i><b>6.11</b> Higher-Order Functions</a><ul>
<li class="chapter" data-level="" data-path="higher-order-functions.html"><a href="higher-order-functions.html#functions-passed-by-reference"><i class="fa fa-check"></i>Functions Passed by Reference</a></li>
<li class="chapter" data-level="" data-path="higher-order-functions.html"><a href="higher-order-functions.html#data-restricted-arguments"><i class="fa fa-check"></i>Data-Restricted Arguments</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="chain-rule-and-derivatives.html"><a href="chain-rule-and-derivatives.html"><i class="fa fa-check"></i><b>6.12</b> Chain Rule and Derivatives</a><ul>
<li class="chapter" data-level="" data-path="chain-rule-and-derivatives.html"><a href="chain-rule-and-derivatives.html#errors-due-to-chain-rule"><i class="fa fa-check"></i>Errors Due to Chain Rule</a></li>
<li class="chapter" data-level="" data-path="chain-rule-and-derivatives.html"><a href="chain-rule-and-derivatives.html#diagnosing-problems-with-derivatives"><i class="fa fa-check"></i>Diagnosing Problems with Derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statements.html"><a href="statements.html"><i class="fa fa-check"></i><b>7</b> Statements</a><ul>
<li class="chapter" data-level="7.1" data-path="statement-block-contexts.html"><a href="statement-block-contexts.html"><i class="fa fa-check"></i><b>7.1</b> Statement Block Contexts</a></li>
<li class="chapter" data-level="7.2" data-path="assignment-statement-section.html"><a href="assignment-statement-section.html"><i class="fa fa-check"></i><b>7.2</b> Assignment Statement</a><ul>
<li class="chapter" data-level="" data-path="assignment-statement-section.html"><a href="assignment-statement-section.html#lvalue-summary"><i class="fa fa-check"></i>Lvalue Summary</a></li>
<li class="chapter" data-level="" data-path="assignment-statement-section.html"><a href="assignment-statement-section.html#multiple-indexes"><i class="fa fa-check"></i>Multiple Indexes</a></li>
<li class="chapter" data-level="" data-path="assignment-statement-section.html"><a href="assignment-statement-section.html#compound-arithmetic-and-assignment-statement"><i class="fa fa-check"></i>Compound Arithmetic and Assignment Statement</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="increment-log-prob-section.html"><a href="increment-log-prob-section.html"><i class="fa fa-check"></i><b>7.3</b> Increment Log Density</a><ul>
<li class="chapter" data-level="" data-path="increment-log-prob-section.html"><a href="increment-log-prob-section.html#accessing-the-log-density"><i class="fa fa-check"></i>Accessing the Log Density</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sampling-statements-section.html"><a href="sampling-statements-section.html"><i class="fa fa-check"></i><b>7.4</b> Sampling Statements</a><ul>
<li class="chapter" data-level="" data-path="sampling-statements-section.html"><a href="sampling-statements-section.html#log-probability-increment-vs.sampling-statement"><i class="fa fa-check"></i>Log Probability Increment vs.Sampling Statement</a></li>
<li class="chapter" data-level="" data-path="sampling-statements-section.html"><a href="sampling-statements-section.html#user-transformed-variables"><i class="fa fa-check"></i>User-Transformed Variables</a></li>
<li class="chapter" data-level="" data-path="sampling-statements-section.html"><a href="sampling-statements-section.html#truncated-distributions"><i class="fa fa-check"></i>Truncated Distributions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>7.5</b> For Loops</a><ul>
<li class="chapter" data-level="" data-path="for-loops.html"><a href="for-loops.html#loop-variable-typing-and-scope"><i class="fa fa-check"></i>Loop Variable Typing and Scope</a></li>
<li class="chapter" data-level="" data-path="for-loops.html"><a href="for-loops.html#order-sensitivity-and-repeated-variables"><i class="fa fa-check"></i>Order Sensitivity and Repeated Variables</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="foreach-loops.html"><a href="foreach-loops.html"><i class="fa fa-check"></i><b>7.6</b> Foreach Loops</a></li>
<li class="chapter" data-level="7.7" data-path="conditional-statements.html"><a href="conditional-statements.html"><i class="fa fa-check"></i><b>7.7</b> Conditional Statements</a></li>
<li class="chapter" data-level="7.8" data-path="while-statements.html"><a href="while-statements.html"><i class="fa fa-check"></i><b>7.8</b> While Statements</a></li>
<li class="chapter" data-level="7.9" data-path="statement-blocks-and-local-variable-declarations.html"><a href="statement-blocks-and-local-variable-declarations.html"><i class="fa fa-check"></i><b>7.9</b> Statement Blocks and Local Variable Declarations</a><ul>
<li class="chapter" data-level="" data-path="statement-blocks-and-local-variable-declarations.html"><a href="statement-blocks-and-local-variable-declarations.html#blocks-in-for-loops"><i class="fa fa-check"></i>Blocks in For Loops</a></li>
<li class="chapter" data-level="" data-path="statement-blocks-and-local-variable-declarations.html"><a href="statement-blocks-and-local-variable-declarations.html#local-variable-declarations"><i class="fa fa-check"></i>Local Variable Declarations</a></li>
<li class="chapter" data-level="" data-path="statement-blocks-and-local-variable-declarations.html"><a href="statement-blocks-and-local-variable-declarations.html#no-constraints-on-local-variables"><i class="fa fa-check"></i>No Constraints on Local Variables</a></li>
<li class="chapter" data-level="" data-path="statement-blocks-and-local-variable-declarations.html"><a href="statement-blocks-and-local-variable-declarations.html#blocks-within-blocks"><i class="fa fa-check"></i>Blocks within Blocks</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="break-and-continue-statements.html"><a href="break-and-continue-statements.html"><i class="fa fa-check"></i><b>7.10</b> Break and Continue Statements <a id="break-continue-statements"></a></a><ul>
<li class="chapter" data-level="" data-path="break-and-continue-statements.html"><a href="break-and-continue-statements.html#break-statements"><i class="fa fa-check"></i>Break Statements</a></li>
<li class="chapter" data-level="" data-path="break-and-continue-statements.html"><a href="break-and-continue-statements.html#continue-statements"><i class="fa fa-check"></i>Continue Statements</a></li>
<li class="chapter" data-level="" data-path="break-and-continue-statements.html"><a href="break-and-continue-statements.html#breaking-and-continuing-nested-loops"><i class="fa fa-check"></i>Breaking and Continuing Nested Loops</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="print-statements-section.html"><a href="print-statements-section.html"><i class="fa fa-check"></i><b>7.11</b> Print Statements</a><ul>
<li class="chapter" data-level="" data-path="print-statements-section.html"><a href="print-statements-section.html#print-content"><i class="fa fa-check"></i>Print Content</a></li>
<li class="chapter" data-level="" data-path="print-statements-section.html"><a href="print-statements-section.html#non-void-input"><i class="fa fa-check"></i>Non-void Input</a></li>
<li class="chapter" data-level="" data-path="print-statements-section.html"><a href="print-statements-section.html#print-frequency"><i class="fa fa-check"></i>Print Frequency</a></li>
<li class="chapter" data-level="" data-path="print-statements-section.html"><a href="print-statements-section.html#string-literals"><i class="fa fa-check"></i>String Literals</a></li>
<li><a href="print-statements-section.html#debug-by-print">Debug by <code>print</code></a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="reject-statements-section.html"><a href="reject-statements-section.html"><i class="fa fa-check"></i><b>7.12</b> Reject Statements</a><ul>
<li class="chapter" data-level="" data-path="reject-statements-section.html"><a href="reject-statements-section.html#behavior-of-reject-statements"><i class="fa fa-check"></i>Behavior of Reject Statements</a></li>
<li class="chapter" data-level="" data-path="reject-statements-section.html"><a href="reject-statements-section.html#rejection-is-not-for-constraints"><i class="fa fa-check"></i>Rejection is not for Constraints</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="blocks-chapter.html"><a href="blocks-chapter.html"><i class="fa fa-check"></i><b>8</b> Program Blocks</a><ul>
<li class="chapter" data-level="8.1" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html"><i class="fa fa-check"></i><b>8.1</b> Overview of Stan’s Program Blocks</a><ul>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#optionality-and-ordering"><i class="fa fa-check"></i>Optionality and Ordering</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#variable-scope"><i class="fa fa-check"></i>Variable Scope</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#function-scope"><i class="fa fa-check"></i>Function Scope</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#automatic-variable-definitions"><i class="fa fa-check"></i>Automatic Variable Definitions</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#transformed-variables"><i class="fa fa-check"></i>Transformed Variables</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#generated-quantities"><i class="fa fa-check"></i>Generated Quantities</a></li>
<li class="chapter" data-level="" data-path="overview-of-stans-program-blocks.html"><a href="overview-of-stans-program-blocks.html#variable-read-write-and-definition-summary"><i class="fa fa-check"></i>Variable Read, Write, and Definition Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="statistical-variable-taxonomy.html"><a href="statistical-variable-taxonomy.html"><i class="fa fa-check"></i><b>8.2</b> Statistical Variable Taxonomy</a></li>
<li class="chapter" data-level="8.3" data-path="program-block-data.html"><a href="program-block-data.html"><i class="fa fa-check"></i><b>8.3</b> Program Block: <code>data</code></a><ul>
<li class="chapter" data-level="" data-path="program-block-data.html"><a href="program-block-data.html#variable-reads-and-transformations"><i class="fa fa-check"></i>Variable Reads and Transformations</a></li>
<li class="chapter" data-level="" data-path="program-block-data.html"><a href="program-block-data.html#statements-1"><i class="fa fa-check"></i>Statements</a></li>
<li class="chapter" data-level="" data-path="program-block-data.html"><a href="program-block-data.html#variable-constraint-checking"><i class="fa fa-check"></i>Variable Constraint Checking</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="program-block-transformed-data.html"><a href="program-block-transformed-data.html"><i class="fa fa-check"></i><b>8.4</b> Program Block: <code>transformed data</code></a><ul>
<li class="chapter" data-level="" data-path="program-block-transformed-data.html"><a href="program-block-transformed-data.html#variable-reads-and-transformations-1"><i class="fa fa-check"></i>Variable Reads and Transformations</a></li>
<li class="chapter" data-level="" data-path="program-block-transformed-data.html"><a href="program-block-transformed-data.html#statements-2"><i class="fa fa-check"></i>Statements</a></li>
<li class="chapter" data-level="" data-path="program-block-transformed-data.html"><a href="program-block-transformed-data.html#variable-constraint-checking-1"><i class="fa fa-check"></i>Variable Constraint Checking</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="program-block-parameters.html"><a href="program-block-parameters.html"><i class="fa fa-check"></i><b>8.5</b> Program Block: <code>parameters</code></a><ul>
<li class="chapter" data-level="" data-path="program-block-parameters.html"><a href="program-block-parameters.html#constraining-inverse-transform"><i class="fa fa-check"></i>Constraining Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="program-block-parameters.html"><a href="program-block-parameters.html#gradient-calculation"><i class="fa fa-check"></i>Gradient Calculation</a></li>
<li class="chapter" data-level="" data-path="program-block-parameters.html"><a href="program-block-parameters.html#writing-draws"><i class="fa fa-check"></i>Writing Draws</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="program-block-transformed-parameters.html"><a href="program-block-transformed-parameters.html"><i class="fa fa-check"></i><b>8.6</b> Program Block: <code>transformed parameters</code></a><ul>
<li class="chapter" data-level="" data-path="program-block-transformed-parameters.html"><a href="program-block-transformed-parameters.html#constraints-are-for-error-checking"><i class="fa fa-check"></i>Constraints are for Error Checking</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="program-block-model.html"><a href="program-block-model.html"><i class="fa fa-check"></i><b>8.7</b> Program Block: <code>model</code></a></li>
<li class="chapter" data-level="8.8" data-path="program-block-generated-quantities.html"><a href="program-block-generated-quantities.html"><i class="fa fa-check"></i><b>8.8</b> Program Block: <code>generated quantities</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions-chapter.html"><a href="functions-chapter.html"><i class="fa fa-check"></i><b>9</b> User-Defined Functions</a><ul>
<li class="chapter" data-level="9.1" data-path="function-definition-block.html"><a href="function-definition-block.html"><i class="fa fa-check"></i><b>9.1</b> Function-Definition Block</a></li>
<li class="chapter" data-level="9.2" data-path="function-names.html"><a href="function-names.html"><i class="fa fa-check"></i><b>9.2</b> Function Names</a></li>
<li class="chapter" data-level="9.3" data-path="calling-functions.html"><a href="calling-functions.html"><i class="fa fa-check"></i><b>9.3</b> Calling Functions</a><ul>
<li class="chapter" data-level="" data-path="calling-functions.html"><a href="calling-functions.html#functions-as-expressions"><i class="fa fa-check"></i>Functions as Expressions</a></li>
<li class="chapter" data-level="" data-path="calling-functions.html"><a href="calling-functions.html#functions-as-statements"><i class="fa fa-check"></i>Functions as Statements</a></li>
<li class="chapter" data-level="" data-path="calling-functions.html"><a href="calling-functions.html#probability-functions-in-sampling-statements"><i class="fa fa-check"></i>Probability Functions in Sampling Statements</a></li>
<li class="chapter" data-level="" data-path="calling-functions.html"><a href="calling-functions.html#restrictions-on-placement"><i class="fa fa-check"></i>Restrictions on Placement</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="argument-types-and-qualifiers.html"><a href="argument-types-and-qualifiers.html"><i class="fa fa-check"></i><b>9.4</b> Argument Types and Qualifiers</a><ul>
<li class="chapter" data-level="" data-path="argument-types-and-qualifiers.html"><a href="argument-types-and-qualifiers.html#base-variable-type-declaration"><i class="fa fa-check"></i>Base Variable Type Declaration</a></li>
<li class="chapter" data-level="" data-path="argument-types-and-qualifiers.html"><a href="argument-types-and-qualifiers.html#dimensionality-declaration"><i class="fa fa-check"></i>Dimensionality Declaration</a></li>
<li class="chapter" data-level="" data-path="argument-types-and-qualifiers.html"><a href="argument-types-and-qualifiers.html#dimensionality-checks-and-exceptions"><i class="fa fa-check"></i>Dimensionality Checks and Exceptions</a></li>
<li class="chapter" data-level="" data-path="argument-types-and-qualifiers.html"><a href="argument-types-and-qualifiers.html#data-only-qualifiers"><i class="fa fa-check"></i>Data-only Qualifiers</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="function-bodies-section.html"><a href="function-bodies-section.html"><i class="fa fa-check"></i><b>9.5</b> Function Bodies</a><ul>
<li class="chapter" data-level="" data-path="function-bodies-section.html"><a href="function-bodies-section.html#random-number-generating-functions-1"><i class="fa fa-check"></i>Random Number Generating Functions</a></li>
<li class="chapter" data-level="" data-path="function-bodies-section.html"><a href="function-bodies-section.html#log-probability-access-in-functions"><i class="fa fa-check"></i>Log Probability Access in Functions</a></li>
<li class="chapter" data-level="" data-path="function-bodies-section.html"><a href="function-bodies-section.html#defining-probability-functions-for-sampling-statements"><i class="fa fa-check"></i>Defining Probability Functions for Sampling Statements</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="parameters-are-constant.html"><a href="parameters-are-constant.html"><i class="fa fa-check"></i><b>9.6</b> Parameters are Constant</a></li>
<li class="chapter" data-level="9.7" data-path="return-value.html"><a href="return-value.html"><i class="fa fa-check"></i><b>9.7</b> Return Value</a><ul>
<li class="chapter" data-level="" data-path="return-value.html"><a href="return-value.html#return-guarantee-required"><i class="fa fa-check"></i>Return Guarantee Required</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="void-functions-as-statements.html"><a href="void-functions-as-statements.html"><i class="fa fa-check"></i><b>9.8</b> Void Functions as Statements</a><ul>
<li class="chapter" data-level="" data-path="void-functions-as-statements.html"><a href="void-functions-as-statements.html#void-functions"><i class="fa fa-check"></i>Void Functions</a></li>
<li class="chapter" data-level="" data-path="void-functions-as-statements.html"><a href="void-functions-as-statements.html#usage-as-statement"><i class="fa fa-check"></i>Usage as Statement</a></li>
<li class="chapter" data-level="" data-path="void-functions-as-statements.html"><a href="void-functions-as-statements.html#special-return-statements"><i class="fa fa-check"></i>Special Return Statements</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="forward-declarations-section.html"><a href="forward-declarations-section.html"><i class="fa fa-check"></i><b>9.9</b> Declarations</a><ul>
<li class="chapter" data-level="" data-path="forward-declarations-section.html"><a href="forward-declarations-section.html#recursive-functions"><i class="fa fa-check"></i>Recursive Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="variable-transforms-chapter.html"><a href="variable-transforms-chapter.html"><i class="fa fa-check"></i><b>10</b> Constraint Transforms</a><ul>
<li class="chapter" data-level="10.1" data-path="change-of-variables-section.html"><a href="change-of-variables-section.html"><i class="fa fa-check"></i><b>10.1</b> Changes of Variables</a><ul>
<li class="chapter" data-level="" data-path="change-of-variables-section.html"><a href="change-of-variables-section.html#univariate-changes-of-variables"><i class="fa fa-check"></i>Univariate Changes of Variables</a></li>
<li class="chapter" data-level="" data-path="change-of-variables-section.html"><a href="change-of-variables-section.html#multivariate-changes-of-variables"><i class="fa fa-check"></i>Multivariate Changes of Variables</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="lower-bound-transform-section.html"><a href="lower-bound-transform-section.html"><i class="fa fa-check"></i><b>10.2</b> Lower Bounded Scalar</a><ul>
<li class="chapter" data-level="" data-path="lower-bound-transform-section.html"><a href="lower-bound-transform-section.html#lower-bound-transform"><i class="fa fa-check"></i>Lower Bound Transform</a></li>
<li class="chapter" data-level="" data-path="lower-bound-transform-section.html"><a href="lower-bound-transform-section.html#lower-bound-inverse-transform"><i class="fa fa-check"></i>Lower Bound Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="lower-bound-transform-section.html"><a href="lower-bound-transform-section.html#absolute-derivative-of-the-lower-bound-inverse-transform"><i class="fa fa-check"></i>Absolute Derivative of the Lower Bound Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="upper-bounded-scalar.html"><a href="upper-bounded-scalar.html"><i class="fa fa-check"></i><b>10.3</b> Upper Bounded Scalar</a><ul>
<li class="chapter" data-level="" data-path="upper-bounded-scalar.html"><a href="upper-bounded-scalar.html#upper-bound-transform"><i class="fa fa-check"></i>Upper Bound Transform</a></li>
<li class="chapter" data-level="" data-path="upper-bounded-scalar.html"><a href="upper-bounded-scalar.html#upper-bound-inverse-transform"><i class="fa fa-check"></i>Upper Bound Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="upper-bounded-scalar.html"><a href="upper-bounded-scalar.html#absolute-derivative-of-the-upper-bound-inverse-transform"><i class="fa fa-check"></i>Absolute Derivative of the Upper Bound Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="logit-transform-jacobian-section.html"><a href="logit-transform-jacobian-section.html"><i class="fa fa-check"></i><b>10.4</b> Lower and Upper Bounded Scalar</a><ul>
<li class="chapter" data-level="" data-path="logit-transform-jacobian-section.html"><a href="logit-transform-jacobian-section.html#log-odds-and-the-logistic-sigmoid"><i class="fa fa-check"></i>Log Odds and the Logistic Sigmoid</a></li>
<li class="chapter" data-level="" data-path="logit-transform-jacobian-section.html"><a href="logit-transform-jacobian-section.html#lower-and-upper-bounds-transform"><i class="fa fa-check"></i>Lower and Upper Bounds Transform</a></li>
<li class="chapter" data-level="" data-path="logit-transform-jacobian-section.html"><a href="logit-transform-jacobian-section.html#lower-and-upper-bounds-inverse-transform"><i class="fa fa-check"></i>Lower and Upper Bounds Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="logit-transform-jacobian-section.html"><a href="logit-transform-jacobian-section.html#absolute-derivative-of-the-lower-and-upper-bounds-inverse-transform"><i class="fa fa-check"></i>Absolute Derivative of the Lower and Upper Bounds Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="affinely-transformed-scalar.html"><a href="affinely-transformed-scalar.html"><i class="fa fa-check"></i><b>10.5</b> Affinely Transformed Scalar</a><ul>
<li class="chapter" data-level="" data-path="affinely-transformed-scalar.html"><a href="affinely-transformed-scalar.html#affine-transform"><i class="fa fa-check"></i>Affine Transform</a></li>
<li class="chapter" data-level="" data-path="affinely-transformed-scalar.html"><a href="affinely-transformed-scalar.html#affine-inverse-transform"><i class="fa fa-check"></i>Affine Inverse Transform</a></li>
<li class="chapter" data-level="10.5.1" data-path="affinely-transformed-scalar.html"><a href="affinely-transformed-scalar.html#absolute-derivative-of-the-affine-inverse-transform"><i class="fa fa-check"></i><b>10.5.1</b> Absolute Derivative of the Affine Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ordered-vector.html"><a href="ordered-vector.html"><i class="fa fa-check"></i><b>10.6</b> Ordered Vector</a><ul>
<li class="chapter" data-level="" data-path="ordered-vector.html"><a href="ordered-vector.html#ordered-transform"><i class="fa fa-check"></i>Ordered Transform</a></li>
<li class="chapter" data-level="" data-path="ordered-vector.html"><a href="ordered-vector.html#ordered-inverse-transform"><i class="fa fa-check"></i>Ordered Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="ordered-vector.html"><a href="ordered-vector.html#absolute-jacobian-determinant-of-the-ordered-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of the Ordered Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="simplex-transform-section.html"><a href="simplex-transform-section.html"><i class="fa fa-check"></i><b>10.7</b> Unit Simplex</a><ul>
<li class="chapter" data-level="" data-path="simplex-transform-section.html"><a href="simplex-transform-section.html#unit-simplex-inverse-transform"><i class="fa fa-check"></i>Unit Simplex Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="simplex-transform-section.html"><a href="simplex-transform-section.html#absolute-jacobian-determinant-of-the-unit-simplex-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of the Unit-Simplex Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="simplex-transform-section.html"><a href="simplex-transform-section.html#unit-simplex-transform"><i class="fa fa-check"></i>Unit Simplex Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="unit-vector-section.html"><a href="unit-vector-section.html"><i class="fa fa-check"></i><b>10.8</b> Unit Vector</a><ul>
<li class="chapter" data-level="" data-path="unit-vector-section.html"><a href="unit-vector-section.html#unit-vector-inverse-transform"><i class="fa fa-check"></i>Unit Vector Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="unit-vector-section.html"><a href="unit-vector-section.html#absolute-jacobian-determinant-of-the-unit-vector-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of the Unit Vector Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="correlation-matrix-transform-section.html"><a href="correlation-matrix-transform-section.html"><i class="fa fa-check"></i><b>10.9</b> Correlation Matrices</a><ul>
<li class="chapter" data-level="" data-path="correlation-matrix-transform-section.html"><a href="correlation-matrix-transform-section.html#correlation-matrix-inverse-transform"><i class="fa fa-check"></i>Correlation Matrix Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="correlation-matrix-transform-section.html"><a href="correlation-matrix-transform-section.html#absolute-jacobian-determinant-of-the-correlation-matrix-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of the Correlation Matrix Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="correlation-matrix-transform-section.html"><a href="correlation-matrix-transform-section.html#correlation-matrix-transform"><i class="fa fa-check"></i>Correlation Matrix Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="covariance-matrices-1.html"><a href="covariance-matrices-1.html"><i class="fa fa-check"></i><b>10.10</b> Covariance Matrices</a><ul>
<li class="chapter" data-level="" data-path="covariance-matrices-1.html"><a href="covariance-matrices-1.html#covariance-matrix-transform"><i class="fa fa-check"></i>Covariance Matrix Transform</a></li>
<li class="chapter" data-level="" data-path="covariance-matrices-1.html"><a href="covariance-matrices-1.html#covariance-matrix-inverse-transform"><i class="fa fa-check"></i>Covariance Matrix Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="covariance-matrices-1.html"><a href="covariance-matrices-1.html#absolute-jacobian-determinant-of-the-covariance-matrix-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of the Covariance Matrix Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="cholesky-factors-of-covariance-matrices-1.html"><a href="cholesky-factors-of-covariance-matrices-1.html"><i class="fa fa-check"></i><b>10.11</b> Cholesky Factors of Covariance Matrices</a><ul>
<li class="chapter" data-level="" data-path="cholesky-factors-of-covariance-matrices-1.html"><a href="cholesky-factors-of-covariance-matrices-1.html#cholesky-factor-of-covariance-matrix-transform"><i class="fa fa-check"></i>Cholesky Factor of Covariance Matrix Transform</a></li>
<li class="chapter" data-level="" data-path="cholesky-factors-of-covariance-matrices-1.html"><a href="cholesky-factors-of-covariance-matrices-1.html#cholesky-factor-of-covariance-matrix-inverse-transform"><i class="fa fa-check"></i>Cholesky Factor of Covariance Matrix Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="cholesky-factors-of-covariance-matrices-1.html"><a href="cholesky-factors-of-covariance-matrices-1.html#absolute-jacobian-determinant-of-cholesky-factor-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of Cholesky Factor Inverse Transform</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="cholesky-factors-of-correlation-matrices-1.html"><a href="cholesky-factors-of-correlation-matrices-1.html"><i class="fa fa-check"></i><b>10.12</b> Cholesky Factors of Correlation Matrices</a><ul>
<li class="chapter" data-level="" data-path="cholesky-factors-of-correlation-matrices-1.html"><a href="cholesky-factors-of-correlation-matrices-1.html#cholesky-factor-of-correlation-matrix-inverse-transform"><i class="fa fa-check"></i>Cholesky Factor of Correlation Matrix Inverse Transform</a></li>
<li class="chapter" data-level="" data-path="cholesky-factors-of-correlation-matrices-1.html"><a href="cholesky-factors-of-correlation-matrices-1.html#cholesky-factor-of-correlation-matrix-transform"><i class="fa fa-check"></i>Cholesky Factor of Correlation Matrix Transform</a></li>
<li class="chapter" data-level="" data-path="cholesky-factors-of-correlation-matrices-1.html"><a href="cholesky-factors-of-correlation-matrices-1.html#absolute-jacobian-determinant-of-inverse-transform"><i class="fa fa-check"></i>Absolute Jacobian Determinant of Inverse Transform</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="language-syntax.html"><a href="language-syntax.html"><i class="fa fa-check"></i><b>11</b> Language Syntax</a><ul>
<li class="chapter" data-level="11.1" data-path="bnf-grammars.html"><a href="bnf-grammars.html"><i class="fa fa-check"></i><b>11.1</b> BNF Grammars</a><ul>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#syntactic-conventions"><i class="fa fa-check"></i>Syntactic conventions</a></li>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#programs"><i class="fa fa-check"></i>Programs</a></li>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#function-declarations-and-definitions"><i class="fa fa-check"></i>Function declarations and definitions</a></li>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#variable-declarations-and-compound-definitions"><i class="fa fa-check"></i>Variable declarations and compound definitions</a></li>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#expressions-1"><i class="fa fa-check"></i>Expressions</a></li>
<li class="chapter" data-level="" data-path="bnf-grammars.html"><a href="bnf-grammars.html#statements-3"><i class="fa fa-check"></i>Statements</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html"><i class="fa fa-check"></i><b>11.2</b> Extra-Grammatical Constraints</a><ul>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#type-constraints"><i class="fa fa-check"></i>Type constraints</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#operator-precedence-and-associativity-1"><i class="fa fa-check"></i>Operator precedence and associativity</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#typing-of-compound-declaration-and-definition"><i class="fa fa-check"></i>Typing of compound declaration and definition</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#typing-of-array-expressions"><i class="fa fa-check"></i>Typing of array expressions</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#forms-of-numbers"><i class="fa fa-check"></i>Forms of numbers</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#conditional-arguments"><i class="fa fa-check"></i>Conditional arguments</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#for-loop-containers"><i class="fa fa-check"></i>For loop containers</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#print-arguments"><i class="fa fa-check"></i>Print arguments</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#only-break-and-continue-in-loops"><i class="fa fa-check"></i>Only break and continue in loops</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#prng-function-locations"><i class="fa fa-check"></i>PRNG function locations</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#probability-function-naming"><i class="fa fa-check"></i>Probability function naming</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#algebraic-solver-argument-types-and-origins"><i class="fa fa-check"></i>Algebraic solver argument types and origins</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#integrate-1d-argument-types-and-origins"><i class="fa fa-check"></i>Integrate 1D argument types and origins</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#ode-solver-argument-types-and-origins"><i class="fa fa-check"></i>ODE solver argument types and origins</a></li>
<li class="chapter" data-level="" data-path="extra-grammatical-constraints.html"><a href="extra-grammatical-constraints.html#indexes"><i class="fa fa-check"></i>Indexes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="program-execution.html"><a href="program-execution.html"><i class="fa fa-check"></i><b>12</b> Program Execution</a><ul>
<li class="chapter" data-level="12.1" data-path="reading-and-transforming-data.html"><a href="reading-and-transforming-data.html"><i class="fa fa-check"></i><b>12.1</b> Reading and Transforming Data</a><ul>
<li class="chapter" data-level="" data-path="reading-and-transforming-data.html"><a href="reading-and-transforming-data.html#read-data"><i class="fa fa-check"></i>Read Data</a></li>
<li class="chapter" data-level="" data-path="reading-and-transforming-data.html"><a href="reading-and-transforming-data.html#define-transformed-data"><i class="fa fa-check"></i>Define Transformed Data</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="initialization.html"><a href="initialization.html"><i class="fa fa-check"></i><b>12.2</b> Initialization</a><ul>
<li class="chapter" data-level="" data-path="initialization.html"><a href="initialization.html#user-supplied-initial-values"><i class="fa fa-check"></i>User-Supplied Initial Values</a></li>
<li class="chapter" data-level="" data-path="initialization.html"><a href="initialization.html#random-initial-values"><i class="fa fa-check"></i>Random Initial Values</a></li>
<li class="chapter" data-level="" data-path="initialization.html"><a href="initialization.html#zero-initial-values"><i class="fa fa-check"></i>Zero Initial Values</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>12.3</b> Sampling</a><ul>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#leapfrog-steps"><i class="fa fa-check"></i>Leapfrog Steps</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#log-probability-and-gradient-calculation"><i class="fa fa-check"></i>Log Probability and Gradient Calculation</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#metropolis-acceptreject"><i class="fa fa-check"></i>Metropolis Accept/Reject</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>12.4</b> Optimization</a></li>
<li class="chapter" data-level="12.5" data-path="variational-inference.html"><a href="variational-inference.html"><i class="fa fa-check"></i><b>12.5</b> Variational Inference</a></li>
<li class="chapter" data-level="12.6" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>12.6</b> Model Diagnostics</a></li>
<li class="chapter" data-level="12.7" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>12.7</b> Output</a><ul>
<li class="chapter" data-level="" data-path="output.html"><a href="output.html#generated-quantities-1"><i class="fa fa-check"></i>Generated Quantities</a></li>
<li class="chapter" data-level="" data-path="output.html"><a href="output.html#write"><i class="fa fa-check"></i>Write</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="deprecated-features-appendix.html"><a href="deprecated-features-appendix.html"><i class="fa fa-check"></i><b>13</b> Deprecated Features</a><ul>
<li class="chapter" data-level="13.1" data-path="assignment-with-.html"><a href="assignment-with-.html"><i class="fa fa-check"></i><b>13.1</b> Assignment with <code>&lt;-</code></a></li>
<li class="chapter" data-level="13.2" data-path="increment-log-prob-statement.html"><a href="increment-log-prob-statement.html"><i class="fa fa-check"></i><b>13.2</b> <code>increment_log_prob</code> Statement</a></li>
<li class="chapter" data-level="13.3" data-path="get-lp-function.html"><a href="get-lp-function.html"><i class="fa fa-check"></i><b>13.3</b> <code>get_lp()</code> Function</a></li>
<li class="chapter" data-level="13.4" data-path="log-density-and-mass-functions.html"><a href="log-density-and-mass-functions.html"><i class="fa fa-check"></i><b>13.4</b> <code>_log</code> Density and Mass Functions</a></li>
<li class="chapter" data-level="13.5" data-path="cdf-log-and-ccdf-log-cumulative-distribution-functions.html"><a href="cdf-log-and-ccdf-log-cumulative-distribution-functions.html"><i class="fa fa-check"></i><b>13.5</b> <code>cdf_log</code> and <code>ccdf_log</code> Cumulative Distribution Functions</a></li>
<li class="chapter" data-level="13.6" data-path="multiply-log-and-binomial-coefficient-log-functions.html"><a href="multiply-log-and-binomial-coefficient-log-functions.html"><i class="fa fa-check"></i><b>13.6</b> <code>multiply_log</code> and <code>binomial_coefficient_log</code> Functions</a></li>
<li class="chapter" data-level="13.7" data-path="user-defined-function-with-log-suffix.html"><a href="user-defined-function-with-log-suffix.html"><i class="fa fa-check"></i><b>13.7</b> User-Defined Function with <code>_log</code> Suffix</a></li>
<li class="chapter" data-level="13.8" data-path="lkj-cov-distribution.html"><a href="lkj-cov-distribution.html"><i class="fa fa-check"></i><b>13.8</b> <code>lkj_cov</code> Distribution</a></li>
<li class="chapter" data-level="13.9" data-path="if-else-function.html"><a href="if-else-function.html"><i class="fa fa-check"></i><b>13.9</b> <code>if_else</code> Function</a></li>
<li class="chapter" data-level="13.10" data-path="absreal-x-function.html"><a href="absreal-x-function.html"><i class="fa fa-check"></i><b>13.10</b> <code>abs(real x)</code> Function</a></li>
<li class="chapter" data-level="13.11" data-path="comments-1.html"><a href="comments-1.html"><i class="fa fa-check"></i><b>13.11</b> <code>#</code> Comments</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="removed-features.html"><a href="removed-features.html"><i class="fa fa-check"></i><b>14</b> Removed Features</a><ul>
<li class="chapter" data-level="14.1" data-path="lp-variable.html"><a href="lp-variable.html"><i class="fa fa-check"></i><b>14.1</b> <code>lp__</code> Variable</a></li>
</ul></li>
<li><a href="algorithms.html#algorithms"><i style="font-size: 110%; color:#990017;">Algorithms</i></a></li>
<li class="chapter" data-level="15" data-path="hmc-chapter.html"><a href="hmc-chapter.html"><i class="fa fa-check"></i><b>15</b> MCMC Sampling</a><ul>
<li class="chapter" data-level="15.1" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i><b>15.1</b> Hamiltonian Monte Carlo</a><ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#target-density"><i class="fa fa-check"></i>Target Density</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#auxiliary-momentum-variable"><i class="fa fa-check"></i>Auxiliary Momentum Variable</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#the-hamiltonian"><i class="fa fa-check"></i>The Hamiltonian</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#generating-transitions"><i class="fa fa-check"></i>Generating Transitions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#leapfrog-integrator"><i class="fa fa-check"></i>Leapfrog Integrator</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#metropolis-accept-step"><i class="fa fa-check"></i>Metropolis Accept Step</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#algorithm-summary"><i class="fa fa-check"></i>Algorithm Summary</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html"><i class="fa fa-check"></i><b>15.2</b> HMC Algorithm Parameters</a><ul>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#integration-time"><i class="fa fa-check"></i>Integration Time</a></li>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#automatic-parameter-tuning"><i class="fa fa-check"></i>Automatic Parameter Tuning</a></li>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#discretization-interval-adaptation-parameters"><i class="fa fa-check"></i>Discretization-Interval Adaptation Parameters</a></li>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#step-size-jitter"><i class="fa fa-check"></i>Step-Size Jitter</a></li>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#euclidean-metric"><i class="fa fa-check"></i>Euclidean Metric</a></li>
<li class="chapter" data-level="" data-path="hmc-algorithm-parameters.html"><a href="hmc-algorithm-parameters.html#nuts-and-its-configuration"><i class="fa fa-check"></i>NUTS and its Configuration</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="sampling-without-parameters.html"><a href="sampling-without-parameters.html"><i class="fa fa-check"></i><b>15.3</b> Sampling without Parameters</a></li>
<li class="chapter" data-level="15.4" data-path="general-config-section.html"><a href="general-config-section.html"><i class="fa fa-check"></i><b>15.4</b> General Configuration Options</a><ul>
<li class="chapter" data-level="" data-path="general-config-section.html"><a href="general-config-section.html#random-number-generator"><i class="fa fa-check"></i>Random Number Generator</a></li>
<li class="chapter" data-level="" data-path="general-config-section.html"><a href="general-config-section.html#initialization-1"><i class="fa fa-check"></i>Initialization</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="divergent-transitions.html"><a href="divergent-transitions.html"><i class="fa fa-check"></i><b>15.5</b> Divergent Transitions</a><ul>
<li class="chapter" data-level="" data-path="divergent-transitions.html"><a href="divergent-transitions.html#diagnosing-and-eliminating-divergences"><i class="fa fa-check"></i>Diagnosing and Eliminating Divergences</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="analysis-chapter.html"><a href="analysis-chapter.html"><i class="fa fa-check"></i><b>16</b> Posterior Analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>16.1</b> Markov Chains</a></li>
<li class="chapter" data-level="16.2" data-path="convergence.html"><a href="convergence.html"><i class="fa fa-check"></i><b>16.2</b> Convergence</a></li>
<li class="chapter" data-level="16.3" data-path="notation-for-samples-chains-and-draws.html"><a href="notation-for-samples-chains-and-draws.html"><i class="fa fa-check"></i><b>16.3</b> Notation for samples, chains, and draws</a><ul>
<li class="chapter" data-level="16.3.1" data-path="notation-for-samples-chains-and-draws.html"><a href="notation-for-samples-chains-and-draws.html#potential-scale-reduction"><i class="fa fa-check"></i><b>16.3.1</b> Potential Scale Reduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="notation-for-samples-chains-and-draws.html"><a href="notation-for-samples-chains-and-draws.html#split-r-hat-for-detecting-non-stationarity"><i class="fa fa-check"></i><b>16.3.2</b> Split R-hat for Detecting Non-Stationarity</a></li>
<li class="chapter" data-level="16.3.3" data-path="notation-for-samples-chains-and-draws.html"><a href="notation-for-samples-chains-and-draws.html#convergence-is-global"><i class="fa fa-check"></i><b>16.3.3</b> Convergence is Global</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="effective-sample-size-section.html"><a href="effective-sample-size-section.html"><i class="fa fa-check"></i><b>16.4</b> Effective Sample Size</a><ul>
<li class="chapter" data-level="16.4.1" data-path="effective-sample-size-section.html"><a href="effective-sample-size-section.html#definition-of-effective-sample-size"><i class="fa fa-check"></i><b>16.4.1</b> Definition of Effective Sample Size</a></li>
<li class="chapter" data-level="16.4.2" data-path="effective-sample-size-section.html"><a href="effective-sample-size-section.html#estimation-of-effective-sample-size"><i class="fa fa-check"></i><b>16.4.2</b> Estimation of Effective Sample Size</a></li>
<li class="chapter" data-level="16.4.3" data-path="effective-sample-size-section.html"><a href="effective-sample-size-section.html#estimation-of-mcmc-standard-error"><i class="fa fa-check"></i><b>16.4.3</b> Estimation of MCMC Standard Error</a></li>
<li class="chapter" data-level="16.4.4" data-path="effective-sample-size-section.html"><a href="effective-sample-size-section.html#thinning-samples"><i class="fa fa-check"></i><b>16.4.4</b> Thinning Samples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="optimization-algorithms-chapter.html"><a href="optimization-algorithms-chapter.html"><i class="fa fa-check"></i><b>17</b> Optimization</a><ul>
<li class="chapter" data-level="17.1" data-path="general-configuration.html"><a href="general-configuration.html"><i class="fa fa-check"></i><b>17.1</b> General Configuration</a></li>
<li class="chapter" data-level="17.2" data-path="bfgs-and-l-bfgs-configuration.html"><a href="bfgs-and-l-bfgs-configuration.html"><i class="fa fa-check"></i><b>17.2</b> BFGS and L-BFGS Configuration</a><ul>
<li class="chapter" data-level="" data-path="bfgs-and-l-bfgs-configuration.html"><a href="bfgs-and-l-bfgs-configuration.html#convergence-monitoring"><i class="fa fa-check"></i>Convergence Monitoring</a></li>
<li class="chapter" data-level="" data-path="bfgs-and-l-bfgs-configuration.html"><a href="bfgs-and-l-bfgs-configuration.html#initial-step-size"><i class="fa fa-check"></i>Initial Step Size</a></li>
<li class="chapter" data-level="" data-path="bfgs-and-l-bfgs-configuration.html"><a href="bfgs-and-l-bfgs-configuration.html#l-bfgs-history-size"><i class="fa fa-check"></i>L-BFGS History Size</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="general-configuration-options.html"><a href="general-configuration-options.html"><i class="fa fa-check"></i><b>17.3</b> General Configuration Options</a></li>
<li class="chapter" data-level="17.4" data-path="writing-models-for-optimization.html"><a href="writing-models-for-optimization.html"><i class="fa fa-check"></i><b>17.4</b> Writing Models for Optimization</a><ul>
<li class="chapter" data-level="" data-path="writing-models-for-optimization.html"><a href="writing-models-for-optimization.html#constrained-vs.unconstrained-parameters"><i class="fa fa-check"></i>Constrained vs. Unconstrained Parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="vi-algorithms-chapter.html"><a href="vi-algorithms-chapter.html"><i class="fa fa-check"></i><b>18</b> Variational Inference</a><ul>
<li class="chapter" data-level="18.1" data-path="stochastic-gradient-ascent.html"><a href="stochastic-gradient-ascent.html"><i class="fa fa-check"></i><b>18.1</b> Stochastic Gradient Ascent</a><ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-ascent.html"><a href="stochastic-gradient-ascent.html#monte-carlo-approximation-of-the-elbo"><i class="fa fa-check"></i>Monte Carlo Approximation of the ELBO</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-ascent.html"><a href="stochastic-gradient-ascent.html#monte-carlo-approximation-of-the-gradients"><i class="fa fa-check"></i>Monte Carlo Approximation of the Gradients</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-ascent.html"><a href="stochastic-gradient-ascent.html#adaptive-stepsize-sequence"><i class="fa fa-check"></i>Adaptive Stepsize Sequence</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-ascent.html"><a href="stochastic-gradient-ascent.html#assessing-convergence"><i class="fa fa-check"></i>Assessing Convergence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="diagnostic-algorithms-chapter.html"><a href="diagnostic-algorithms-chapter.html"><i class="fa fa-check"></i><b>19</b> Diagnostic Mode</a><ul>
<li class="chapter" data-level="19.1" data-path="output-1.html"><a href="output-1.html"><i class="fa fa-check"></i><b>19.1</b> Output</a><ul>
<li class="chapter" data-level="" data-path="output-1.html"><a href="output-1.html#unconstrained-scale"><i class="fa fa-check"></i>Unconstrained Scale</a></li>
<li class="chapter" data-level="" data-path="output-1.html"><a href="output-1.html#includes-jacobian"><i class="fa fa-check"></i>Includes Jacobian</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="configuration-options.html"><a href="configuration-options.html"><i class="fa fa-check"></i><b>19.2</b> Configuration Options</a></li>
<li class="chapter" data-level="19.3" data-path="speed-warning-and-data-trimming.html"><a href="speed-warning-and-data-trimming.html"><i class="fa fa-check"></i><b>19.3</b> Speed Warning and Data Trimming</a></li>
</ul></li>
<li><a href="usage.html#usage"><i style="font-size: 110%; color:#990017;">Usage</i></a></li>
<li class="chapter" data-level="20" data-path="reproducibility-chapter.html"><a href="reproducibility-chapter.html"><i class="fa fa-check"></i><b>20</b> Reproducibility</a></li>
<li class="chapter" data-level="21" data-path="licensing-appendix.html"><a href="licensing-appendix.html"><i class="fa fa-check"></i><b>21</b> Licenses and Dependencies</a><ul>
<li class="chapter" data-level="21.1" data-path="stan-license.html"><a href="stan-license.html"><i class="fa fa-check"></i><b>21.1</b> Stan License</a></li>
<li class="chapter" data-level="21.2" data-path="boost-license.html"><a href="boost-license.html"><i class="fa fa-check"></i><b>21.2</b> Boost License</a></li>
<li class="chapter" data-level="21.3" data-path="eigen-license.html"><a href="eigen-license.html"><i class="fa fa-check"></i><b>21.3</b> Eigen License</a></li>
<li class="chapter" data-level="21.4" data-path="sundials-license.html"><a href="sundials-license.html"><i class="fa fa-check"></i><b>21.4</b> SUNDIALS License</a></li>
<li class="chapter" data-level="21.5" data-path="google-test-license.html"><a href="google-test-license.html"><i class="fa fa-check"></i><b>21.5</b> Google Test License</a></li>
</ul></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan Reference Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div>
This is an old version, <a href="https://mc-stan.org/docs/reference-manual/analysis.html#notation-for-samples-chains-and-draws">view current version</a>.
</div>
<div id="notation-for-samples-chains-and-draws" class="section level2">
<h2><span class="header-section-number">16.3</span> Notation for samples, chains, and draws</h2>
<p>To establish basic notation, suppose a target Bayesian posterior density <span class="math inline">\(p(\theta | y)\)</span> given real-valued vectors of parameters <span class="math inline">\(\theta\)</span> and real- and discrete-valued data <span class="math inline">\(y\)</span>.<a href="#fn25" class="footnoteRef" id="fnref25"><sup>25</sup></a></p>
<p>An MCMC <em>sample</em> consists of a set of a sequence of <span class="math inline">\(M\)</span> Markov chains, each consisting of an ordered sequence of <span class="math inline">\(N\)</span> <em>draws</em> from the posterior.<a href="#fn26" class="footnoteRef" id="fnref26"><sup>26</sup></a> The sample thus consists of <span class="math inline">\(M \times N\)</span> draws from the posterior.</p>
<div id="potential-scale-reduction" class="section level3">
<h3><span class="header-section-number">16.3.1</span> Potential Scale Reduction</h3>
<p>One way to monitor whether a chain has converged to the equilibrium distribution is to compare its behavior to other randomly initialized chains. This is the motivation for the <span class="citation">Gelman and Rubin (<a href="#ref-GelmanRubin:1992">1992</a>)</span> potential scale reduction statistic, <span class="math inline">\(\hat{R}\)</span>. The <span class="math inline">\(\hat{R}\)</span> statistic measures the ratio of the average variance of samples within each chain to the variance of the pooled samples across chains; if all chains are at equilibrium, these will be the same and <span class="math inline">\(\hat{R}\)</span> will be one. If the chains have not converged to a common distribution, the <span class="math inline">\(\hat{R}\)</span> statistic will be greater than one.</p>
<p>Gelman and Rubin’s recommendation is that the independent Markov chains be initialized with diffuse starting values for the parameters and sampled until all values for <span class="math inline">\(\hat{R}\)</span> are below 1.1. Stan allows users to specify initial values for parameters and it is also able to draw diffuse random initializations automatically satisfying the declared parameter constraints.</p>
<p>The <span class="math inline">\(\hat{R}\)</span> statistic is defined for a set of <span class="math inline">\(M\)</span> Markov chains, <span class="math inline">\(\theta_m\)</span>, each of which has <span class="math inline">\(N\)</span> samples <span class="math inline">\(\theta^{(n)}_m\)</span>. The <em>between-chain variance</em> estimate is</p>
<p><span class="math display">\[
B
=
\frac{N}{M-1}
\,
\sum_{m=1}^M (\bar{\theta}^{(\bullet)}_{m}
                - \bar{\theta}^{(\bullet)}_{\bullet})^2,
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\bar{\theta}_m^{(\bullet)}
= \frac{1}{N} \sum_{n = 1}^N \theta_m^{(n)}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\bar{\theta}^{(\bullet)}_{\bullet}
= \frac{1}{M} \, \sum_{m=1}^M \bar{\theta}_m^{(\bullet)}.
\]</span></p>
<p>The <em>within-chain variance</em> is averaged over the chains,</p>
<p><span class="math display">\[
W = \frac{1}{M} \, \sum_{m=1}^M s_m^2,
\]</span></p>
<p>where</p>
<p><span class="math display">\[
s_m^2
=
\frac{1}{N-1}
\, \sum_{n=1}^N (\theta^{(n)}_m - \bar{\theta}^{(\bullet)}_m)^2.
\]</span></p>
<p>The <em>variance estimator</em> is a mixture of the within-chain and cross-chain sample variances,</p>
<p><span class="math display">\[
\widehat{\mbox{var}}^{+}\!(\theta|y)
= \frac{N-1}{N}\, W \, + \, \frac{1}{N} \, B.
\]</span></p>
<p>Finally, the <em>potential scale reduction statistic</em> is defined by</p>
<p><span class="math display">\[
\hat{R}
\, = \,
\sqrt{\frac{\widehat{\mbox{var}}^{+}\!(\theta|y)}{W}}.
\]</span></p>
</div>
<div id="split-r-hat-for-detecting-non-stationarity" class="section level3">
<h3><span class="header-section-number">16.3.2</span> Split R-hat for Detecting Non-Stationarity</h3>
<p>Before Stan calculating the potential-scale-reduction statistic <span class="math inline">\(\hat{R}\)</span>, each chain is split into two halves. This provides an additional means to detect non-stationarity in the individual chains. If one chain involves gradually increasing values and one involves gradually decreasing values, they have not mixed well, but they can have <span class="math inline">\(\hat{R}\)</span> values near unity. In this case, splitting each chain into two parts leads to <span class="math inline">\(\hat{R}\)</span> values substantially greater than 1 because the first half of each chain has not mixed with the second half.</p>
</div>
<div id="convergence-is-global" class="section level3">
<h3><span class="header-section-number">16.3.3</span> Convergence is Global</h3>
<p>A question that often arises is whether it is acceptable to monitor convergence of only a subset of the parameters or generated quantities. The short answer is “no,” but this is elaborated further in this section.</p>
<p>For example, consider the value <code>lp__</code>, which is the log posterior density (up to a constant).<a href="#fn27" class="footnoteRef" id="fnref27"><sup>27</sup></a></p>
<p>It is thus a mistake to declare convergence in any practical sense if <code>lp__</code> has not converged, because different chains are really in different parts of the space. Yet measuring convergence for <code>lp__</code> is particularly tricky, as noted below.</p>
<div id="asymptotics-and-transience-vs.equilibrium" class="section level4">
<h4><span class="header-section-number">16.3.3.1</span> Asymptotics and transience vs. equilibrium</h4>
<p>Markov chain convergence is a global property in the sense that it does not depend on the choice of function of the parameters that is monitored. There is no hard cutoff between pre-convergence “transience” and post-convergence “equilibrium.” What happens is that as the number of states in the chain approaches infinity, the distribution of possible states in the chain approaches the target distribution and in that limit the expected value of the Monte Carlo estimator of any integrable function converges to the true expectation. There is nothing like warmup here, because in the limit, the effects of initial state are completely washed out.</p>
</div>
<div id="multivariate-convergence-of-functions" class="section level4">
<h4><span class="header-section-number">16.3.3.2</span> Multivariate convergence of functions</h4>
<p>The <span class="math inline">\(\hat{R}\)</span> statistic considers the composition of a Markov chain and a function, and if the Markov chain has converged then each Markov chain and function composition will have converged. Multivariate functions converge when all of their margins have converged by the Cramer-Wold theorem.</p>
<p>The transformation from unconstrained space to constrained space is just another function, so does not effect convergence.</p>
<p>Different functions may have different autocorrelations, but if the Markov chain has equilibrated then all Markov chain plus function compositions should be consistent with convergence. Formally, any function that appears inconsistent is of concern and although it would be unreasonable to test every function, <code>lp__</code> and other measured quantities should at least be consistent.</p>
<p>The obvious difference in <code>lp__</code> is that it tends to vary quickly with position and is consequently susceptible to outliers.</p>
</div>
<div id="finite-numbers-of-states" class="section level4">
<h4><span class="header-section-number">16.3.3.3</span> Finite numbers of states</h4>
<p>The question is what happens for finite numbers of states? If we can prove a strong geometric ergodicity property (which depends on the sampler and the target distribution), then one can show that there exists a finite time after which the chain forgets its initial state with a large probability. This is both the autocorrelation time and the warmup time. But even if you can show it exists and is finite (which is nigh impossible) you can’t compute an actual value analytically.</p>
<p>So what we do in practice is hope that the finite number of draws is large enough for the expectations to be reasonably accurate. Removing warmup iterations improves the accuracy of the expectations but there is no guarantee that removing any finite number of samples will be enough.</p>
</div>
<div id="why-inconsistent-r-hat" class="section level4">
<h4><span class="header-section-number">16.3.3.4</span> Why inconsistent R-hat?</h4>
<p>Firstly, as noted above, for any finite number of draws, there will always be some residual effect of the initial state, which typically manifests as some small (or large if the autocorrelation time is huge) probability of having a large outlier. Functions robust to such outliers (say, quantiles) will appear more stable and have better <span class="math inline">\(\hat{R}\)</span>. Functions vulnerable to such outliers may show fragility.</p>
<p>Secondly, use of the <span class="math inline">\(\hat{R}\)</span> statistic makes very strong assumptions. In particular, it assumes that the functions being considered are Gaussian or it only uses the first two moments and assumes some kind of independence. The point is that strong assumptions are made that do not always hold. In particular, the distribution for the log posterior density (<code>lp__</code>) almost never looks Gaussian, instead it features long tails that can lead to large <span class="math inline">\(\hat{R}\)</span> even in the large <span class="math inline">\(N\)</span> limit. Tweaks to <span class="math inline">\(\hat{R}\)</span>, such as using quantiles in place of raw values, have the flavor of making the samples of interest more Gaussian and hence the <span class="math inline">\(\hat{R}\)</span> statistic more accurate.</p>
</div>
<div id="final-words-on-convergence-monitoring" class="section level4">
<h4><span class="header-section-number">16.3.3.5</span> Final words on convergence monitoring</h4>
<p>“Convergence” is a global property and holds for all integrable functions at once, but employing the <span class="math inline">\(\hat{R}\)</span> statistic requires additional assumptions and thus may not work for all functions equally well.</p>
<p>Note that if you just compare the expectations between chains then we can rely on the Markov chain asymptotics for Gaussian distributions and can apply the standard tests.</p>
</div>
</div>
</div>
<h3><i style="font-size: 110%; color:#990017;">References</i></h3>
<div id="refs" class="references">
<div id="ref-GelmanRubin:1992">
<p>Gelman, Andrew, and Donald B. Rubin. 1992. “Inference from Iterative Simulation Using Multiple Sequences.” <em>Statistical Science</em> 7 (4): 457–72.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="25">
<li id="fn25"><p>Using vectors simplifies high level exposition at the expense of collapsing structure.<a href="notation-for-samples-chains-and-draws.html#fnref25">↩</a></p></li>
<li id="fn26"><p>The structure is assumed to be rectangular; in the future, this needs to be generalized to ragged samples.<a href="notation-for-samples-chains-and-draws.html#fnref26">↩</a></p></li>
<li id="fn27"><p>The <code>lp__</code> value also represents the potential energy in the Hamiltonian system and is rate bounded by the randomly supplied kinetic energy each iteration, which follows a Chi-square distribution in the number of parameters.<a href="notation-for-samples-chains-and-draws.html#fnref27">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="convergence.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="effective-sample-size-section.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
