<!DOCTYPE html>
<html lang="" xml:lang="">
<head>
<link rel="canonical" href="https://mc-stan.org/docs/stan-users-guide/latent-discrete.html#mark-recapture-models" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Mark-recapture models | Stan User’s Guide</title>
  <meta name="description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Mark-recapture models | Stan User’s Guide" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/img/logo-tm.pdf" />
  <meta property="og:description" content="Stan user’s guide with examples and programming techniques." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Mark-recapture models | Stan User’s Guide" />
  
  <meta name="twitter:description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="twitter:image" content="/img/logo-tm.pdf" />

<meta name="author" content="Stan Development Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="change-point.html"/>
<link rel="next" href="data-coding-and-diagnostic-accuracy-models.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/stan-users-guide/index.html" style="color:#4183C4">Stan User's Guide</a></li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li><a href="example-models.html#example-models.part"><i style="font-size: 110%; color:#990017;">Part 1. Example Models</i></a></li>
<li class="chapter" data-level="1" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>1</b> Regression Models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1.1</b> Linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#vectorization.section"><i class="fa fa-check"></i>Matrix notation and vectorization</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="QR-reparameterization.html"><a href="QR-reparameterization.html"><i class="fa fa-check"></i><b>1.2</b> The QR reparameterization</a></li>
<li class="chapter" data-level="1.3" data-path="regression-priors.html"><a href="regression-priors.html"><i class="fa fa-check"></i><b>1.3</b> Priors for coefficients and scales</a></li>
<li class="chapter" data-level="1.4" data-path="robust-noise-models.html"><a href="robust-noise-models.html"><i class="fa fa-check"></i><b>1.4</b> Robust noise models</a></li>
<li class="chapter" data-level="1.5" data-path="logistic-probit-regression.html"><a href="logistic-probit-regression.html"><i class="fa fa-check"></i><b>1.5</b> Logistic and probit regression</a></li>
<li class="chapter" data-level="1.6" data-path="multi-logit.html"><a href="multi-logit.html"><i class="fa fa-check"></i><b>1.6</b> Multi-logit regression</a>
<ul>
<li class="chapter" data-level="" data-path="multi-logit.html"><a href="multi-logit.html#identifiability"><i class="fa fa-check"></i>Identifiability</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html"><i class="fa fa-check"></i><b>1.7</b> Parameterizing centered vectors</a>
<ul>
<li><a href="parameterizing-centered-vectors.html#k-1-degrees-of-freedom"><span class="math inline">\(K-1\)</span> degrees of freedom</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#qr-decomposition"><i class="fa fa-check"></i>QR decomposition</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#translated-and-scaled-simplex"><i class="fa fa-check"></i>Translated and scaled simplex</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#soft-centering"><i class="fa fa-check"></i>Soft centering</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="ordered-logistic.html"><a href="ordered-logistic.html"><i class="fa fa-check"></i><b>1.8</b> Ordered logistic and probit regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordered-logistic.html"><a href="ordered-logistic.html#ordered-logistic-regression"><i class="fa fa-check"></i>Ordered logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="hierarchical-logistic-regression.html"><a href="hierarchical-logistic-regression.html"><i class="fa fa-check"></i><b>1.9</b> Hierarchical logistic regression</a></li>
<li class="chapter" data-level="1.10" data-path="hierarchical-priors.html"><a href="hierarchical-priors.html"><i class="fa fa-check"></i><b>1.10</b> Hierarchical priors</a>
<ul>
<li class="chapter" data-level="" data-path="hierarchical-priors.html"><a href="hierarchical-priors.html#boundary-avoiding-priors-for-mle-in-hierarchical-models"><i class="fa fa-check"></i>Boundary-avoiding priors for MLE in hierarchical models</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="item-response-models.html"><a href="item-response-models.html"><i class="fa fa-check"></i><b>1.11</b> Item-response theory models</a>
<ul>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#data-declaration-with-missingness"><i class="fa fa-check"></i>Data declaration with missingness</a></li>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#pl-rasch-model"><i class="fa fa-check"></i>1PL (Rasch) model</a></li>
<li class="chapter" data-level="" data-path="item-response-models.html"><a href="item-response-models.html#multilevel-2pl-model"><i class="fa fa-check"></i>Multilevel 2PL model</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="priors-for-identification.html"><a href="priors-for-identification.html"><i class="fa fa-check"></i><b>1.12</b> Priors for identifiability</a>
<ul>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#location-and-scale-invariance"><i class="fa fa-check"></i>Location and scale invariance</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification.html"><a href="priors-for-identification.html#separability"><i class="fa fa-check"></i>Separability</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="multivariate-hierarchical-priors.html"><a href="multivariate-hierarchical-priors.html"><i class="fa fa-check"></i><b>1.13</b> Multivariate priors for hierarchical models</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-hierarchical-priors.html"><a href="multivariate-hierarchical-priors.html#multivariate-regression-example"><i class="fa fa-check"></i>Multivariate regression example</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html"><i class="fa fa-check"></i><b>1.14</b> Prediction, forecasting, and backcasting</a>
<ul>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#programming-predictions"><i class="fa fa-check"></i>Programming predictions</a></li>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#predictions-as-generated-quantities"><i class="fa fa-check"></i>Predictions as generated quantities</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html"><i class="fa fa-check"></i><b>1.15</b> Multivariate outcomes</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#seemingly-unrelated-regressions"><i class="fa fa-check"></i>Seemingly unrelated regressions</a></li>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#multivariate-probit-regression"><i class="fa fa-check"></i>Multivariate probit regression</a></li>
</ul></li>
<li class="chapter" data-level="1.16" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html"><i class="fa fa-check"></i><b>1.16</b> Applications of pseudorandom number generation</a>
<ul>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#posterior-predictive-checks"><i class="fa fa-check"></i>Posterior predictive checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>2</b> Time-Series Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="autoregressive.html"><a href="autoregressive.html"><i class="fa fa-check"></i><b>2.1</b> Autoregressive models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#ar1-models"><i class="fa fa-check"></i>AR(1) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#extensions-to-the-ar1-model"><i class="fa fa-check"></i>Extensions to the AR(1) model</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#ar2-models"><i class="fa fa-check"></i>AR(2) models</a></li>
<li><a href="autoregressive.html#ark-models">AR(<span class="math inline">\(K\)</span>) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive.html"><a href="autoregressive.html#arch1-models"><i class="fa fa-check"></i>ARCH(1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html"><i class="fa fa-check"></i><b>2.2</b> Modeling temporal heteroscedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html#garch11-models"><i class="fa fa-check"></i>GARCH(1,1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>2.3</b> Moving average models</a>
<ul>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#ma2-example"><i class="fa fa-check"></i>MA(2) example</a></li>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#vectorized-maq-model"><i class="fa fa-check"></i>Vectorized MA(Q) model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html"><i class="fa fa-check"></i><b>2.4</b> Autoregressive moving average models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html#identifiability-and-stationarity"><i class="fa fa-check"></i>Identifiability and stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="stochastic-volatility-models.html"><a href="stochastic-volatility-models.html"><i class="fa fa-check"></i><b>2.5</b> Stochastic volatility models</a></li>
<li class="chapter" data-level="2.6" data-path="hmms.html"><a href="hmms.html"><i class="fa fa-check"></i><b>2.6</b> Hidden Markov models</a>
<ul>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#supervised-parameter-estimation"><i class="fa fa-check"></i>Supervised parameter estimation</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#start-state-and-end-state-probabilities"><i class="fa fa-check"></i>Start-state and end-state probabilities</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#calculating-sufficient-statistics"><i class="fa fa-check"></i>Calculating sufficient statistics</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#analytic-posterior"><i class="fa fa-check"></i>Analytic posterior</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#semisupervised-estimation"><i class="fa fa-check"></i>Semisupervised estimation</a></li>
<li class="chapter" data-level="" data-path="hmms.html"><a href="hmms.html#predictive-inference"><i class="fa fa-check"></i>Predictive inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missing-data-and-partially-known-parameters.html"><a href="missing-data-and-partially-known-parameters.html"><i class="fa fa-check"></i><b>3</b> Missing Data and Partially Known Parameters</a>
<ul>
<li class="chapter" data-level="3.1" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>3.1</b> Missing data</a></li>
<li class="chapter" data-level="3.2" data-path="partially-known-parameters.html"><a href="partially-known-parameters.html"><i class="fa fa-check"></i><b>3.2</b> Partially known parameters</a></li>
<li class="chapter" data-level="3.3" data-path="sliced-missing-data.html"><a href="sliced-missing-data.html"><i class="fa fa-check"></i><b>3.3</b> Sliced missing data</a></li>
<li class="chapter" data-level="3.4" data-path="loading-matrix-for-factor-analysis.html"><a href="loading-matrix-for-factor-analysis.html"><i class="fa fa-check"></i><b>3.4</b> Loading matrix for factor analysis</a></li>
<li class="chapter" data-level="3.5" data-path="missing-multivariate-data.html"><a href="missing-multivariate-data.html"><i class="fa fa-check"></i><b>3.5</b> Missing multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="truncated-or-censored-data.html"><a href="truncated-or-censored-data.html"><i class="fa fa-check"></i><b>4</b> Truncated or Censored Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="truncation.html"><a href="truncation.html"><i class="fa fa-check"></i><b>4.1</b> Truncated distributions</a></li>
<li class="chapter" data-level="4.2" data-path="truncated-data.html"><a href="truncated-data.html"><i class="fa fa-check"></i><b>4.2</b> Truncated data</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-data.html"><a href="truncated-data.html#constraints-and-out-of-bounds-returns"><i class="fa fa-check"></i>Constraints and out-of-bounds returns</a></li>
<li class="chapter" data-level="" data-path="truncated-data.html"><a href="truncated-data.html#unknown-truncation-points"><i class="fa fa-check"></i>Unknown truncation points</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="censored-data.html"><a href="censored-data.html"><i class="fa fa-check"></i><b>4.3</b> Censored data</a>
<ul>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#estimating-censored-values"><i class="fa fa-check"></i>Estimating censored values</a></li>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#integrating-out-censored-values"><i class="fa fa-check"></i>Integrating out censored values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixture-modeling.html"><a href="mixture-modeling.html"><i class="fa fa-check"></i><b>5</b> Finite Mixtures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clustering-mixture.html"><a href="clustering-mixture.html"><i class="fa fa-check"></i><b>5.1</b> Relation to clustering</a></li>
<li class="chapter" data-level="5.2" data-path="latent-discrete-parameterization.html"><a href="latent-discrete-parameterization.html"><i class="fa fa-check"></i><b>5.2</b> Latent discrete parameterization</a></li>
<li class="chapter" data-level="5.3" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html"><i class="fa fa-check"></i><b>5.3</b> Summing out the responsibility parameter</a>
<ul>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#log-sum-of-exponentials-linear-sums-on-the-log-scale"><i class="fa fa-check"></i>Log sum of exponentials: linear Sums on the log scale</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#dropping-uniform-mixture-ratios"><i class="fa fa-check"></i>Dropping uniform mixture ratios</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#recovering-posterior-mixture-proportions"><i class="fa fa-check"></i>Recovering posterior mixture proportions</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#estimating-parameters-of-a-mixture"><i class="fa fa-check"></i>Estimating parameters of a mixture</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectorizing-mixtures.html"><a href="vectorizing-mixtures.html"><i class="fa fa-check"></i><b>5.4</b> Vectorizing mixtures</a></li>
<li class="chapter" data-level="5.5" data-path="mixture-inference.html"><a href="mixture-inference.html"><i class="fa fa-check"></i><b>5.5</b> Inferences supported by mixtures</a>
<ul>
<li class="chapter" data-level="" data-path="mixture-inference.html"><a href="mixture-inference.html#mixtures-with-unidentifiable-components"><i class="fa fa-check"></i>Mixtures with unidentifiable components</a></li>
<li class="chapter" data-level="" data-path="mixture-inference.html"><a href="mixture-inference.html#inference-under-label-switching"><i class="fa fa-check"></i>Inference under label switching</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="zero-inflated.html"><a href="zero-inflated.html"><i class="fa fa-check"></i><b>5.6</b> Zero-inflated and hurdle models</a>
<ul>
<li class="chapter" data-level="" data-path="zero-inflated.html"><a href="zero-inflated.html#zero-inflation"><i class="fa fa-check"></i>Zero inflation</a></li>
<li class="chapter" data-level="" data-path="zero-inflated.html"><a href="zero-inflated.html#hurdle-models"><i class="fa fa-check"></i>Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html"><i class="fa fa-check"></i><b>5.7</b> Priors and effective data size in mixture models</a>
<ul>
<li class="chapter" data-level="" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html#comparison-to-model-averaging"><i class="fa fa-check"></i>Comparison to model averaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="measurement-error-and-meta-analysis.html"><a href="measurement-error-and-meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Measurement Error and Meta-Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html"><i class="fa fa-check"></i><b>6.1</b> Bayesian measurement error model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#regression-with-measurement-error"><i class="fa fa-check"></i>Regression with measurement error</a></li>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#rounding"><i class="fa fa-check"></i>Rounding</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Meta-analysis</a>
<ul>
<li class="chapter" data-level="" data-path="meta-analysis.html"><a href="meta-analysis.html#treatment-effects-in-controlled-studies"><i class="fa fa-check"></i>Treatment effects in controlled studies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-discrete.html"><a href="latent-discrete.html"><i class="fa fa-check"></i><b>7</b> Latent Discrete Parameters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rao-blackwell.html"><a href="rao-blackwell.html"><i class="fa fa-check"></i><b>7.1</b> The benefits of marginalization</a></li>
<li class="chapter" data-level="7.2" data-path="change-point.html"><a href="change-point.html"><i class="fa fa-check"></i><b>7.2</b> Change point models</a>
<ul>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#model-with-latent-discrete-parameter"><i class="fa fa-check"></i>Model with latent discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#marginalizing-out-the-discrete-parameter"><i class="fa fa-check"></i>Marginalizing out the discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#coding-the-model-in-stan-1"><i class="fa fa-check"></i>Coding the model in Stan</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#fitting-the-model-with-mcmc"><i class="fa fa-check"></i>Fitting the model with MCMC</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#posterior-distribution-of-the-discrete-change-point"><i class="fa fa-check"></i>Posterior distribution of the discrete change point</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#discrete-sampling"><i class="fa fa-check"></i>Discrete sampling</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#posterior-covariance"><i class="fa fa-check"></i>Posterior covariance</a></li>
<li class="chapter" data-level="" data-path="change-point.html"><a href="change-point.html#multiple-change-points"><i class="fa fa-check"></i>Multiple change points</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html"><i class="fa fa-check"></i><b>7.3</b> Mark-recapture models</a>
<ul>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#simple-mark-recapture-model"><i class="fa fa-check"></i>Simple mark-recapture model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#cormack-jolly-seber-with-discrete-parameter"><i class="fa fa-check"></i>Cormack-Jolly-Seber with discrete parameter</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#collective-cormack-jolly-seber-model"><i class="fa fa-check"></i>Collective Cormack-Jolly-Seber model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#individual-cormack-jolly-seber-model"><i class="fa fa-check"></i>Individual Cormack-Jolly-Seber model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html"><i class="fa fa-check"></i><b>7.4</b> Data coding and diagnostic accuracy models</a>
<ul>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#diagnostic-accuracy"><i class="fa fa-check"></i>Diagnostic accuracy</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#data-coding"><i class="fa fa-check"></i>Data coding</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-categorical-measurement-model"><i class="fa fa-check"></i>Noisy categorical measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#model-parameters"><i class="fa fa-check"></i>Model parameters</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-measurement-model"><i class="fa fa-check"></i>Noisy measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#stan-implementation"><i class="fa fa-check"></i>Stan implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sparse-ragged.html"><a href="sparse-ragged.html"><i class="fa fa-check"></i><b>8</b> Sparse and Ragged Data Structures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sparse-data-structures.html"><a href="sparse-data-structures.html"><i class="fa fa-check"></i><b>8.1</b> Sparse data structures</a></li>
<li class="chapter" data-level="8.2" data-path="ragged-data-structs.html"><a href="ragged-data-structs.html"><i class="fa fa-check"></i><b>8.2</b> Ragged data structures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="relation-to-finite-mixture-models.html"><a href="relation-to-finite-mixture-models.html"><i class="fa fa-check"></i><b>9.1</b> Relation to finite mixture models</a></li>
<li class="chapter" data-level="9.2" data-path="soft-k-means.html"><a href="soft-k-means.html"><i class="fa fa-check"></i><b>9.2</b> Soft <em>K</em>-means</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="soft-k-means.html"><a href="soft-k-means.html#geometric-hard-k-means-clustering"><i class="fa fa-check"></i><b>9.2.1</b> Geometric hard <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="9.2.2" data-path="soft-k-means.html"><a href="soft-k-means.html#soft-k-means-clustering"><i class="fa fa-check"></i><b>9.2.2</b> Soft <em>K</em>-means clustering</a></li>
<li><a href="soft-k-means.html#stan-implementation-of-soft-k-means">Stan implementation of soft <em>K</em>-means</a></li>
<li><a href="soft-k-means.html#generalizing-soft-k-means">Generalizing soft <em>K</em>-means</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html"><i class="fa fa-check"></i><b>9.3</b> The difficulty of Bayesian inference for clustering</a>
<ul>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#non-identifiability"><i class="fa fa-check"></i>Non-identifiability</a></li>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#multimodality"><i class="fa fa-check"></i>Multimodality</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html"><i class="fa fa-check"></i><b>9.4</b> Naive Bayes classification and clustering</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#coding-ragged-arrays"><i class="fa fa-check"></i>Coding ragged arrays</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-with-category-labeled-training-data"><i class="fa fa-check"></i>Estimation with category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-without-category-labeled-training-data"><i class="fa fa-check"></i>Estimation without category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#full-bayesian-inference-for-naive-bayes"><i class="fa fa-check"></i>Full Bayesian inference for naive Bayes</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#prediction-without-model-updates"><i class="fa fa-check"></i>Prediction without model updates</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>9.5</b> Latent Dirichlet allocation</a>
<ul>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#the-lda-model"><i class="fa fa-check"></i>The LDA Model</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#summing-out-the-discrete-parameters"><i class="fa fa-check"></i>Summing out the discrete parameters</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#implementation-of-lda"><i class="fa fa-check"></i>Implementation of LDA</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#correlated-topic-model"><i class="fa fa-check"></i>Correlated topic model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gaussian-processes.html"><a href="gaussian-processes.html"><i class="fa fa-check"></i><b>10</b> Gaussian Processes</a>
<ul>
<li class="chapter" data-level="10.1" data-path="gaussian-process-regression.html"><a href="gaussian-process-regression.html"><i class="fa fa-check"></i><b>10.1</b> Gaussian process regression</a></li>
<li class="chapter" data-level="10.2" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html"><i class="fa fa-check"></i><b>10.2</b> Simulating from a Gaussian process</a>
<ul>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#multivariate-inputs"><i class="fa fa-check"></i>Multivariate inputs</a></li>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#cholesky-factored-and-transformed-implementation"><i class="fa fa-check"></i>Cholesky factored and transformed implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fit-gp.html"><a href="fit-gp.html"><i class="fa fa-check"></i><b>10.3</b> Fitting a Gaussian process</a>
<ul>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#gp-with-a-normal-outcome"><i class="fa fa-check"></i>GP with a normal outcome</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#discrete-outcomes-with-gaussian-processes"><i class="fa fa-check"></i>Discrete outcomes with Gaussian processes</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#automatic-relevance-determination"><i class="fa fa-check"></i>Automatic relevance determination</a></li>
<li class="chapter" data-level="10.3.1" data-path="fit-gp.html"><a href="fit-gp.html#priors-gp.section"><i class="fa fa-check"></i><b>10.3.1</b> Priors for Gaussian process parameters</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#predictive-inference-with-a-gaussian-process"><i class="fa fa-check"></i>Predictive inference with a Gaussian process</a></li>
<li class="chapter" data-level="" data-path="fit-gp.html"><a href="fit-gp.html#multiple-output-gaussian-processes"><i class="fa fa-check"></i>Multiple-output Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="directions-rotations-and-hyperspheres.html"><a href="directions-rotations-and-hyperspheres.html"><i class="fa fa-check"></i><b>11</b> Directions, Rotations, and Hyperspheres</a>
<ul>
<li class="chapter" data-level="11.1" data-path="unit-vectors.html"><a href="unit-vectors.html"><i class="fa fa-check"></i><b>11.1</b> Unit vectors</a></li>
<li class="chapter" data-level="11.2" data-path="circles-spheres-and-hyperspheres.html"><a href="circles-spheres-and-hyperspheres.html"><i class="fa fa-check"></i><b>11.2</b> Circles, spheres, and hyperspheres</a></li>
<li class="chapter" data-level="11.3" data-path="transforming-to-unconstrained-parameters.html"><a href="transforming-to-unconstrained-parameters.html"><i class="fa fa-check"></i><b>11.3</b> Transforming to unconstrained parameters</a></li>
<li class="chapter" data-level="11.4" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html"><i class="fa fa-check"></i><b>11.4</b> Unit vectors and rotations</a>
<ul>
<li class="chapter" data-level="" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html#angles-from-unit-vectors"><i class="fa fa-check"></i>Angles from unit vectors</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="circular-representations-of-days-and-years.html"><a href="circular-representations-of-days-and-years.html"><i class="fa fa-check"></i><b>11.5</b> Circular representations of days and years</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="algebra-solver.html"><a href="algebra-solver.html"><i class="fa fa-check"></i><b>12</b> Solving Algebraic Equations</a>
<ul>
<li class="chapter" data-level="12.1" data-path="example-system-of-nonlinear-algebraic-equations.html"><a href="example-system-of-nonlinear-algebraic-equations.html"><i class="fa fa-check"></i><b>12.1</b> Example: system of nonlinear algebraic equations</a></li>
<li class="chapter" data-level="12.2" data-path="coding-an-algebraic-system.html"><a href="coding-an-algebraic-system.html"><i class="fa fa-check"></i><b>12.2</b> Coding an algebraic system</a></li>
<li class="chapter" data-level="12.3" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html"><i class="fa fa-check"></i><b>12.3</b> Calling the algebraic solver</a>
<ul>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#data-versus-parameters"><i class="fa fa-check"></i>Data versus parameters</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#length-of-the-algebraic-function-and-of-the-vector-of-unknowns"><i class="fa fa-check"></i>Length of the algebraic function and of the vector of unknowns</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#pathological-solutions"><i class="fa fa-check"></i>Pathological solutions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="algebra-control.html"><a href="algebra-control.html"><i class="fa fa-check"></i><b>12.4</b> Control parameters for the algebraic solver</a>
<ul>
<li class="chapter" data-level="" data-path="algebra-control.html"><a href="algebra-control.html#tolerance"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="algebra-control.html"><a href="algebra-control.html#maximum-number-of-steps"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ode-solver.html"><a href="ode-solver.html"><i class="fa fa-check"></i><b>13</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>13.1</b> Notation</a></li>
<li class="chapter" data-level="13.2" data-path="example-simple-harmonic-oscillator.html"><a href="example-simple-harmonic-oscillator.html"><i class="fa fa-check"></i><b>13.2</b> Example: simple harmonic oscillator</a></li>
<li class="chapter" data-level="13.3" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html"><i class="fa fa-check"></i><b>13.3</b> Coding the ODE system function</a>
<ul>
<li class="chapter" data-level="" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html#strict-signature-1"><i class="fa fa-check"></i>Strict signature</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="measurement-error-models.html"><a href="measurement-error-models.html"><i class="fa fa-check"></i><b>13.4</b> Measurement error models</a>
<ul>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#simulating-noisy-measurements"><i class="fa fa-check"></i>Simulating noisy measurements</a></li>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#estimating-system-parameters-and-initial-state"><i class="fa fa-check"></i>Estimating system parameters and initial state</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="stiff-ode.html"><a href="stiff-ode.html"><i class="fa fa-check"></i><b>13.5</b> Stiff ODEs</a></li>
<li class="chapter" data-level="13.6" data-path="control-ode.html"><a href="control-ode.html"><i class="fa fa-check"></i><b>13.6</b> Control parameters for ODE solving</a>
<ul>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#discontinuous-ode-system-function"><i class="fa fa-check"></i>Discontinuous ODE system function</a></li>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#tolerance-1"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="control-ode.html"><a href="control-ode.html#maximum-number-of-steps-1"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="adjoint-ode.html"><a href="adjoint-ode.html"><i class="fa fa-check"></i><b>13.7</b> Adjoint ODE solver</a></li>
<li class="chapter" data-level="13.8" data-path="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><a href="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><i class="fa fa-check"></i><b>13.8</b> Solving a system of linear ODEs using a matrix exponential</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="integrate-1d.html"><a href="integrate-1d.html"><i class="fa fa-check"></i><b>14</b> Computing One Dimensional Integrals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html"><i class="fa fa-check"></i><b>14.1</b> Calling the integrator</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#limits-of-integration"><i class="fa fa-check"></i><b>14.1.1</b> Limits of integration</a></li>
<li class="chapter" data-level="14.1.2" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#data-vs.-parameters"><i class="fa fa-check"></i><b>14.1.2</b> Data vs. parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html"><i class="fa fa-check"></i><b>14.2</b> Integrator convergence</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="integrator-convergence.html"><a href="integrator-convergence.html#zero-crossing"><i class="fa fa-check"></i><b>14.2.1</b> Zero-crossing integrals</a></li>
<li class="chapter" data-level="14.2.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html#integral-precision"><i class="fa fa-check"></i><b>14.2.2</b> Avoiding precision loss near limits of integration in definite integrals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="complex-numbers.html"><a href="complex-numbers.html"><i class="fa fa-check"></i><b>15</b> Complex Numbers</a>
<ul>
<li class="chapter" data-level="15.1" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html"><i class="fa fa-check"></i><b>15.1</b> Working with complex numbers</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#constructing-and-accessing-complex-numbers"><i class="fa fa-check"></i><b>15.1.1</b> Constructing and accessing complex numbers</a></li>
<li class="chapter" data-level="15.1.2" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-assignment-and-promotion"><i class="fa fa-check"></i><b>15.1.2</b> Complex assignment and promotion</a></li>
<li class="chapter" data-level="15.1.3" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-arrays"><i class="fa fa-check"></i><b>15.1.3</b> Complex arrays</a></li>
<li class="chapter" data-level="15.1.4" data-path="working-with-complex-numbers.html"><a href="working-with-complex-numbers.html#complex-functions"><i class="fa fa-check"></i><b>15.1.4</b> Complex functions</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="complex-random-variables.html"><a href="complex-random-variables.html"><i class="fa fa-check"></i><b>15.2</b> Complex random variables</a></li>
<li class="chapter" data-level="15.3" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html"><i class="fa fa-check"></i><b>15.3</b> Complex linear regression</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html#independent-real-and-imaginary-error"><i class="fa fa-check"></i><b>15.3.1</b> Independent real and imaginary error</a></li>
<li class="chapter" data-level="15.3.2" data-path="complex-linear-regression.html"><a href="complex-linear-regression.html#dependent-complex-error"><i class="fa fa-check"></i><b>15.3.2</b> Dependent complex error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dae-solver.html"><a href="dae-solver.html"><i class="fa fa-check"></i><b>16</b> Differential-Algebraic Equations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="notation-1.html"><a href="notation-1.html"><i class="fa fa-check"></i><b>16.1</b> Notation</a></li>
<li class="chapter" data-level="16.2" data-path="example-chemical-kinetics.html"><a href="example-chemical-kinetics.html"><i class="fa fa-check"></i><b>16.2</b> Example: chemical kinetics</a></li>
<li class="chapter" data-level="16.3" data-path="index-of-daes.html"><a href="index-of-daes.html"><i class="fa fa-check"></i><b>16.3</b> Index of DAEs</a></li>
<li class="chapter" data-level="16.4" data-path="coding-the-dae-system-function.html"><a href="coding-the-dae-system-function.html"><i class="fa fa-check"></i><b>16.4</b> Coding the DAE system function</a>
<ul>
<li class="chapter" data-level="" data-path="coding-the-dae-system-function.html"><a href="coding-the-dae-system-function.html#strict-signature-2"><i class="fa fa-check"></i>Strict signature</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="solving-daes.html"><a href="solving-daes.html"><i class="fa fa-check"></i><b>16.5</b> Solving DAEs</a></li>
<li class="chapter" data-level="16.6" data-path="control-dae.html"><a href="control-dae.html"><i class="fa fa-check"></i><b>16.6</b> Control parameters for DAE solving</a>
<ul>
<li class="chapter" data-level="" data-path="control-dae.html"><a href="control-dae.html#maximum-number-of-steps-2"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
</ul></li>
<li><a href="part-2.-programming-techniques.html#part-2.-programming-techniques"><i style="font-size: 110%; color:#990017;">Part 2. Programming Techniques</i></a></li>
<li class="chapter" data-level="17" data-path="floating-point-arithmetic.html"><a href="floating-point-arithmetic.html"><i class="fa fa-check"></i><b>17</b> Floating Point Arithmetic</a>
<ul>
<li class="chapter" data-level="17.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html"><i class="fa fa-check"></i><b>17.1</b> Floating-point representations</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html#finite-values"><i class="fa fa-check"></i><b>17.1.1</b> Finite values</a></li>
<li class="chapter" data-level="17.1.2" data-path="floating-point-representations.html"><a href="floating-point-representations.html#normality"><i class="fa fa-check"></i><b>17.1.2</b> Normality</a></li>
<li class="chapter" data-level="17.1.3" data-path="floating-point-representations.html"><a href="floating-point-representations.html#ranges-and-extreme-values"><i class="fa fa-check"></i><b>17.1.3</b> Ranges and extreme values</a></li>
<li class="chapter" data-level="17.1.4" data-path="floating-point-representations.html"><a href="floating-point-representations.html#signed-zero"><i class="fa fa-check"></i><b>17.1.4</b> Signed zero</a></li>
<li class="chapter" data-level="17.1.5" data-path="floating-point-representations.html"><a href="floating-point-representations.html#not-a-number-values"><i class="fa fa-check"></i><b>17.1.5</b> Not-a-number values</a></li>
<li class="chapter" data-level="17.1.6" data-path="floating-point-representations.html"><a href="floating-point-representations.html#positive-and-negative-infinity"><i class="fa fa-check"></i><b>17.1.6</b> Positive and negative infinity</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="literals-decimal-and-scientific-notation.html"><a href="literals-decimal-and-scientific-notation.html"><i class="fa fa-check"></i><b>17.2</b> Literals: decimal and scientific notation</a></li>
<li class="chapter" data-level="17.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html"><i class="fa fa-check"></i><b>17.3</b> Arithmetic precision</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#rounding-and-probabilities"><i class="fa fa-check"></i><b>17.3.1</b> Rounding and probabilities</a></li>
<li class="chapter" data-level="17.3.2" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#machine-precision-and-the-asymmetry-of-0-and-1"><i class="fa fa-check"></i><b>17.3.2</b> Machine precision and the asymmetry of 0 and 1</a></li>
<li class="chapter" data-level="17.3.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#complementary-and-epsilon-functions"><i class="fa fa-check"></i><b>17.3.3</b> Complementary and epsilon functions</a></li>
<li class="chapter" data-level="17.3.4" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#catastrophic-cancellation"><i class="fa fa-check"></i><b>17.3.4</b> Catastrophic cancellation</a></li>
<li class="chapter" data-level="17.3.5" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#overflow"><i class="fa fa-check"></i><b>17.3.5</b> Overflow</a></li>
<li class="chapter" data-level="17.3.6" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#underflow-and-the-log-scale"><i class="fa fa-check"></i><b>17.3.6</b> Underflow and the log scale</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html"><i class="fa fa-check"></i><b>17.4</b> Log sum of exponentials</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#log-sum-exp-function"><i class="fa fa-check"></i><b>17.4.1</b> Log-sum-exp function</a></li>
<li class="chapter" data-level="17.4.2" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#applying-log-sum-exp-to-a-sequence"><i class="fa fa-check"></i><b>17.4.2</b> Applying log-sum-exp to a sequence</a></li>
<li class="chapter" data-level="17.4.3" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#calculating-means-with-log-sum-exp"><i class="fa fa-check"></i><b>17.4.3</b> Calculating means with log-sum-exp</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="comparing-floating-point-numbers.html"><a href="comparing-floating-point-numbers.html"><i class="fa fa-check"></i><b>17.5</b> Comparing floating-point numbers</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="matrices-vectors-and-arrays.html"><a href="matrices-vectors-and-arrays.html"><i class="fa fa-check"></i><b>18</b> Matrices, Vectors, and Arrays</a>
<ul>
<li class="chapter" data-level="18.1" data-path="basic-motivation.html"><a href="basic-motivation.html"><i class="fa fa-check"></i><b>18.1</b> Basic motivation</a></li>
<li class="chapter" data-level="18.2" data-path="fixed-sizes-and-indexing-out-of-bounds.html"><a href="fixed-sizes-and-indexing-out-of-bounds.html"><i class="fa fa-check"></i><b>18.2</b> Fixed sizes and indexing out of bounds</a></li>
<li class="chapter" data-level="18.3" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html"><i class="fa fa-check"></i><b>18.3</b> Data type and indexing efficiency</a>
<ul>
<li class="chapter" data-level="" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html#matrices-vs.-two-dimensional-arrays"><i class="fa fa-check"></i>Matrices vs. two-dimensional arrays</a></li>
<li class="chapter" data-level="" data-path="indexing-efficiency.html"><a href="indexing-efficiency.html#row-vectors-vs.-one-dimensional-arrays"><i class="fa fa-check"></i>(Row) vectors vs. one-dimensional arrays</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="memory-locality.html"><a href="memory-locality.html"><i class="fa fa-check"></i><b>18.4</b> Memory locality</a>
<ul>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#memory-locality-1"><i class="fa fa-check"></i>Memory locality</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#arrays"><i class="fa fa-check"></i>Arrays</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="converting-among-matrix-vector-and-array-types.html"><a href="converting-among-matrix-vector-and-array-types.html"><i class="fa fa-check"></i><b>18.5</b> Converting among matrix, vector, and array types</a></li>
<li class="chapter" data-level="18.6" data-path="aliasing-in-stan-containers.html"><a href="aliasing-in-stan-containers.html"><i class="fa fa-check"></i><b>18.6</b> Aliasing in Stan containers</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="multi-indexing.html"><a href="multi-indexing.html"><i class="fa fa-check"></i><b>19</b> Multiple Indexing and Range Indexing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="multiple-indexing.html"><a href="multiple-indexing.html"><i class="fa fa-check"></i><b>19.1</b> Multiple indexing</a></li>
<li class="chapter" data-level="19.2" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html"><i class="fa fa-check"></i><b>19.2</b> Slicing with range indexes</a>
<ul>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-and-upper-bound-indexes"><i class="fa fa-check"></i>Lower and upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-or-upper-bound-indexes"><i class="fa fa-check"></i>Lower or upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#full-range-indexes"><i class="fa fa-check"></i>Full range indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#slicing-functions"><i class="fa fa-check"></i>Slicing functions</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html"><i class="fa fa-check"></i><b>19.3</b> Multiple indexing on the left of assignments</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html#assign-by-value-and-aliasing"><i class="fa fa-check"></i>Assign-by-value and aliasing</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html"><i class="fa fa-check"></i><b>19.4</b> Multiple indexes with vectors and matrices</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-1"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-with-one-multiple-index"><i class="fa fa-check"></i>Matrices with one multiple index</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#arrays-of-vectors-or-matrices"><i class="fa fa-check"></i>Arrays of vectors or matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#block-row-and-column-extraction-for-matrices"><i class="fa fa-check"></i>Block, row, and column extraction for matrices</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="matrices-with-parameters-and-constants.html"><a href="matrices-with-parameters-and-constants.html"><i class="fa fa-check"></i><b>19.5</b> Matrices with parameters and constants</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="functions-programming.html"><a href="functions-programming.html"><i class="fa fa-check"></i><b>20</b> User-Defined Functions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="basic-functions.html"><a href="basic-functions.html"><i class="fa fa-check"></i><b>20.1</b> Basic functions</a>
<ul>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#user-defined-functions-block"><i class="fa fa-check"></i>User-defined functions block</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#function-bodies"><i class="fa fa-check"></i>Function bodies</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#return-statements"><i class="fa fa-check"></i>Return statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#reject-statements"><i class="fa fa-check"></i>Reject statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#type-declarations-for-functions"><i class="fa fa-check"></i>Type declarations for functions</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#array-types-for-function-declarations"><i class="fa fa-check"></i>Array types for function declarations</a></li>
<li class="chapter" data-level="" data-path="basic-functions.html"><a href="basic-functions.html#data-only-function-arguments"><i class="fa fa-check"></i>Data-only function arguments</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="functions-as-statements.html"><a href="functions-as-statements.html"><i class="fa fa-check"></i><b>20.2</b> Functions as statements</a></li>
<li class="chapter" data-level="20.3" data-path="user-defined-probability-functions.html"><a href="user-defined-probability-functions.html"><i class="fa fa-check"></i><b>20.3</b> User-defined probability functions</a></li>
<li class="chapter" data-level="20.4" data-path="overloading-functions.html"><a href="overloading-functions.html"><i class="fa fa-check"></i><b>20.4</b> Overloading functions</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="overloading-functions.html"><a href="overloading-functions.html#warning-on-usage"><i class="fa fa-check"></i><b>20.4.1</b> Warning on usage</a></li>
<li class="chapter" data-level="20.4.2" data-path="overloading-functions.html"><a href="overloading-functions.html#function-resolution"><i class="fa fa-check"></i><b>20.4.2</b> Function resolution</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="documenting-functions.html"><a href="documenting-functions.html"><i class="fa fa-check"></i><b>20.5</b> Documenting functions</a></li>
<li class="chapter" data-level="20.6" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html"><i class="fa fa-check"></i><b>20.6</b> Summary of function types</a>
<ul>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#void-vs.-non-void-return"><i class="fa fa-check"></i>Void vs. non-void return</a></li>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#suffixed-or-non-suffixed"><i class="fa fa-check"></i>Suffixed or non-suffixed</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="recursive-functions.html"><a href="recursive-functions.html"><i class="fa fa-check"></i><b>20.7</b> Recursive functions</a></li>
<li class="chapter" data-level="20.8" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html"><i class="fa fa-check"></i><b>20.8</b> Truncated random number generation</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#generation-with-inverse-cdfs"><i class="fa fa-check"></i>Generation with inverse CDFs</a></li>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#truncated-variate-generation"><i class="fa fa-check"></i>Truncated variate generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="custom-probability-functions.html"><a href="custom-probability-functions.html"><i class="fa fa-check"></i><b>21</b> Custom Probability Functions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>21.1</b> Examples</a>
<ul>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#triangle-distribution"><i class="fa fa-check"></i>Triangle distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#bivariate-normal-cumulative-distribution-function"><i class="fa fa-check"></i>Bivariate normal cumulative distribution function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="proportionality-constants.html"><a href="proportionality-constants.html"><i class="fa fa-check"></i><b>22</b> Proportionality Constants</a>
<ul>
<li class="chapter" data-level="22.1" data-path="dropping-proportionality-constants.html"><a href="dropping-proportionality-constants.html"><i class="fa fa-check"></i><b>22.1</b> Dropping Proportionality Constants</a></li>
<li class="chapter" data-level="22.2" data-path="keeping-proportionality-constants.html"><a href="keeping-proportionality-constants.html"><i class="fa fa-check"></i><b>22.2</b> Keeping Proportionality Constants</a></li>
<li class="chapter" data-level="22.3" data-path="user-defined-distributions.html"><a href="user-defined-distributions.html"><i class="fa fa-check"></i><b>22.3</b> User-defined Distributions</a></li>
<li class="chapter" data-level="22.4" data-path="limitations-on-using-_lupdf-and-_lupmf-functions.html"><a href="limitations-on-using-_lupdf-and-_lupmf-functions.html"><i class="fa fa-check"></i><b>22.4</b> Limitations on Using <code>_lupdf</code> and <code>_lupmf</code> Functions</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="problematic-posteriors.html"><a href="problematic-posteriors.html"><i class="fa fa-check"></i><b>23</b> Problematic Posteriors</a>
<ul>
<li class="chapter" data-level="23.1" data-path="collinearity.html"><a href="collinearity.html"><i class="fa fa-check"></i><b>23.1</b> Collinearity of predictors in regressions</a>
<ul>
<li class="chapter" data-level="" data-path="collinearity.html"><a href="collinearity.html#examples-of-collinearity"><i class="fa fa-check"></i>Examples of collinearity</a></li>
<li class="chapter" data-level="" data-path="collinearity.html"><a href="collinearity.html#mitigating-the-invariances"><i class="fa fa-check"></i>Mitigating the invariances</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html"><i class="fa fa-check"></i><b>23.2</b> Label switching in mixture models</a>
<ul>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#mixture-models"><i class="fa fa-check"></i>Mixture models</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#convergence-monitoring-and-effective-sample-size"><i class="fa fa-check"></i>Convergence monitoring and effective sample size</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#some-inferences-are-invariant"><i class="fa fa-check"></i>Some inferences are invariant</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#highly-multimodal-posteriors"><i class="fa fa-check"></i>Highly multimodal posteriors</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic.html"><a href="label-switching-problematic.html#hacks-as-fixes"><i class="fa fa-check"></i>Hacks as fixes</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="component-collapsing-in-mixture-models.html"><a href="component-collapsing-in-mixture-models.html"><i class="fa fa-check"></i><b>23.3</b> Component collapsing in mixture models</a></li>
<li class="chapter" data-level="23.4" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html"><i class="fa fa-check"></i><b>23.4</b> Posteriors with unbounded densities</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#mixture-models-with-varying-scales"><i class="fa fa-check"></i>Mixture models with varying scales</a></li>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#beta-binomial-models-with-skewed-data-and-weak-priors"><i class="fa fa-check"></i>Beta-binomial models with skewed data and weak priors</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html"><i class="fa fa-check"></i><b>23.5</b> Posteriors with unbounded parameters</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html#separability-in-logistic-regression"><i class="fa fa-check"></i>Separability in logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="uniform-posteriors.html"><a href="uniform-posteriors.html"><i class="fa fa-check"></i><b>23.6</b> Uniform posteriors</a></li>
<li class="chapter" data-level="23.7" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html"><i class="fa fa-check"></i><b>23.7</b> Sampling difficulties with problematic priors</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#gibbs-sampling"><i class="fa fa-check"></i>Gibbs sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#hamiltonian-monte-carlo-sampling"><i class="fa fa-check"></i>Hamiltonian Monte Carlo sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#no-u-turn-sampling"><i class="fa fa-check"></i>No-U-turn sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#examples-fits-in-stan"><i class="fa fa-check"></i>Examples: fits in Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="change-of-variables.html"><a href="change-of-variables.html"><i class="fa fa-check"></i><b>24</b> Reparameterization and Change of Variables</a>
<ul>
<li class="chapter" data-level="24.1" data-path="theoretical-and-practical-background.html"><a href="theoretical-and-practical-background.html"><i class="fa fa-check"></i><b>24.1</b> Theoretical and practical background</a></li>
<li class="chapter" data-level="24.2" data-path="reparameterizations.html"><a href="reparameterizations.html"><i class="fa fa-check"></i><b>24.2</b> Reparameterizations</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#beta-and-dirichlet-priors"><i class="fa fa-check"></i>Beta and Dirichlet priors</a></li>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#transforming-unconstrained-priors-probit-and-logit"><i class="fa fa-check"></i>Transforming unconstrained priors: probit and logit</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="changes-of-variables.html"><a href="changes-of-variables.html"><i class="fa fa-check"></i><b>24.3</b> Changes of variables</a>
<ul>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#change-of-variables-vs.-transformations"><i class="fa fa-check"></i>Change of variables vs. transformations</a></li>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#multivariate-changes-of-variables"><i class="fa fa-check"></i>Multivariate changes of variables</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html"><i class="fa fa-check"></i><b>24.4</b> Vectors with varying bounds</a>
<ul>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-lower-bounds"><i class="fa fa-check"></i>Varying lower bounds</a></li>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-upper-and-lower-bounds"><i class="fa fa-check"></i>Varying upper and lower bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>25</b> Efficiency Tuning</a>
<ul>
<li class="chapter" data-level="25.1" data-path="what-is-efficiency.html"><a href="what-is-efficiency.html"><i class="fa fa-check"></i><b>25.1</b> What is efficiency?</a></li>
<li class="chapter" data-level="25.2" data-path="efficiency-for-probabilistic-models-and-algorithms.html"><a href="efficiency-for-probabilistic-models-and-algorithms.html"><i class="fa fa-check"></i><b>25.2</b> Efficiency for probabilistic models and algorithms</a></li>
<li class="chapter" data-level="25.3" data-path="statistical-vs.-computational-efficiency.html"><a href="statistical-vs.-computational-efficiency.html"><i class="fa fa-check"></i><b>25.3</b> Statistical vs.  computational efficiency</a></li>
<li class="chapter" data-level="25.4" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html"><i class="fa fa-check"></i><b>25.4</b> Model conditioning and curvature</a>
<ul>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#condition-number-and-adaptation"><i class="fa fa-check"></i>Condition number and adaptation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#unit-scales-without-correlation"><i class="fa fa-check"></i>Unit scales without correlation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#varying-curvature"><i class="fa fa-check"></i>Varying curvature</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#reparameterizing-with-a-change-of-variables"><i class="fa fa-check"></i>Reparameterizing with a change of variables</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="well-specified-models.html"><a href="well-specified-models.html"><i class="fa fa-check"></i><b>25.5</b> Well-specified models</a></li>
<li class="chapter" data-level="25.6" data-path="avoiding-validation.html"><a href="avoiding-validation.html"><i class="fa fa-check"></i><b>25.6</b> Avoiding validation</a></li>
<li class="chapter" data-level="25.7" data-path="reparameterization.html"><a href="reparameterization.html"><i class="fa fa-check"></i><b>25.7</b> Reparameterization</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#funnel.figure"><i class="fa fa-check"></i>Example: Neal’s funnel</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#reparameterizing-the-cauchy"><i class="fa fa-check"></i>Reparameterizing the Cauchy</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#reparameterizing-a-student-t-distribution"><i class="fa fa-check"></i>Reparameterizing a Student-t distribution</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#hierarchical-models-and-the-non-centered-parameterization"><i class="fa fa-check"></i>Hierarchical models and the non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#non-centered-parameterization"><i class="fa fa-check"></i>Non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization.html"><a href="reparameterization.html#multivariate-reparameterizations"><i class="fa fa-check"></i>Multivariate reparameterizations</a></li>
</ul></li>
<li class="chapter" data-level="25.8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>25.8</b> Vectorization</a>
<ul>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#gradient-bottleneck"><i class="fa fa-check"></i>Gradient bottleneck</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorizing-summations"><i class="fa fa-check"></i>Vectorizing summations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorization-through-matrix-operations"><i class="fa fa-check"></i>Vectorization through matrix operations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorized-probability-functions"><i class="fa fa-check"></i>Vectorized probability functions</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#reshaping-data-for-vectorization"><i class="fa fa-check"></i>Reshaping data for vectorization</a></li>
</ul></li>
<li class="chapter" data-level="25.9" data-path="exploiting-sufficient-statistics.html"><a href="exploiting-sufficient-statistics.html"><i class="fa fa-check"></i><b>25.9</b> Exploiting sufficient statistics</a></li>
<li class="chapter" data-level="25.10" data-path="aggregating-common-subexpressions.html"><a href="aggregating-common-subexpressions.html"><i class="fa fa-check"></i><b>25.10</b> Aggregating common subexpressions</a></li>
<li class="chapter" data-level="25.11" data-path="exploiting-conjugacy.html"><a href="exploiting-conjugacy.html"><i class="fa fa-check"></i><b>25.11</b> Exploiting conjugacy</a></li>
<li class="chapter" data-level="25.12" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html"><i class="fa fa-check"></i><b>25.12</b> Standardizing predictors and outputs</a>
<ul>
<li class="chapter" data-level="" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html#standard-normal-distribution"><i class="fa fa-check"></i>Standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="25.13" data-path="using-map-reduce.html"><a href="using-map-reduce.html"><i class="fa fa-check"></i><b>25.13</b> Using map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>26</b> Parallelization</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reduce-sum.html"><a href="reduce-sum.html"><i class="fa fa-check"></i><b>26.1</b> Reduce-sum</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reduce-sum.html"><a href="reduce-sum.html#example-logistic-regression"><i class="fa fa-check"></i><b>26.1.1</b> Example: logistic regression</a></li>
<li class="chapter" data-level="26.1.2" data-path="reduce-sum.html"><a href="reduce-sum.html#reduce-sum-grainsize"><i class="fa fa-check"></i><b>26.1.2</b> Picking the grainsize</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="map-rect.html"><a href="map-rect.html"><i class="fa fa-check"></i><b>26.2</b> Map-rect</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="map-rect.html"><a href="map-rect.html#map-function"><i class="fa fa-check"></i><b>26.2.1</b> Map function</a></li>
<li class="chapter" data-level="" data-path="map-rect.html"><a href="map-rect.html#map-function-signature"><i class="fa fa-check"></i>Map function signature</a></li>
<li class="chapter" data-level="26.2.2" data-path="map-rect.html"><a href="map-rect.html#example-logistic-regression-1"><i class="fa fa-check"></i><b>26.2.2</b> Example: logistic regression</a></li>
<li class="chapter" data-level="26.2.3" data-path="map-rect.html"><a href="map-rect.html#example-hierarchical-logistic-regression"><i class="fa fa-check"></i><b>26.2.3</b> Example: hierarchical logistic regression</a></li>
<li class="chapter" data-level="26.2.4" data-path="map-rect.html"><a href="map-rect.html#ragged-inputs-and-outputs"><i class="fa fa-check"></i><b>26.2.4</b> Ragged inputs and outputs</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="opencl.html"><a href="opencl.html"><i class="fa fa-check"></i><b>26.3</b> OpenCL</a></li>
</ul></li>
<li><a href="meta-models.html#meta-models.part"><i style="font-size: 110%; color:#990017;">Part 3. Posterior Inference &amp; Model Checking</i></a></li>
<li class="chapter" data-level="27" data-path="posterior-prediction.html"><a href="posterior-prediction.html"><i class="fa fa-check"></i><b>27</b> Posterior Predictive Sampling</a>
<ul>
<li class="chapter" data-level="27.1" data-path="posterior-predictive-distribution.html"><a href="posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.1</b> Posterior predictive distribution</a></li>
<li class="chapter" data-level="27.2" data-path="computing-the-posterior-predictive-distribution.html"><a href="computing-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.2</b> Computing the posterior predictive distribution</a></li>
<li class="chapter" data-level="27.3" data-path="sampling-from-the-posterior-predictive-distribution.html"><a href="sampling-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>27.3</b> Sampling from the posterior predictive distribution</a></li>
<li class="chapter" data-level="27.4" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html"><i class="fa fa-check"></i><b>27.4</b> Posterior predictive simulation in Stan</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#simple-poisson-model"><i class="fa fa-check"></i><b>27.4.1</b> Simple Poisson model</a></li>
<li class="chapter" data-level="27.4.2" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#stan-code"><i class="fa fa-check"></i><b>27.4.2</b> Stan code</a></li>
<li class="chapter" data-level="27.4.3" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#analytic-posterior-and-posterior-predictive"><i class="fa fa-check"></i><b>27.4.3</b> Analytic posterior and posterior predictive</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html"><i class="fa fa-check"></i><b>27.5</b> Posterior prediction for regressions</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#posterior-predictive-distributions-for-regressions"><i class="fa fa-check"></i><b>27.5.1</b> Posterior predictive distributions for regressions</a></li>
<li class="chapter" data-level="27.5.2" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#stan-program"><i class="fa fa-check"></i><b>27.5.2</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="estimating-event-probabilities.html"><a href="estimating-event-probabilities.html"><i class="fa fa-check"></i><b>27.6</b> Estimating event probabilities</a></li>
<li class="chapter" data-level="27.7" data-path="stand-alone-generated-quantities-and-ongoing-prediction.html"><a href="stand-alone-generated-quantities-and-ongoing-prediction.html"><i class="fa fa-check"></i><b>27.7</b> Stand-alone generated quantities and ongoing prediction</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="simulation-based-calibration.html"><a href="simulation-based-calibration.html"><i class="fa fa-check"></i><b>28</b> Simulation-Based Calibration</a>
<ul>
<li class="chapter" data-level="28.1" data-path="bayes-is-calibrated-by-construction.html"><a href="bayes-is-calibrated-by-construction.html"><i class="fa fa-check"></i><b>28.1</b> Bayes is calibrated by construction</a></li>
<li class="chapter" data-level="28.2" data-path="simulation-based-calibration-1.html"><a href="simulation-based-calibration-1.html"><i class="fa fa-check"></i><b>28.2</b> Simulation-based calibration</a></li>
<li class="chapter" data-level="28.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html"><i class="fa fa-check"></i><b>28.3</b> SBC in Stan</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#example-model"><i class="fa fa-check"></i><b>28.3.1</b> Example model</a></li>
<li class="chapter" data-level="28.3.2" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#testing-a-stan-program-with-simulation-based-calibration"><i class="fa fa-check"></i><b>28.3.2</b> Testing a Stan program with simulation-based calibration</a></li>
<li class="chapter" data-level="28.3.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#pseudocode-for-simulation-based-calibration"><i class="fa fa-check"></i><b>28.3.3</b> Pseudocode for simulation-based calibration</a></li>
<li class="chapter" data-level="28.3.4" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#the-importance-of-thinning"><i class="fa fa-check"></i><b>28.3.4</b> The importance of thinning</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="testing-uniformity.html"><a href="testing-uniformity.html"><i class="fa fa-check"></i><b>28.4</b> Testing uniformity</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="testing-uniformity.html"><a href="testing-uniformity.html#indexing-to-simplify-arithmetic"><i class="fa fa-check"></i><b>28.4.1</b> Indexing to simplify arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html"><i class="fa fa-check"></i><b>28.5</b> Examples of simulation-based calibration</a>
<ul>
<li class="chapter" data-level="28.5.1" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-right"><i class="fa fa-check"></i><b>28.5.1</b> When things go right</a></li>
<li class="chapter" data-level="28.5.2" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-wrong"><i class="fa fa-check"></i><b>28.5.2</b> When things go wrong</a></li>
<li class="chapter" data-level="28.5.3" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-stans-sampler-goes-wrong"><i class="fa fa-check"></i><b>28.5.3</b> When Stan’s sampler goes wrong</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ppcs.html"><a href="ppcs.html"><i class="fa fa-check"></i><b>29</b> Posterior and Prior Predictive Checks</a>
<ul>
<li class="chapter" data-level="29.1" data-path="simulating-from-the-posterior-predictive-distribution.html"><a href="simulating-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>29.1</b> Simulating from the posterior predictive distribution</a></li>
<li class="chapter" data-level="29.2" data-path="plotting-multiples.html"><a href="plotting-multiples.html"><i class="fa fa-check"></i><b>29.2</b> Plotting multiples</a></li>
<li class="chapter" data-level="29.3" data-path="posterior-p-values.html"><a href="posterior-p-values.html"><i class="fa fa-check"></i><b>29.3</b> Posterior ``p-values’’</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="posterior-p-values.html"><a href="posterior-p-values.html#which-statistics-to-test"><i class="fa fa-check"></i><b>29.3.1</b> Which statistics to test?</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html"><i class="fa fa-check"></i><b>29.4</b> Prior predictive checks</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html#coding-prior-predictive-checks-in-stan"><i class="fa fa-check"></i><b>29.4.1</b> Coding prior predictive checks in Stan</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="example-of-prior-predictive-checks.html"><a href="example-of-prior-predictive-checks.html"><i class="fa fa-check"></i><b>29.5</b> Example of prior predictive checks</a></li>
<li class="chapter" data-level="29.6" data-path="mixed-replication.html"><a href="mixed-replication.html"><i class="fa fa-check"></i><b>29.6</b> Mixed predictive replication for hierarchical models</a></li>
<li class="chapter" data-level="29.7" data-path="joint-model-representation.html"><a href="joint-model-representation.html"><i class="fa fa-check"></i><b>29.7</b> Joint model representation</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="joint-model-representation.html"><a href="joint-model-representation.html#posterior-predictive-model"><i class="fa fa-check"></i><b>29.7.1</b> Posterior predictive model</a></li>
<li class="chapter" data-level="29.7.2" data-path="joint-model-representation.html"><a href="joint-model-representation.html#prior-predictive-model"><i class="fa fa-check"></i><b>29.7.2</b> Prior predictive model</a></li>
<li class="chapter" data-level="29.7.3" data-path="joint-model-representation.html"><a href="joint-model-representation.html#mixed-replication-for-hierarchical-models"><i class="fa fa-check"></i><b>29.7.3</b> Mixed replication for hierarchical models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="held-out-evaluation-and-cross-validation.html"><a href="held-out-evaluation-and-cross-validation.html"><i class="fa fa-check"></i><b>30</b> Held-Out Evaluation and Cross-Validation</a>
<ul>
<li class="chapter" data-level="30.1" data-path="evaluating-posterior-predictive.html"><a href="evaluating-posterior-predictive.html"><i class="fa fa-check"></i><b>30.1</b> Evaluating posterior predictive densities</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="evaluating-posterior-predictive.html"><a href="evaluating-posterior-predictive.html#stan-program-1"><i class="fa fa-check"></i><b>30.1.1</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="estimation-error.html"><a href="estimation-error.html"><i class="fa fa-check"></i><b>30.2</b> Estimation error</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="estimation-error.html"><a href="estimation-error.html#parameter-estimates"><i class="fa fa-check"></i><b>30.2.1</b> Parameter estimates</a></li>
<li class="chapter" data-level="30.2.2" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates"><i class="fa fa-check"></i><b>30.2.2</b> Predictive estimates</a></li>
<li class="chapter" data-level="30.2.3" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates-in-stan"><i class="fa fa-check"></i><b>30.2.3</b> Predictive estimates in Stan</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>30.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="cross-validation.html"><a href="cross-validation.html#stan-implementation-with-random-folds"><i class="fa fa-check"></i><b>30.3.1</b> Stan implementation with random folds</a></li>
<li class="chapter" data-level="30.3.2" data-path="cross-validation.html"><a href="cross-validation.html#user-defined-permutations"><i class="fa fa-check"></i><b>30.3.2</b> User-defined permutations</a></li>
<li class="chapter" data-level="30.3.3" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-structured-data"><i class="fa fa-check"></i><b>30.3.3</b> Cross-validation with structured data</a></li>
<li class="chapter" data-level="30.3.4" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-spatio-temporal-data"><i class="fa fa-check"></i><b>30.3.4</b> Cross-validation with spatio-temporal data</a></li>
<li class="chapter" data-level="30.3.5" data-path="cross-validation.html"><a href="cross-validation.html#approximate-cross-validation"><i class="fa fa-check"></i><b>30.3.5</b> Approximate cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="poststratification.html"><a href="poststratification.html"><i class="fa fa-check"></i><b>31</b> Poststratification</a>
<ul>
<li class="chapter" data-level="31.1" data-path="some-examples.html"><a href="some-examples.html"><i class="fa fa-check"></i><b>31.1</b> Some examples</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="some-examples.html"><a href="some-examples.html#earth-science"><i class="fa fa-check"></i><b>31.1.1</b> Earth science</a></li>
<li class="chapter" data-level="31.1.2" data-path="some-examples.html"><a href="some-examples.html#polling"><i class="fa fa-check"></i><b>31.1.2</b> Polling</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="bayesian-poststratification.html"><a href="bayesian-poststratification.html"><i class="fa fa-check"></i><b>31.2</b> Bayesian poststratification</a></li>
<li class="chapter" data-level="31.3" data-path="poststratification-in-stan.html"><a href="poststratification-in-stan.html"><i class="fa fa-check"></i><b>31.3</b> Poststratification in Stan</a></li>
<li class="chapter" data-level="31.4" data-path="regression-and-poststratification.html"><a href="regression-and-poststratification.html"><i class="fa fa-check"></i><b>31.4</b> Regression and poststratification</a></li>
<li class="chapter" data-level="31.5" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>31.5</b> Multilevel regression and poststratification</a>
<ul>
<li class="chapter" data-level="31.5.1" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html#dealing-with-small-partitions-and-non-identifiability"><i class="fa fa-check"></i><b>31.5.1</b> Dealing with small partitions and non-identifiability</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html"><i class="fa fa-check"></i><b>31.6</b> Coding MRP in Stan</a>
<ul>
<li class="chapter" data-level="31.6.1" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#binomial-coding"><i class="fa fa-check"></i><b>31.6.1</b> Binomial coding</a></li>
<li class="chapter" data-level="31.6.2" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#coding-binary-groups"><i class="fa fa-check"></i><b>31.6.2</b> Coding binary groups</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="adding-group-level-predictors.html"><a href="adding-group-level-predictors.html"><i class="fa fa-check"></i><b>31.7</b> Adding group-level predictors</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="decision-analysis.html"><a href="decision-analysis.html"><i class="fa fa-check"></i><b>32</b> Decision Analysis</a>
<ul>
<li class="chapter" data-level="32.1" data-path="outline-of-decision-analysis.html"><a href="outline-of-decision-analysis.html"><i class="fa fa-check"></i><b>32.1</b> Outline of decision analysis</a></li>
<li class="chapter" data-level="32.2" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html"><i class="fa fa-check"></i><b>32.2</b> Example decision analysis</a>
<ul>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-1.-define-decisions-and-outcomes"><i class="fa fa-check"></i>Step 1. Define decisions and outcomes</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-2.-define-density-of-outcome-conditioned-on-decision"><i class="fa fa-check"></i>Step 2. Define density of outcome conditioned on decision</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-3.-define-the-utility-function"><i class="fa fa-check"></i>Step 3. Define the utility function</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-4.-maximize-expected-utility"><i class="fa fa-check"></i>Step 4. Maximize expected utility</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="continuous-choices.html"><a href="continuous-choices.html"><i class="fa fa-check"></i><b>32.3</b> Continuous choices</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="the-bootstrap-and-bagging.html"><a href="the-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>33</b> The Bootstrap and Bagging</a>
<ul>
<li class="chapter" data-level="33.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>33.1</b> The bootstrap</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html#estimators"><i class="fa fa-check"></i><b>33.1.1</b> Estimators</a></li>
<li class="chapter" data-level="33.1.2" data-path="the-bootstrap.html"><a href="the-bootstrap.html#the-bootstrap-in-pseudocode"><i class="fa fa-check"></i><b>33.1.2</b> The bootstrap in pseudocode</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="coding-the-bootstrap-in-stan.html"><a href="coding-the-bootstrap-in-stan.html"><i class="fa fa-check"></i><b>33.2</b> Coding the bootstrap in Stan</a></li>
<li class="chapter" data-level="33.3" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html"><i class="fa fa-check"></i><b>33.3</b> Error statistics from the bootstrap</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#standard-errors"><i class="fa fa-check"></i><b>33.3.1</b> Standard errors</a></li>
<li class="chapter" data-level="33.3.2" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#confidence-intervals"><i class="fa fa-check"></i><b>33.3.2</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>33.4</b> Bagging</a></li>
<li class="chapter" data-level="33.5" data-path="bayesian-bootstrap-and-bagging.html"><a href="bayesian-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>33.5</b> Bayesian bootstrap and bagging</a></li>
</ul></li>
<li><a href="appendices.html#appendices.part"><i style="font-size: 110%; color:#990017;">Appendices</i></a></li>
<li class="chapter" data-level="34" data-path="using-the-stan-compiler.html"><a href="using-the-stan-compiler.html"><i class="fa fa-check"></i><b>34</b> Using the Stan Compiler</a>
<ul>
<li class="chapter" data-level="34.1" data-path="stanc-args.html"><a href="stanc-args.html"><i class="fa fa-check"></i><b>34.1</b> Command-line options for stanc3</a></li>
<li class="chapter" data-level="34.2" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html"><i class="fa fa-check"></i><b>34.2</b> Understanding stanc3 errors and warnings</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html#warnings"><i class="fa fa-check"></i><b>34.2.1</b> Warnings</a></li>
<li class="chapter" data-level="34.2.2" data-path="understanding-stanc3-errors-and-warnings.html"><a href="understanding-stanc3-errors-and-warnings.html#errors"><i class="fa fa-check"></i><b>34.2.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="pedantic-mode.html"><a href="pedantic-mode.html"><i class="fa fa-check"></i><b>34.3</b> Pedantic mode</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="pedantic-mode.html"><a href="pedantic-mode.html#distribution-argument-and-variate-constraint-issues"><i class="fa fa-check"></i><b>34.3.1</b> Distribution argument and variate constraint issues</a></li>
<li class="chapter" data-level="34.3.2" data-path="pedantic-mode.html"><a href="pedantic-mode.html#special-case-distribution-issues"><i class="fa fa-check"></i><b>34.3.2</b> Special-case distribution issues</a></li>
<li class="chapter" data-level="34.3.3" data-path="pedantic-mode.html"><a href="pedantic-mode.html#unused-parameters"><i class="fa fa-check"></i><b>34.3.3</b> Unused parameters</a></li>
<li class="chapter" data-level="34.3.4" data-path="pedantic-mode.html"><a href="pedantic-mode.html#large-or-small-constants-in-a-distribution"><i class="fa fa-check"></i><b>34.3.4</b> Large or small constants in a distribution</a></li>
<li class="chapter" data-level="34.3.5" data-path="pedantic-mode.html"><a href="pedantic-mode.html#control-flow-depends-on-a-parameter"><i class="fa fa-check"></i><b>34.3.5</b> Control flow depends on a parameter</a></li>
<li class="chapter" data-level="34.3.6" data-path="pedantic-mode.html"><a href="pedantic-mode.html#parameters-with-multiple-tildes"><i class="fa fa-check"></i><b>34.3.6</b> Parameters with multiple tildes</a></li>
<li class="chapter" data-level="34.3.7" data-path="pedantic-mode.html"><a href="pedantic-mode.html#parameters-with-zero-or-multiple-priors"><i class="fa fa-check"></i><b>34.3.7</b> Parameters with zero or multiple priors</a></li>
<li class="chapter" data-level="34.3.8" data-path="pedantic-mode.html"><a href="pedantic-mode.html#variables-used-before-assignment"><i class="fa fa-check"></i><b>34.3.8</b> Variables used before assignment</a></li>
<li class="chapter" data-level="34.3.9" data-path="pedantic-mode.html"><a href="pedantic-mode.html#strict-or-nonsensical-parameter-bounds"><i class="fa fa-check"></i><b>34.3.9</b> Strict or nonsensical parameter bounds</a></li>
<li class="chapter" data-level="34.3.10" data-path="pedantic-mode.html"><a href="pedantic-mode.html#pedantic-mode-limitations"><i class="fa fa-check"></i><b>34.3.10</b> Pedantic mode limitations</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html"><i class="fa fa-check"></i><b>34.4</b> Automatic updating and formatting of Stan programs</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#automatic-formatting"><i class="fa fa-check"></i><b>34.4.1</b> Automatic formatting</a></li>
<li class="chapter" data-level="34.4.2" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#canonicalizing"><i class="fa fa-check"></i><b>34.4.2</b> Canonicalizing</a></li>
<li class="chapter" data-level="34.4.3" data-path="stanc-pretty-printing.html"><a href="stanc-pretty-printing.html#known-issues"><i class="fa fa-check"></i><b>34.4.3</b> Known issues</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="optimization.html"><a href="optimization.html#optimization"><i class="fa fa-check"></i><b>34.5</b> Optimization</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="optimization.html"><a href="optimization.html#optimization-levels"><i class="fa fa-check"></i><b>34.5.1</b> Optimization levels</a></li>
<li class="chapter" data-level="34.5.2" data-path="optimization.html"><a href="optimization.html#o1-optimizations"><i class="fa fa-check"></i><b>34.5.2</b> <strong>O1</strong> Optimizations</a></li>
<li class="chapter" data-level="34.5.3" data-path="optimization.html"><a href="optimization.html#oexperimental-optimizations"><i class="fa fa-check"></i><b>34.5.3</b> <strong>Oexperimental</strong> Optimizations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="stan-program-style-guide.html"><a href="stan-program-style-guide.html"><i class="fa fa-check"></i><b>35</b> Stan Program Style Guide</a>
<ul>
<li class="chapter" data-level="35.1" data-path="choose-a-consistent-style.html"><a href="choose-a-consistent-style.html"><i class="fa fa-check"></i><b>35.1</b> Choose a consistent style</a></li>
<li class="chapter" data-level="35.2" data-path="line-length.html"><a href="line-length.html"><i class="fa fa-check"></i><b>35.2</b> Line length</a></li>
<li class="chapter" data-level="35.3" data-path="file-extensions.html"><a href="file-extensions.html"><i class="fa fa-check"></i><b>35.3</b> File extensions</a></li>
<li class="chapter" data-level="35.4" data-path="variable-naming.html"><a href="variable-naming.html"><i class="fa fa-check"></i><b>35.4</b> Variable naming</a></li>
<li class="chapter" data-level="35.5" data-path="local-variable-scope.html"><a href="local-variable-scope.html"><i class="fa fa-check"></i><b>35.5</b> Local variable scope</a></li>
<li class="chapter" data-level="35.6" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html"><i class="fa fa-check"></i><b>35.6</b> Parentheses and brackets</a>
<ul>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#braces-for-single-statement-blocks"><i class="fa fa-check"></i>Braces for single-statement blocks</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#parentheses-in-nested-operator-expressions"><i class="fa fa-check"></i>Parentheses in nested operator expressions</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#no-open-brackets-on-own-line"><i class="fa fa-check"></i>No open brackets on own line</a></li>
</ul></li>
<li class="chapter" data-level="35.7" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>35.7</b> Conditionals</a></li>
<li class="chapter" data-level="35.8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>35.8</b> Functions</a></li>
<li class="chapter" data-level="35.9" data-path="white-space.html"><a href="white-space.html"><i class="fa fa-check"></i><b>35.9</b> White space</a>
<ul>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#line-breaks-between-statements-and-declarations"><i class="fa fa-check"></i>Line breaks between statements and declarations</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-tabs"><i class="fa fa-check"></i>No tabs</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#two-character-indents"><i class="fa fa-check"></i>Two-character indents</a></li>
<li class="chapter" data-level="35.9.1" data-path="white-space.html"><a href="white-space.html#space-between-if-and-condition"><i class="fa fa-check"></i><b>35.9.1</b> Space between <code>if</code>, <code>{</code> and condition</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-space-for-function-calls"><i class="fa fa-check"></i>No space for function calls</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-around-operators"><i class="fa fa-check"></i>Spaces around operators</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-spaces-in-type-constraints"><i class="fa fa-check"></i>No spaces in type constraints</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#breaking-expressions-across-lines"><i class="fa fa-check"></i>Breaking expressions across lines</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-after-commas"><i class="fa fa-check"></i>Spaces after commas</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#unix-newlines"><i class="fa fa-check"></i>Unix newlines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="36" data-path="stan-for-bugs.html"><a href="stan-for-bugs.html"><i class="fa fa-check"></i><b>36</b> Transitioning from BUGS</a>
<ul>
<li class="chapter" data-level="36.1" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html"><i class="fa fa-check"></i><b>36.1</b> Some differences in how BUGS and Stan work</a>
<ul>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-is-interpreted-stan-is-compiled"><i class="fa fa-check"></i>BUGS is interpreted, Stan is compiled</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-performs-mcmc-updating-one-scalar-parameter-at-a-time-stan-uses-hmc-which-moves-in-the-entire-space-of-all-the-parameters-at-each-step"><i class="fa fa-check"></i>BUGS performs MCMC updating one scalar parameter at a time, Stan uses HMC which moves in the entire space of all the parameters at each step</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-tuning-during-warmup"><i class="fa fa-check"></i>Differences in tuning during warmup</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#the-stan-language-is-directly-executable-the-bugs-modeling-language-is-not"><i class="fa fa-check"></i>The Stan language is directly executable, the BUGS modeling language is not</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-statement-order"><i class="fa fa-check"></i>Differences in statement order</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#stan-computes-the-gradient-of-the-log-density-bugs-computes-the-log-density-but-not-its-gradient"><i class="fa fa-check"></i>Stan computes the gradient of the log density, BUGS computes the log density but not its gradient</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#both-bugs-and-stan-are-semi-automatic"><i class="fa fa-check"></i>Both BUGS and Stan are semi-automatic</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#licensing"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#interfaces"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#platforms"><i class="fa fa-check"></i>Platforms</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="some-differences-in-the-modeling-languages.html"><a href="some-differences-in-the-modeling-languages.html"><i class="fa fa-check"></i><b>36.2</b> Some differences in the modeling languages</a></li>
<li class="chapter" data-level="36.3" data-path="some-differences-in-the-statistical-models-that-are-allowed.html"><a href="some-differences-in-the-statistical-models-that-are-allowed.html"><i class="fa fa-check"></i><b>36.3</b> Some differences in the statistical models that are allowed</a></li>
<li class="chapter" data-level="36.4" data-path="some-differences-when-running-from-r.html"><a href="some-differences-when-running-from-r.html"><i class="fa fa-check"></i><b>36.4</b> Some differences when running from R</a></li>
<li class="chapter" data-level="36.5" data-path="the-stan-community.html"><a href="the-stan-community.html"><i class="fa fa-check"></i><b>36.5</b> The Stan community</a></li>
</ul></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div>
This is an old version, <a href="https://mc-stan.org/docs/stan-users-guide/latent-discrete.html#mark-recapture-models">view current version</a>.
</div>
<div id="mark-recapture-models" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Mark-recapture models</h2>
<p>A widely applied field method in ecology is to capture (or sight)
animals, mark them (e.g., by tagging), then release them. This
process is then repeated one or more times, and is often done for
populations on an ongoing basis. The resulting data may be used to
estimate population size.</p>
<p>The first subsection describes a simple mark-recapture model that does
not involve any latent discrete parameters. The following subsections
describes the Cormack-Jolly-Seber model, which involves latent
discrete parameters for animal death.</p>
<div id="simple-mark-recapture-model" class="section level3 unnumbered">
<h3>Simple mark-recapture model</h3>
<p>In the simplest case, a one-stage mark-recapture study produces the
following data</p>
<ul>
<li><span class="math inline">\(M\)</span> : number of animals marked in first capture,</li>
<li><span class="math inline">\(C\)</span> : number animals in second capture, and</li>
<li><span class="math inline">\(R\)</span> : number of marked animals in second capture.</li>
</ul>
<p>The estimand of interest is</p>
<ul>
<li><span class="math inline">\(N\)</span> : number of animals in the population.</li>
</ul>
<p>Despite the notation, the model will take <span class="math inline">\(N\)</span> to be a continuous
parameter; just because the population must be finite doesn’t mean the
parameter representing it must be. The parameter will be used to
produce a real-valued estimate of the population size.</p>
<p>The Lincoln-Petersen <span class="citation">(<a href="#ref-Lincoln:1930" role="doc-biblioref">Lincoln 1930</a>; <a href="#ref-Petersen:1896" role="doc-biblioref">Petersen 1896</a>)</span> method for
estimating population size is
<span class="math display">\[
\hat{N} = \frac{M C}{R}.
\]</span></p>
<p>This population estimate would arise from a probabilistic model in
which the number of recaptured animals is distributed binomially,
<span class="math display">\[
R \sim \textsf{binomial}(C, M / N)
\]</span>
given the total number of animals captured in the second round (<span class="math inline">\(C\)</span>)
with a recapture probability of <span class="math inline">\(M/N\)</span>, the fraction of the total
population <span class="math inline">\(N\)</span> marked in the first round.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb137-1"><a href="mark-recapture-models.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb137-2"><a href="mark-recapture-models.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; M;</span>
<span id="cb137-3"><a href="mark-recapture-models.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; C;</span>
<span id="cb137-4"><a href="mark-recapture-models.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=min(M, C)&gt; R;</span>
<span id="cb137-5"><a href="mark-recapture-models.html#cb137-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-6"><a href="mark-recapture-models.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb137-7"><a href="mark-recapture-models.html#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=(C - R + M)&gt; N;</span>
<span id="cb137-8"><a href="mark-recapture-models.html#cb137-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-9"><a href="mark-recapture-models.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb137-10"><a href="mark-recapture-models.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  R ~ binomial(C, M / N);</span>
<span id="cb137-11"><a href="mark-recapture-models.html#cb137-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a name="id:lincoln-petersen-model.figure"></a></p>
<p>A probabilistic formulation of the Lincoln-Petersen
estimator for population size based on data from a one-step
mark-recapture study. The lower bound on <span class="math inline">\(N\)</span> is necessary to
efficiently eliminate impossible values.</p>
<p>The probabilistic variant of the Lincoln-Petersen estimator can be
directly coded in Stan as shown in the Lincon-Petersen model figure.
The Lincoln-Petersen estimate is the maximum likelihood estimate (MLE)
for this model.</p>
<p>To ensure the MLE is the Lincoln-Petersen estimate, an improper
uniform prior for <span class="math inline">\(N\)</span> is used; this could (and should) be replaced
with a more informative prior if possible, based on knowledge of the
population under study.</p>
<p>The one tricky part of the model is the lower bound <span class="math inline">\(C - R + M\)</span> placed
on the population size <span class="math inline">\(N\)</span>. Values below this bound are impossible
because it is otherwise not possible to draw <span class="math inline">\(R\)</span> samples out of the
<span class="math inline">\(C\)</span> animals recaptured. Implementing this lower bound is necessary to
ensure sampling and optimization can be carried out in an
unconstrained manner with unbounded support for parameters on the
transformed (unconstrained) space. The lower bound in the declaration
for <span class="math inline">\(C\)</span> implies a variable transform
<span class="math inline">\(f : (C-R+M,\infty) \rightarrow (-\infty,+\infty)\)</span> defined by
<span class="math inline">\(f(N) = \log(N - (C - R + M))\)</span>; the reference manual contains full
details of all constrained parameter transforms.</p>
</div>
<div id="cormack-jolly-seber-with-discrete-parameter" class="section level3 unnumbered">
<h3>Cormack-Jolly-Seber with discrete parameter</h3>
<p>The Cormack-Jolly-Seber (CJS) model <span class="citation">(<a href="#ref-Cormack:1964" role="doc-biblioref">Cormack 1964</a>; <a href="#ref-Jolly:1965" role="doc-biblioref">Jolly 1965</a>; <a href="#ref-Seber:1965" role="doc-biblioref">Seber 1965</a>)</span>
is an open-population model in which the population may change over time
due to death; the presentation here draws heavily on <span class="citation">Schofield (<a href="#ref-Schofield:2007" role="doc-biblioref">2007</a>)</span>.</p>
<p>The basic data are</p>
<ul>
<li><span class="math inline">\(I\)</span>: number of individuals,</li>
<li><span class="math inline">\(T\)</span>: number of capture periods, and</li>
<li><span class="math inline">\(y_{i,t}\)</span>: Boolean indicating if individual <span class="math inline">\(i\)</span> was captured at
time <span class="math inline">\(t\)</span>.</li>
</ul>
<p>Each individual is assumed to have been captured at least once because
an individual only contributes information conditionally after they
have been captured the first time.</p>
<p>There are two Bernoulli parameters in the model,</p>
<ul>
<li><span class="math inline">\(\phi_t\)</span> : probability that animal alive at time <span class="math inline">\(t\)</span> survives
until <span class="math inline">\(t + 1\)</span> and</li>
<li><span class="math inline">\(p_t\)</span> : probability that animal alive at time <span class="math inline">\(t\)</span> is captured at
time <span class="math inline">\(t\)</span>.</li>
</ul>
<p>These parameters will both be given uniform priors, but information
should be used to tighten these priors in practice.</p>
<p>The CJS model also employs a latent discrete parameter <span class="math inline">\(z_{i,t}\)</span>
indicating for each individual <span class="math inline">\(i\)</span> whether it is alive at time <span class="math inline">\(t\)</span>,
distributed as
<span class="math display">\[
z_{i,t} \sim \mathsf{Bernoulli}(z_{i,t-1} \; ? \; 0 \: : \: \phi_{t-1}).
\]</span></p>
<p>The conditional prevents the model positing zombies; once an animal is
dead, it stays dead. The data distribution is then simple to express
conditional on <span class="math inline">\(z\)</span> as
<span class="math display">\[
y_{i,t} \sim \mathsf{Bernoulli}(z_{i,t} \; ? \; 0 \: : \: p_t).
\]</span></p>
<p>The conditional enforces the constraint that dead animals cannot be captured.</p>
</div>
<div id="collective-cormack-jolly-seber-model" class="section level3 unnumbered">
<h3>Collective Cormack-Jolly-Seber model</h3>
<p>This subsection presents an implementation of the model in terms of
counts for different history profiles for individuals over three
capture times. It assumes exchangeability of the animals in that each
is assigned the same capture and survival probabilities.</p>
<p>In order to ease the marginalization of the latent discrete parameter
<span class="math inline">\(z_{i,t}\)</span>, the Stan models rely on a derived quantity <span class="math inline">\(\chi_t\)</span> for
the probability that an individual is never captured again if it is
alive at time <span class="math inline">\(t\)</span> (if it is dead, the recapture probability is zero).
this quantity is defined recursively by
<span class="math display">\[
\chi_t
=
\begin{cases}
1 &amp; \quad\text{if } t = T \\
(1 - \phi_t) + \phi_t (1 - p_{t+1}) \chi_{t+1}
  &amp; \quad\text{if } t &lt; T
\end{cases}
\]</span></p>
<p>The base case arises because if an animal was captured in the last
time period, the probability it is never captured again is 1 because
there are no more capture periods. The recursive case defining
<span class="math inline">\(\chi_{t}\)</span> in terms of <span class="math inline">\(\chi_{t+1}\)</span> involves two possibilities: (1)
not surviving to the next time period, with probability <span class="math inline">\((1 - \phi_t)\)</span>, or (2) surviving to the next time period with probability
<span class="math inline">\(\phi_t\)</span>, not being captured in the next time period with probability
<span class="math inline">\((1 - p_{t+1})\)</span>, and not being captured again after being alive in
period <span class="math inline">\(t+1\)</span> with probability <span class="math inline">\(\chi_{t+1}\)</span>.</p>
<p>With three capture times, there are eight captured/not-captured
profiles an individual may have. These may be naturally coded as
binary numbers as follows.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
captures
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:center;">
profile
</th>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
probability
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
n/a
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
n/a
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\chi_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\phi_2 \, p_3\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\chi_1\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\phi_1 \, (1 - p_2) \, \phi_2 \, p_3\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\phi_1 \, p_2 \, \chi_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(+\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\phi_1 \, p_2 \, \phi_2 \, p_3\)</span>
</td>
</tr>
</tbody>
</table>
<p>History 0, for animals that are never captured, is unobservable
because only animals that are captured are observed. History 1, for
animals that are only captured in the last round, provides no
information for the CJS model, because capture/non-capture status is
only informative when conditioned on earlier captures. For the
remaining cases, the contribution to the likelihood is provided in the
final column.</p>
<p>By defining these probabilities in terms of <span class="math inline">\(\chi\)</span> directly, there is
no need for a latent binary parameter indicating whether an animal is
alive at time <span class="math inline">\(t\)</span> or not. The definition of <span class="math inline">\(\chi\)</span> is typically used
to define the likelihood (i.e., marginalize out the latent discrete
parameter) for the CJS model <span class="citation">(<a href="#ref-Schofield:2007" role="doc-biblioref">Schofield 2007</a>)</span>.</p>
<p>The Stan model defines <span class="math inline">\(\chi\)</span> as a transformed parameter based on
parameters <span class="math inline">\(\phi\)</span> and <span class="math inline">\(p\)</span>. In the model block, the log probability is
incremented for each history based on its count. This second step is
similar to collecting Bernoulli observations into a binomial or
categorical observations into a multinomial, only it is coded directly
in the Stan program using <code>target +=</code> rather than
being part of a built-in probability function.</p>
<p>The following is the Stan program for the Cormack-Jolly-Seber
mark-recapture model that considers counts of individuals with
observation histories of being observed or not in three capture
periods</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb138-1"><a href="mark-recapture-models.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb138-2"><a href="mark-recapture-models.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[<span class="dv">7</span>] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; history;</span>
<span id="cb138-3"><a href="mark-recapture-models.html#cb138-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-4"><a href="mark-recapture-models.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb138-5"><a href="mark-recapture-models.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[<span class="dv">2</span>] <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; phi;</span>
<span id="cb138-6"><a href="mark-recapture-models.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[<span class="dv">3</span>] <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; p;</span>
<span id="cb138-7"><a href="mark-recapture-models.html#cb138-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-8"><a href="mark-recapture-models.html#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb138-9"><a href="mark-recapture-models.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[<span class="dv">2</span>] <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; chi;</span>
<span id="cb138-10"><a href="mark-recapture-models.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  chi[<span class="dv">2</span>] = (<span class="dv">1</span> - phi[<span class="dv">2</span>]) + phi[<span class="dv">2</span>] * (<span class="dv">1</span> - p[<span class="dv">3</span>]);</span>
<span id="cb138-11"><a href="mark-recapture-models.html#cb138-11" aria-hidden="true" tabindex="-1"></a>  chi[<span class="dv">1</span>] = (<span class="dv">1</span> - phi[<span class="dv">1</span>]) + phi[<span class="dv">1</span>] * (<span class="dv">1</span> - p[<span class="dv">2</span>]) * chi[<span class="dv">2</span>];</span>
<span id="cb138-12"><a href="mark-recapture-models.html#cb138-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-13"><a href="mark-recapture-models.html#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb138-14"><a href="mark-recapture-models.html#cb138-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">2</span>] * log(chi[<span class="dv">2</span>]);</span>
<span id="cb138-15"><a href="mark-recapture-models.html#cb138-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">3</span>] * (log(phi[<span class="dv">2</span>]) + log(p[<span class="dv">3</span>]));</span>
<span id="cb138-16"><a href="mark-recapture-models.html#cb138-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">4</span>] * (log(chi[<span class="dv">1</span>]));</span>
<span id="cb138-17"><a href="mark-recapture-models.html#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">5</span>] * (log(phi[<span class="dv">1</span>]) + log1m(p[<span class="dv">2</span>])</span>
<span id="cb138-18"><a href="mark-recapture-models.html#cb138-18" aria-hidden="true" tabindex="-1"></a>                            + log(phi[<span class="dv">2</span>]) + log(p[<span class="dv">3</span>]));</span>
<span id="cb138-19"><a href="mark-recapture-models.html#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">6</span>] * (log(phi[<span class="dv">1</span>]) + log(p[<span class="dv">2</span>])</span>
<span id="cb138-20"><a href="mark-recapture-models.html#cb138-20" aria-hidden="true" tabindex="-1"></a>                            + log(chi[<span class="dv">2</span>]));</span>
<span id="cb138-21"><a href="mark-recapture-models.html#cb138-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">target +=</span> history[<span class="dv">7</span>] * (log(phi[<span class="dv">1</span>]) + log(p[<span class="dv">2</span>])</span>
<span id="cb138-22"><a href="mark-recapture-models.html#cb138-22" aria-hidden="true" tabindex="-1"></a>                            + log(phi[<span class="dv">2</span>]) + log(p[<span class="dv">3</span>]));</span>
<span id="cb138-23"><a href="mark-recapture-models.html#cb138-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-24"><a href="mark-recapture-models.html#cb138-24" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb138-25"><a href="mark-recapture-models.html#cb138-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; beta3;</span>
<span id="cb138-26"><a href="mark-recapture-models.html#cb138-26" aria-hidden="true" tabindex="-1"></a>  beta3 = phi[<span class="dv">2</span>] * p[<span class="dv">3</span>];</span>
<span id="cb138-27"><a href="mark-recapture-models.html#cb138-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a name="id:change-point-model.figure"></a></p>
<div id="identifiability-1" class="section level4 unnumbered">
<h4>Identifiability</h4>
<p>The parameters <span class="math inline">\(\phi_2\)</span> and <span class="math inline">\(p_3\)</span>, the probability of death at time 2
and probability of capture at time 3 are not identifiable, because both
may be used to account for lack of capture at time 3. Their product,
<span class="math inline">\(\beta_3 = \phi_2 \, p_3\)</span>, is identified. The Stan model defines
<code>beta3</code> as a generated quantity. Unidentified parameters pose a
problem for Stan’s samplers’ adaptation. Although the problem posed
for adaptation is mild here because the parameters are bounded and
thus have proper uniform priors, it would be better to formulate an
identified parameterization. One way to do this would be to formulate
a hierarchical model for the <span class="math inline">\(p\)</span> and <span class="math inline">\(\phi\)</span> parameters.</p>
</div>
</div>
<div id="individual-cormack-jolly-seber-model" class="section level3 unnumbered">
<h3>Individual Cormack-Jolly-Seber model</h3>
<p>This section presents a version of the Cormack-Jolly-Seber (CJS) model
cast at the individual level rather than collectively as in the
previous subsection. It also extends the model to allow an arbitrary
number of time periods. The data will consist of the number <span class="math inline">\(T\)</span> of
capture events, the number <span class="math inline">\(I\)</span> of individuals, and a boolean flag
<span class="math inline">\(y_{i,t}\)</span> indicating if individual <span class="math inline">\(i\)</span> was observed at time <span class="math inline">\(t\)</span>. In
Stan,</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb139-1"><a href="mark-recapture-models.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb139-2"><a href="mark-recapture-models.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">2</span>&gt; T;</span>
<span id="cb139-3"><a href="mark-recapture-models.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; I;</span>
<span id="cb139-4"><a href="mark-recapture-models.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[I, T] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; y;</span>
<span id="cb139-5"><a href="mark-recapture-models.html#cb139-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The advantages to the individual-level model is that it becomes
possible to add individual “random effects” that affect survival or
capture probability, as well as to avoid the combinatorics involved in
unfolding <span class="math inline">\(2^T\)</span> observation histories for <span class="math inline">\(T\)</span> capture times.</p>
<div id="utility-functions" class="section level4 unnumbered">
<h4>Utility functions</h4>
<p>The individual CJS model is written involves several function
definitions. The first two are used in the transformed data block to
compute the first and last time period in which an animal was
captured.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb140-1"><a href="mark-recapture-models.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="kw">functions</span> {</span>
<span id="cb140-2"><a href="mark-recapture-models.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> first_capture(<span class="dt">array</span>[] <span class="dt">int</span> y_i) {</span>
<span id="cb140-3"><a href="mark-recapture-models.html#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span>:size(y_i)) {</span>
<span id="cb140-4"><a href="mark-recapture-models.html#cb140-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y_i[k]) {</span>
<span id="cb140-5"><a href="mark-recapture-models.html#cb140-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> k;</span>
<span id="cb140-6"><a href="mark-recapture-models.html#cb140-6" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb140-7"><a href="mark-recapture-models.html#cb140-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb140-8"><a href="mark-recapture-models.html#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb140-9"><a href="mark-recapture-models.html#cb140-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb140-10"><a href="mark-recapture-models.html#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> last_capture(<span class="dt">array</span>[] <span class="dt">int</span> y_i) {</span>
<span id="cb140-11"><a href="mark-recapture-models.html#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k_rev <span class="cf">in</span> <span class="dv">0</span>:(size(y_i) - <span class="dv">1</span>)) {</span>
<span id="cb140-12"><a href="mark-recapture-models.html#cb140-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> k;</span>
<span id="cb140-13"><a href="mark-recapture-models.html#cb140-13" aria-hidden="true" tabindex="-1"></a>      k = size(y_i) - k_rev;</span>
<span id="cb140-14"><a href="mark-recapture-models.html#cb140-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y_i[k]) {</span>
<span id="cb140-15"><a href="mark-recapture-models.html#cb140-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> k;</span>
<span id="cb140-16"><a href="mark-recapture-models.html#cb140-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb140-17"><a href="mark-recapture-models.html#cb140-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb140-18"><a href="mark-recapture-models.html#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb140-19"><a href="mark-recapture-models.html#cb140-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb140-20"><a href="mark-recapture-models.html#cb140-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb140-21"><a href="mark-recapture-models.html#cb140-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>These two functions are used to define the first and last capture time
for each individual in the transformed data block.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb141-1"><a href="mark-recapture-models.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed data</span> {</span>
<span id="cb141-2"><a href="mark-recapture-models.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[I] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=T&gt; first;</span>
<span id="cb141-3"><a href="mark-recapture-models.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span>[I] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=T&gt; last;</span>
<span id="cb141-4"><a href="mark-recapture-models.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=I&gt;[T] n_captured;</span>
<span id="cb141-5"><a href="mark-recapture-models.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:I) {</span>
<span id="cb141-6"><a href="mark-recapture-models.html#cb141-6" aria-hidden="true" tabindex="-1"></a>    first[i] = first_capture(y[i]);</span>
<span id="cb141-7"><a href="mark-recapture-models.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-8"><a href="mark-recapture-models.html#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:I) {</span>
<span id="cb141-9"><a href="mark-recapture-models.html#cb141-9" aria-hidden="true" tabindex="-1"></a>    last[i] = last_capture(y[i]);</span>
<span id="cb141-10"><a href="mark-recapture-models.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-11"><a href="mark-recapture-models.html#cb141-11" aria-hidden="true" tabindex="-1"></a>  n_captured = rep_vector(<span class="dv">0</span>, T);</span>
<span id="cb141-12"><a href="mark-recapture-models.html#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span>:T) {</span>
<span id="cb141-13"><a href="mark-recapture-models.html#cb141-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:I) {</span>
<span id="cb141-14"><a href="mark-recapture-models.html#cb141-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y[i, t]) {</span>
<span id="cb141-15"><a href="mark-recapture-models.html#cb141-15" aria-hidden="true" tabindex="-1"></a>        n_captured[t] = n_captured[t] + <span class="dv">1</span>;</span>
<span id="cb141-16"><a href="mark-recapture-models.html#cb141-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb141-17"><a href="mark-recapture-models.html#cb141-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb141-18"><a href="mark-recapture-models.html#cb141-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-19"><a href="mark-recapture-models.html#cb141-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The transformed data block also defines <code>n_captured[t]</code>, which is
the total number of captures at time <code>t</code>. The variable
<code>n_captured</code> is defined as a vector instead of an integer array
so that it can be used in an elementwise vector operation in the generated
quantities block to model the population estimates at each time point.</p>
<p>The parameters and transformed parameters are as before, but now there
is a function definition for computing the entire vector <code>chi</code>, the
probability that if an individual is alive at <code>t</code> that it will
never be captured again.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb142-1"><a href="mark-recapture-models.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb142-2"><a href="mark-recapture-models.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt;[T - <span class="dv">1</span>] phi;</span>
<span id="cb142-3"><a href="mark-recapture-models.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt;[T] p;</span>
<span id="cb142-4"><a href="mark-recapture-models.html#cb142-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-5"><a href="mark-recapture-models.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb142-6"><a href="mark-recapture-models.html#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt;[T] chi;</span>
<span id="cb142-7"><a href="mark-recapture-models.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  chi = prob_uncaptured(T, p, phi);</span>
<span id="cb142-8"><a href="mark-recapture-models.html#cb142-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The definition of <code>prob_uncaptured</code>, from the functions block,
is</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb143-1"><a href="mark-recapture-models.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">functions</span> {</span>
<span id="cb143-2"><a href="mark-recapture-models.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb143-3"><a href="mark-recapture-models.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span> prob_uncaptured(<span class="dt">int</span> T, <span class="dt">vector</span> p, <span class="dt">vector</span> phi) {</span>
<span id="cb143-4"><a href="mark-recapture-models.html#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vector</span>[T] chi;</span>
<span id="cb143-5"><a href="mark-recapture-models.html#cb143-5" aria-hidden="true" tabindex="-1"></a>    chi[T] = <span class="fl">1.0</span>;</span>
<span id="cb143-6"><a href="mark-recapture-models.html#cb143-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span>:(T - <span class="dv">1</span>)) {</span>
<span id="cb143-7"><a href="mark-recapture-models.html#cb143-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> t_curr;</span>
<span id="cb143-8"><a href="mark-recapture-models.html#cb143-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> t_next;</span>
<span id="cb143-9"><a href="mark-recapture-models.html#cb143-9" aria-hidden="true" tabindex="-1"></a>      t_curr = T - t;</span>
<span id="cb143-10"><a href="mark-recapture-models.html#cb143-10" aria-hidden="true" tabindex="-1"></a>      t_next = t_curr + <span class="dv">1</span>;</span>
<span id="cb143-11"><a href="mark-recapture-models.html#cb143-11" aria-hidden="true" tabindex="-1"></a>      chi[t_curr] = (<span class="dv">1</span> - phi[t_curr])</span>
<span id="cb143-12"><a href="mark-recapture-models.html#cb143-12" aria-hidden="true" tabindex="-1"></a>                     + phi[t_curr]</span>
<span id="cb143-13"><a href="mark-recapture-models.html#cb143-13" aria-hidden="true" tabindex="-1"></a>                       * (<span class="dv">1</span> - p[t_next])</span>
<span id="cb143-14"><a href="mark-recapture-models.html#cb143-14" aria-hidden="true" tabindex="-1"></a>                       * chi[t_next];</span>
<span id="cb143-15"><a href="mark-recapture-models.html#cb143-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-16"><a href="mark-recapture-models.html#cb143-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chi;</span>
<span id="cb143-17"><a href="mark-recapture-models.html#cb143-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-18"><a href="mark-recapture-models.html#cb143-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function definition directly follows the mathematical definition
of <span class="math inline">\(\chi_t\)</span>, unrolling the recursion into an iteration and
defining the elements of <code>chi</code> from <code>T</code> down to 1.</p>
</div>
<div id="the-model" class="section level4 unnumbered">
<h4>The model</h4>
<p>Given the precomputed quantities, the model block directly encodes the
CJS model’s log likelihood function. All parameters are left with
their default uniform priors and the model simply encodes the log
probability of the observations <code>q</code> given the parameters <code>p</code>
and <code>phi</code> as well as the transformed parameter <code>chi</code> defined
in terms of <code>p</code> and <code>phi</code>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb144-1"><a href="mark-recapture-models.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb144-2"><a href="mark-recapture-models.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:I) {</span>
<span id="cb144-3"><a href="mark-recapture-models.html#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (first[i] &gt; <span class="dv">0</span>) {</span>
<span id="cb144-4"><a href="mark-recapture-models.html#cb144-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (t <span class="cf">in</span> (first[i]+<span class="dv">1</span>):last[i]) {</span>
<span id="cb144-5"><a href="mark-recapture-models.html#cb144-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span> ~ bernoulli(phi[t - <span class="dv">1</span>]);</span>
<span id="cb144-6"><a href="mark-recapture-models.html#cb144-6" aria-hidden="true" tabindex="-1"></a>        y[i, t] ~ bernoulli(p[t]);</span>
<span id="cb144-7"><a href="mark-recapture-models.html#cb144-7" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb144-8"><a href="mark-recapture-models.html#cb144-8" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span> ~ bernoulli(chi[last[i]]);</span>
<span id="cb144-9"><a href="mark-recapture-models.html#cb144-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-10"><a href="mark-recapture-models.html#cb144-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-11"><a href="mark-recapture-models.html#cb144-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The outer loop is over individuals, conditional skipping individuals
<code>i</code> which are never captured. The never-captured check depends
on the convention of the first-capture and last-capture functions
returning 0 for <code>first</code> if an individual is never captured.</p>
<p>The inner loop for individual <code>i</code> first increments the log
probability based on the survival of the individual with probability
<code>phi[t - 1]</code>. The outcome of 1 is fixed because the individual
must survive between the first and last capture (i.e., no zombies).
The loop starts after the first capture, because all
information in the CJS model is conditional on the first capture.</p>
<p>In the inner loop, the observed capture status <code>y[i, t]</code> for
individual <code>i</code> at time <code>t</code> has a Bernoulli distribution
based on the capture probability <code>p[t]</code> at time <code>t</code>.</p>
<p>After the inner loop, the probability of an animal never being seen
again after being observed at time <code>last[i]</code> is included, because
<code>last[i]</code> was defined to be the last time period in which animal
<code>i</code> was observed.</p>
</div>
<div id="identified-parameters" class="section level4 unnumbered">
<h4>Identified parameters</h4>
<p>As with the collective model described in the previous subsection,
this model does not identify <code>phi[T - 1]</code> and <code>p[T]</code>, but
does identify their product, <code>beta</code>. Thus <code>beta</code> is defined
as a generated quantity to monitor convergence and report.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb145-1"><a href="mark-recapture-models.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb145-2"><a href="mark-recapture-models.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> beta;</span>
<span id="cb145-3"><a href="mark-recapture-models.html#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb145-4"><a href="mark-recapture-models.html#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="mark-recapture-models.html#cb145-5" aria-hidden="true" tabindex="-1"></a>  beta = phi[T - <span class="dv">1</span>] * p[T];</span>
<span id="cb145-6"><a href="mark-recapture-models.html#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb145-7"><a href="mark-recapture-models.html#cb145-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The parameter <code>p[1]</code> is also not modeled and will just be uniform
between 0 and 1. A more finely articulated model might have a
hierarchical or time-series component, in which case <code>p[1]</code> would
be an unknown initial condition and both <code>phi[T - 1]</code> and
<code>p[T]</code> could be identified.</p>
</div>
<div id="population-size-estimates" class="section level4 unnumbered">
<h4>Population size estimates</h4>
<p>The generated quantities also calculates an estimate of the population
mean at each time <code>t</code> in the same way as in the simple
mark-recapture model as the number of individuals captured at time
<code>t</code> divided by the probability of capture at time <code>t</code>. This
is done with the elementwise division operation for vectors
(<code>./</code>) in the generated quantities block.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb146-1"><a href="mark-recapture-models.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb146-2"><a href="mark-recapture-models.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb146-3"><a href="mark-recapture-models.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt;[T] pop;</span>
<span id="cb146-4"><a href="mark-recapture-models.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb146-5"><a href="mark-recapture-models.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  pop = n_captured ./ p;</span>
<span id="cb146-6"><a href="mark-recapture-models.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  pop[<span class="dv">1</span>] = -<span class="dv">1</span>;</span>
<span id="cb146-7"><a href="mark-recapture-models.html#cb146-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="generalizing-to-individual-effects" class="section level4 unnumbered">
<h4>Generalizing to individual effects</h4>
<p>All individuals are modeled as having the same capture probability,
but this model could be easily generalized to use a logistic
regression here based on individual-level inputs to be used as
predictors.</p>
</div>
</div>
</div>
<h3><i style="font-size: 110%; color:#990017;">References</i></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cormack:1964" class="csl-entry">
Cormack, R. M. 1964. <span>“Estimates of Survival from the Sighting of Marked Animals.”</span> <em>Biometrika</em> 51 (3/4): 429–38.
</div>
<div id="ref-Jolly:1965" class="csl-entry">
Jolly, G. M. 1965. <span>“Explicit Estimates from Capture-Recapture Data with Both Death and Immigration-Stochastic Model.”</span> <em>Biometrika</em> 52 (1/2): 225–47.
</div>
<div id="ref-Lincoln:1930" class="csl-entry">
Lincoln, F. C. 1930. <span>“Calculating Waterfowl Abundance on the Basis of Banding Returns.”</span> <em>United States Department of Agriculture Circular</em> 118: 1–4.
</div>
<div id="ref-Petersen:1896" class="csl-entry">
Petersen, C. G. J. 1896. <span>“The Yearly Immigration of Young Plaice into the <span>L</span>imfjord from the <span>G</span>erman <span>S</span>ea.”</span> <em>Report of the Danish Biological Station</em> 6: 5–84.
</div>
<div id="ref-Schofield:2007" class="csl-entry">
Schofield, Matthew R. 2007. <span>“Hierarchical Capture-Recapture Models.”</span> PhD thesis, Department of Statistics, University of Otago, Dunedin.
</div>
<div id="ref-Seber:1965" class="csl-entry">
Seber, G. A. F. 1965. <span>“A Note on the Multiple-Recapture Census.”</span> <em>Biometrika</em> 52 (1/2): 249–59.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="18">
<li id="fn18"><p>An alternative would be to compute this on the outside and feed it into the Stan model as preprocessed data. Yet another alternative encoding would be a sparse one recording only the capture events along with their time and identifying the individual captured.<a href="mark-recapture-models.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Both functions return 0 if the individual represented by the input array was never captured. Individuals with no captures are not relevant for estimating the model because all probability statements are conditional on earlier captures. Typically they would be removed from the data, but the program allows them to be included even though they make not contribution to the log probability function.<a href="mark-recapture-models.html#fnref19" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="change-point.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-coding-and-diagnostic-accuracy-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
