<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<link rel="canonical" href="https://mc-stan.org/docs/stan-users-guide/reparameterization.html" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>22.7 Reparameterization | Stan User’s Guide</title>
  <meta name="description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="22.7 Reparameterization | Stan User’s Guide" />
  <meta property="og:type" content="book" />

  <meta property="og:image" content="img/logo-tm.pdf" />
  <meta property="og:description" content="Stan user’s guide with examples and programming techniques." />


  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="22.7 Reparameterization | Stan User’s Guide" />

  <meta name="twitter:description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="twitter:image" content="img/logo-tm.pdf" />

<meta name="author" content="Stan Development Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />


<link rel="prev" href="avoiding-validation.html"/>
<link rel="next" href="vectorization.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint/kePrint.js"></script>



<link rel="stylesheet" href="stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/stan-users-guide/index.html" style="color:#4183C4">Stan User's Guide</a></li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this user’s guide</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#web-resources"><i class="fa fa-check"></i>Web resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright-trademark-and-licensing"><i class="fa fa-check"></i>Copyright, Trademark, and Licensing</a></li>
</ul></li>
<li><a href="example-models-part.html#example-models.part"><i style="font-size: 110%; color:#990017;">Part 1. Example Models</i></a></li>
<li class="chapter" data-level="1" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>1</b> Regression Models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1.1</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#vectorization.section"><i class="fa fa-check"></i>Matrix Notation and Vectorization</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="QR-reparameterization-section.html"><a href="QR-reparameterization-section.html"><i class="fa fa-check"></i><b>1.2</b> The QR Reparameterization</a></li>
<li class="chapter" data-level="1.3" data-path="regression-priors-section.html"><a href="regression-priors-section.html"><i class="fa fa-check"></i><b>1.3</b> Priors for Coefficients and Scales</a></li>
<li class="chapter" data-level="1.4" data-path="robust-noise-models.html"><a href="robust-noise-models.html"><i class="fa fa-check"></i><b>1.4</b> Robust Noise Models</a></li>
<li class="chapter" data-level="1.5" data-path="logistic-probit-regression-section.html"><a href="logistic-probit-regression-section.html"><i class="fa fa-check"></i><b>1.5</b> Logistic and Probit Regression</a></li>
<li class="chapter" data-level="1.6" data-path="multi-logit-section.html"><a href="multi-logit-section.html"><i class="fa fa-check"></i><b>1.6</b> Multi-Logit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multi-logit-section.html"><a href="multi-logit-section.html#constraints-on-data-declarations"><i class="fa fa-check"></i>Constraints on Data Declarations</a></li>
<li class="chapter" data-level="" data-path="multi-logit-section.html"><a href="multi-logit-section.html#identifiability"><i class="fa fa-check"></i>Identifiability</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html"><i class="fa fa-check"></i><b>1.7</b> Parameterizing Centered Vectors</a>
<ul>
<li><a href="parameterizing-centered-vectors.html#k-1-degrees-of-freedom"><span class="math inline">\(K-1\)</span> Degrees of Freedom</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#qr-decomposition"><i class="fa fa-check"></i>QR Decomposition</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#translated-and-scaled-simplex"><i class="fa fa-check"></i>Translated and Scaled Simplex</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#soft-centering"><i class="fa fa-check"></i>Soft Centering</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="ordered-logistic-section.html"><a href="ordered-logistic-section.html"><i class="fa fa-check"></i><b>1.8</b> Ordered Logistic and Probit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordered-logistic-section.html"><a href="ordered-logistic-section.html#ordered-logistic-regression"><i class="fa fa-check"></i>Ordered Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="hierarchical-logistic-regression.html"><a href="hierarchical-logistic-regression.html"><i class="fa fa-check"></i><b>1.9</b> Hierarchical Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="hierarchical-logistic-regression.html"><a href="hierarchical-logistic-regression.html#optimizing-the-model"><i class="fa fa-check"></i>Optimizing the Model</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="hierarchical-priors-section.html"><a href="hierarchical-priors-section.html"><i class="fa fa-check"></i><b>1.10</b> Hierarchical Priors</a>
<ul>
<li class="chapter" data-level="" data-path="hierarchical-priors-section.html"><a href="hierarchical-priors-section.html#boundary-avoiding-priors-for-mle-in-hierarchical-models"><i class="fa fa-check"></i>Boundary-Avoiding Priors for MLE in Hierarchical Models</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="item-response-models-section.html"><a href="item-response-models-section.html"><i class="fa fa-check"></i><b>1.11</b> Item-Response Theory Models</a>
<ul>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#data-declaration-with-missingness"><i class="fa fa-check"></i>Data Declaration with Missingness</a></li>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#pl-rasch-model"><i class="fa fa-check"></i>1PL (Rasch) Model</a></li>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#multilevel-2pl-model"><i class="fa fa-check"></i>Multilevel 2PL Model</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html"><i class="fa fa-check"></i><b>1.12</b> Priors for Identifiability</a>
<ul>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#location-and-scale-invariance"><i class="fa fa-check"></i>Location and Scale Invariance</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#separability"><i class="fa fa-check"></i>Separability</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="multivariate-hierarchical-priors-section.html"><a href="multivariate-hierarchical-priors-section.html"><i class="fa fa-check"></i><b>1.13</b> Multivariate Priors for Hierarchical Models</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-hierarchical-priors-section.html"><a href="multivariate-hierarchical-priors-section.html#multivariate-regression-example"><i class="fa fa-check"></i>Multivariate Regression Example</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html"><i class="fa fa-check"></i><b>1.14</b> Prediction, Forecasting, and Backcasting</a>
<ul>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#programming-predictions"><i class="fa fa-check"></i>Programming Predictions</a></li>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#predictions-as-generated-quantities"><i class="fa fa-check"></i>Predictions as Generated Quantities</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html"><i class="fa fa-check"></i><b>1.15</b> Multivariate Outcomes</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#seemingly-unrelated-regressions"><i class="fa fa-check"></i>Seemingly Unrelated Regressions</a></li>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#multivariate-probit-regression"><i class="fa fa-check"></i>Multivariate Probit Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.16" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html"><i class="fa fa-check"></i><b>1.16</b> Applications of Pseudorandom Number Generation</a>
<ul>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#posterior-predictive-checks"><i class="fa fa-check"></i>Posterior Predictive Checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-chapter.html"><a href="time-series-chapter.html"><i class="fa fa-check"></i><b>2</b> Time-Series Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="autoregressive-section.html"><a href="autoregressive-section.html"><i class="fa fa-check"></i><b>2.1</b> Autoregressive Models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#ar1-models"><i class="fa fa-check"></i>AR(1) Models</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#extensions-to-the-ar1-model"><i class="fa fa-check"></i>Extensions to the AR(1) Model</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#ar2-models"><i class="fa fa-check"></i>AR(2) Models</a></li>
<li><a href="autoregressive-section.html#ark-models">AR(<span class="math inline">\(K\)</span>) Models</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#arch1-models"><i class="fa fa-check"></i>ARCH(1) Models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html"><i class="fa fa-check"></i><b>2.2</b> Modeling Temporal Heteroscedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html#garch11-models"><i class="fa fa-check"></i>GARCH(1,1) Models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>2.3</b> Moving Average Models</a>
<ul>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#ma2-example"><i class="fa fa-check"></i>MA(2) Example</a></li>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#vectorized-maq-model"><i class="fa fa-check"></i>Vectorized MA(Q) Model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html"><i class="fa fa-check"></i><b>2.4</b> Autoregressive Moving Average Models</a>
<ul>
<li class="chapter" data-level="" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html#identifiability-and-stationarity"><i class="fa fa-check"></i>Identifiability and Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="stochastic-volatility-models.html"><a href="stochastic-volatility-models.html"><i class="fa fa-check"></i><b>2.5</b> Stochastic Volatility Models</a></li>
<li class="chapter" data-level="2.6" data-path="hmms-section.html"><a href="hmms-section.html"><i class="fa fa-check"></i><b>2.6</b> Hidden Markov Models</a>
<ul>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#supervised-parameter-estimation"><i class="fa fa-check"></i>Supervised Parameter Estimation</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#start-state-and-end-state-probabilities"><i class="fa fa-check"></i>Start-State and End-State Probabilities</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#calculating-sufficient-statistics"><i class="fa fa-check"></i>Calculating Sufficient Statistics</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#analytic-posterior"><i class="fa fa-check"></i>Analytic Posterior</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#semisupervised-estimation"><i class="fa fa-check"></i>Semisupervised Estimation</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#predictive-inference"><i class="fa fa-check"></i>Predictive Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missing-data-and-partially-known-parameters.html"><a href="missing-data-and-partially-known-parameters.html"><i class="fa fa-check"></i><b>3</b> Missing Data and Partially Known Parameters</a>
<ul>
<li class="chapter" data-level="3.1" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>3.1</b> Missing Data</a></li>
<li class="chapter" data-level="3.2" data-path="partially-known-parameters-section.html"><a href="partially-known-parameters-section.html"><i class="fa fa-check"></i><b>3.2</b> Partially Known Parameters</a></li>
<li class="chapter" data-level="3.3" data-path="sliced-missing-data.html"><a href="sliced-missing-data.html"><i class="fa fa-check"></i><b>3.3</b> Sliced Missing Data</a></li>
<li class="chapter" data-level="3.4" data-path="loading-matrix-for-factor-analysis.html"><a href="loading-matrix-for-factor-analysis.html"><i class="fa fa-check"></i><b>3.4</b> Loading matrix for factor analysis</a></li>
<li class="chapter" data-level="3.5" data-path="missing-multivariate-data.html"><a href="missing-multivariate-data.html"><i class="fa fa-check"></i><b>3.5</b> Missing Multivariate Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="truncated-or-censored-data.html"><a href="truncated-or-censored-data.html"><i class="fa fa-check"></i><b>4</b> Truncated or Censored Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="truncation-section.html"><a href="truncation-section.html"><i class="fa fa-check"></i><b>4.1</b> Truncated Distributions</a></li>
<li class="chapter" data-level="4.2" data-path="truncated-data-section.html"><a href="truncated-data-section.html"><i class="fa fa-check"></i><b>4.2</b> Truncated Data</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-data-section.html"><a href="truncated-data-section.html#constraints-and-out-of-bounds-returns"><i class="fa fa-check"></i>Constraints and Out-of-Bounds Returns</a></li>
<li class="chapter" data-level="" data-path="truncated-data-section.html"><a href="truncated-data-section.html#unknown-truncation-points"><i class="fa fa-check"></i>Unknown Truncation Points</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="censored-data.html"><a href="censored-data.html"><i class="fa fa-check"></i><b>4.3</b> Censored Data</a>
<ul>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#estimating-censored-values"><i class="fa fa-check"></i>Estimating Censored Values</a></li>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#integrating-out-censored-values"><i class="fa fa-check"></i>Integrating out Censored Values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixture-modeling-chapter.html"><a href="mixture-modeling-chapter.html"><i class="fa fa-check"></i><b>5</b> Finite Mixtures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clustering-mixture-section.html"><a href="clustering-mixture-section.html"><i class="fa fa-check"></i><b>5.1</b> Relation to Clustering</a></li>
<li class="chapter" data-level="5.2" data-path="latent-discrete-parameterization.html"><a href="latent-discrete-parameterization.html"><i class="fa fa-check"></i><b>5.2</b> Latent Discrete Parameterization</a></li>
<li class="chapter" data-level="5.3" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html"><i class="fa fa-check"></i><b>5.3</b> Summing out the Responsibility Parameter</a>
<ul>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#log-sum-of-exponentials-linear-sums-on-the-log-scale"><i class="fa fa-check"></i>Log Sum of Exponentials: Linear Sums on the Log Scale</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#dropping-uniform-mixture-ratios"><i class="fa fa-check"></i>Dropping uniform mixture ratios</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#recovering-posterior-mixture-proportions"><i class="fa fa-check"></i>Recovering posterior mixture proportions</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#estimating-parameters-of-a-mixture"><i class="fa fa-check"></i>Estimating Parameters of a Mixture</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectorizing-mixtures.html"><a href="vectorizing-mixtures.html"><i class="fa fa-check"></i><b>5.4</b> Vectorizing Mixtures</a></li>
<li class="chapter" data-level="5.5" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html"><i class="fa fa-check"></i><b>5.5</b> Inferences Supported by Mixtures</a>
<ul>
<li class="chapter" data-level="" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html#mixtures-with-unidentifiable-components"><i class="fa fa-check"></i>Mixtures with Unidentifiable Components</a></li>
<li class="chapter" data-level="" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html#inference-under-label-switching"><i class="fa fa-check"></i>Inference under Label Switching</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html"><i class="fa fa-check"></i><b>5.6</b> Zero-Inflated and Hurdle Models</a>
<ul>
<li class="chapter" data-level="" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html#zero-inflation"><i class="fa fa-check"></i>Zero Inflation</a></li>
<li class="chapter" data-level="" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html#hurdle-models"><i class="fa fa-check"></i>Hurdle Models</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html"><i class="fa fa-check"></i><b>5.7</b> Priors and Effective Data Size in Mixture Models</a>
<ul>
<li class="chapter" data-level="" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html#comparison-to-model-averaging"><i class="fa fa-check"></i>Comparison to Model Averaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="measurement-error-and-meta-analysis.html"><a href="measurement-error-and-meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Measurement Error and Meta-Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html"><i class="fa fa-check"></i><b>6.1</b> Bayesian Measurement Error Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#regression-with-measurement-error"><i class="fa fa-check"></i>Regression with Measurement Error</a></li>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#rounding"><i class="fa fa-check"></i>Rounding</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Meta-Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="meta-analysis.html"><a href="meta-analysis.html#treatment-effects-in-controlled-studies"><i class="fa fa-check"></i>Treatment Effects in Controlled Studies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-discrete-chapter.html"><a href="latent-discrete-chapter.html"><i class="fa fa-check"></i><b>7</b> Latent Discrete Parameters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rao-blackwell-section.html"><a href="rao-blackwell-section.html"><i class="fa fa-check"></i><b>7.1</b> The Benefits of Marginalization</a></li>
<li class="chapter" data-level="7.2" data-path="change-point-section.html"><a href="change-point-section.html"><i class="fa fa-check"></i><b>7.2</b> Change Point Models</a>
<ul>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#model-with-latent-discrete-parameter"><i class="fa fa-check"></i>Model with Latent Discrete Parameter</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#marginalizing-out-the-discrete-parameter"><i class="fa fa-check"></i>Marginalizing out the Discrete Parameter</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#coding-the-model-in-stan-1"><i class="fa fa-check"></i>Coding the Model in Stan</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#fitting-the-model-with-mcmc"><i class="fa fa-check"></i>Fitting the Model with MCMC</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#posterior-distribution-of-the-discrete-change-point"><i class="fa fa-check"></i>Posterior Distribution of the Discrete Change Point</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#discrete-sampling"><i class="fa fa-check"></i>Discrete Sampling</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#posterior-covariance"><i class="fa fa-check"></i>Posterior Covariance</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#multiple-change-points"><i class="fa fa-check"></i>Multiple Change Points</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html"><i class="fa fa-check"></i><b>7.3</b> Mark-Recapture Models</a>
<ul>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#simple-mark-recapture-model"><i class="fa fa-check"></i>Simple Mark-Recapture Model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#cormack-jolly-seber-with-discrete-parameter"><i class="fa fa-check"></i>Cormack-Jolly-Seber with Discrete Parameter</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#collective-cormack-jolly-seber-model"><i class="fa fa-check"></i>Collective Cormack-Jolly-Seber Model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#individual-cormack-jolly-seber-model"><i class="fa fa-check"></i>Individual Cormack-Jolly-Seber Model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html"><i class="fa fa-check"></i><b>7.4</b> Data Coding and Diagnostic Accuracy Models</a>
<ul>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#diagnostic-accuracy"><i class="fa fa-check"></i>Diagnostic Accuracy</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#data-coding"><i class="fa fa-check"></i>Data Coding</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-categorical-measurement-model"><i class="fa fa-check"></i>Noisy Categorical Measurement Model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#model-parameters"><i class="fa fa-check"></i>Model Parameters</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-measurement-model"><i class="fa fa-check"></i>Noisy Measurement Model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#stan-implementation"><i class="fa fa-check"></i>Stan Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sparse-ragged-chapter.html"><a href="sparse-ragged-chapter.html"><i class="fa fa-check"></i><b>8</b> Sparse and Ragged Data Structures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sparse-data-structures.html"><a href="sparse-data-structures.html"><i class="fa fa-check"></i><b>8.1</b> Sparse Data Structures</a></li>
<li class="chapter" data-level="8.2" data-path="ragged-data-structs-section.html"><a href="ragged-data-structs-section.html"><i class="fa fa-check"></i><b>8.2</b> Ragged Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering-chapter.html"><a href="clustering-chapter.html"><i class="fa fa-check"></i><b>9</b> Clustering Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="relation-to-finite-mixture-models.html"><a href="relation-to-finite-mixture-models.html"><i class="fa fa-check"></i><b>9.1</b> Relation to Finite Mixture Models</a></li>
<li class="chapter" data-level="9.2" data-path="soft-k-means.html"><a href="soft-k-means.html"><i class="fa fa-check"></i><b>9.2</b> Soft <span class="math inline">\(K\)</span>-Means</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="soft-k-means.html"><a href="soft-k-means.html#geometric-hard-k-means-clustering"><i class="fa fa-check"></i><b>9.2.1</b> Geometric Hard <span class="math inline">\(K\)</span>-Means Clustering</a></li>
<li class="chapter" data-level="9.2.2" data-path="soft-k-means.html"><a href="soft-k-means.html#soft-k-means-clustering"><i class="fa fa-check"></i><b>9.2.2</b> Soft <span class="math inline">\(K\)</span>-Means Clustering</a></li>
<li><a href="soft-k-means.html#stan-implementation-of-soft-k-means">Stan Implementation of Soft <span class="math inline">\(K\)</span>-Means</a></li>
<li><a href="soft-k-means.html#generalizing-soft-k-means">Generalizing Soft <span class="math inline">\(K\)</span>-Means</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html"><i class="fa fa-check"></i><b>9.3</b> The Difficulty of Bayesian Inference for Clustering</a>
<ul>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#non-identifiability"><i class="fa fa-check"></i>Non-Identifiability</a></li>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#multimodality"><i class="fa fa-check"></i>Multimodality</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html"><i class="fa fa-check"></i><b>9.4</b> Naive Bayes Classification and Clustering</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#coding-ragged-arrays"><i class="fa fa-check"></i>Coding Ragged Arrays</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-with-category-labeled-training-data"><i class="fa fa-check"></i>Estimation with Category-Labeled Training Data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-without-category-labeled-training-data"><i class="fa fa-check"></i>Estimation without Category-Labeled Training Data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#full-bayesian-inference-for-naive-bayes"><i class="fa fa-check"></i>Full Bayesian Inference for Naive Bayes</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#prediction-without-model-updates"><i class="fa fa-check"></i>Prediction without Model Updates</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>9.5</b> Latent Dirichlet Allocation</a>
<ul>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#the-lda-model"><i class="fa fa-check"></i>The LDA Model</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#summing-out-the-discrete-parameters"><i class="fa fa-check"></i>Summing out the Discrete Parameters</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#implementation-of-lda"><i class="fa fa-check"></i>Implementation of LDA</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#correlated-topic-model"><i class="fa fa-check"></i>Correlated Topic Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gaussian-processes-chapter.html"><a href="gaussian-processes-chapter.html"><i class="fa fa-check"></i><b>10</b> Gaussian Processes</a>
<ul>
<li class="chapter" data-level="10.1" data-path="gaussian-process-regression.html"><a href="gaussian-process-regression.html"><i class="fa fa-check"></i><b>10.1</b> Gaussian Process Regression</a></li>
<li class="chapter" data-level="10.2" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html"><i class="fa fa-check"></i><b>10.2</b> Simulating from a Gaussian Process</a>
<ul>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#multivariate-inputs"><i class="fa fa-check"></i>Multivariate Inputs</a></li>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#cholesky-factored-and-transformed-implementation"><i class="fa fa-check"></i>Cholesky Factored and Transformed Implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fit-gp-section.html"><a href="fit-gp-section.html"><i class="fa fa-check"></i><b>10.3</b> Fitting a Gaussian Process</a>
<ul>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#gp-with-a-normal-outcome"><i class="fa fa-check"></i>GP with a normal outcome</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#discrete-outcomes-with-gaussian-processes"><i class="fa fa-check"></i>Discrete outcomes with Gaussian Processes</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#automatic-relevance-determination"><i class="fa fa-check"></i>Automatic Relevance Determination</a></li>
<li class="chapter" data-level="10.3.1" data-path="fit-gp-section.html"><a href="fit-gp-section.html#priors-gp.section"><i class="fa fa-check"></i><b>10.3.1</b> Priors for Gaussian Process Parameters</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#predictive-inference-with-a-gaussian-process"><i class="fa fa-check"></i>Predictive Inference with a Gaussian Process</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#multiple-output-gaussian-processes"><i class="fa fa-check"></i>Multiple-output Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="directions-rotations-and-hyperspheres.html"><a href="directions-rotations-and-hyperspheres.html"><i class="fa fa-check"></i><b>11</b> Directions, Rotations, and Hyperspheres</a>
<ul>
<li class="chapter" data-level="11.1" data-path="unit-vectors.html"><a href="unit-vectors.html"><i class="fa fa-check"></i><b>11.1</b> Unit Vectors</a></li>
<li class="chapter" data-level="11.2" data-path="circles-spheres-and-hyperspheres.html"><a href="circles-spheres-and-hyperspheres.html"><i class="fa fa-check"></i><b>11.2</b> Circles, Spheres, and Hyperspheres</a></li>
<li class="chapter" data-level="11.3" data-path="transforming-to-unconstrained-parameters.html"><a href="transforming-to-unconstrained-parameters.html"><i class="fa fa-check"></i><b>11.3</b> Transforming to Unconstrained Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="transforming-to-unconstrained-parameters.html"><a href="transforming-to-unconstrained-parameters.html#warning-undefined-at-zero"><i class="fa fa-check"></i>Warning: undefined at zero!</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html"><i class="fa fa-check"></i><b>11.4</b> Unit Vectors and Rotations</a>
<ul>
<li class="chapter" data-level="" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html#unit-vector-type"><i class="fa fa-check"></i>Unit vector type</a></li>
<li class="chapter" data-level="" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html#angles-from-unit-vectors"><i class="fa fa-check"></i>Angles from unit vectors</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="circular-representations-of-days-and-years.html"><a href="circular-representations-of-days-and-years.html"><i class="fa fa-check"></i><b>11.5</b> Circular Representations of Days and Years</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="algebra-solver-chapter.html"><a href="algebra-solver-chapter.html"><i class="fa fa-check"></i><b>12</b> Solving Algebraic Equations</a>
<ul>
<li class="chapter" data-level="12.1" data-path="example-system-of-nonlinear-algebraic-equations.html"><a href="example-system-of-nonlinear-algebraic-equations.html"><i class="fa fa-check"></i><b>12.1</b> Example: System of Nonlinear Algebraic Equations</a></li>
<li class="chapter" data-level="12.2" data-path="coding-an-algebraic-system.html"><a href="coding-an-algebraic-system.html"><i class="fa fa-check"></i><b>12.2</b> Coding an Algebraic System</a>
<ul>
<li class="chapter" data-level="" data-path="coding-an-algebraic-system.html"><a href="coding-an-algebraic-system.html#strict-signature"><i class="fa fa-check"></i>Strict Signature</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html"><i class="fa fa-check"></i><b>12.3</b> Calling the Algebraic Solver</a>
<ul>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#data-versus-parameters"><i class="fa fa-check"></i>Data versus Parameters</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#length-of-the-algebraic-function-and-of-the-vector-of-unknowns"><i class="fa fa-check"></i>Length of the Algebraic Function and of the Vector of Unknowns</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#pathological-solutions"><i class="fa fa-check"></i>Pathological Solutions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="algebra-control-section.html"><a href="algebra-control-section.html"><i class="fa fa-check"></i><b>12.4</b> Control Parameters for the Algebraic Solver</a>
<ul>
<li class="chapter" data-level="" data-path="algebra-control-section.html"><a href="algebra-control-section.html#tolerance"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="algebra-control-section.html"><a href="algebra-control-section.html#maximum-number-of-steps"><i class="fa fa-check"></i>Maximum Number of Steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ode-solver-chapter.html"><a href="ode-solver-chapter.html"><i class="fa fa-check"></i><b>13</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="example-simple-harmonic-oscillator.html"><a href="example-simple-harmonic-oscillator.html"><i class="fa fa-check"></i><b>13.1</b> Example: Simple Harmonic Oscillator</a>
<ul>
<li class="chapter" data-level="" data-path="example-simple-harmonic-oscillator.html"><a href="example-simple-harmonic-oscillator.html#solutions-given-initial-conditions"><i class="fa fa-check"></i>Solutions Given Initial Conditions</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="coding-an-ode-system.html"><a href="coding-an-ode-system.html"><i class="fa fa-check"></i><b>13.2</b> Coding an ODE System</a>
<ul>
<li class="chapter" data-level="" data-path="coding-an-ode-system.html"><a href="coding-an-ode-system.html#strict-signature-1"><i class="fa fa-check"></i>Strict Signature</a></li>
<li class="chapter" data-level="" data-path="coding-an-ode-system.html"><a href="coding-an-ode-system.html#discontinuous-ode-system-function"><i class="fa fa-check"></i>Discontinuous ODE System Function</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><a href="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><i class="fa fa-check"></i><b>13.3</b> Solving a System of Linear ODEs using a Matrix Exponential</a></li>
<li class="chapter" data-level="13.4" data-path="measurement-error-models.html"><a href="measurement-error-models.html"><i class="fa fa-check"></i><b>13.4</b> Measurement Error Models</a>
<ul>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#simulating-noisy-measurements"><i class="fa fa-check"></i>Simulating Noisy Measurements</a></li>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#data-versus-parameters-1"><i class="fa fa-check"></i>Data versus Parameters</a></li>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#estimating-system-parameters-and-initial-state"><i class="fa fa-check"></i>Estimating System Parameters and Initial State</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="stiff-ode-section.html"><a href="stiff-ode-section.html"><i class="fa fa-check"></i><b>13.5</b> Stiff ODEs</a></li>
<li class="chapter" data-level="13.6" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html"><i class="fa fa-check"></i><b>13.6</b> Control Parameters for ODE Solving</a>
<ul>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#data-only-for-control-parameters"><i class="fa fa-check"></i>Data only for control parameters</a></li>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#tolerance-1"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#maximum-number-of-steps-1"><i class="fa fa-check"></i>Maximum Number of Steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="integrate-1d.html"><a href="integrate-1d.html"><i class="fa fa-check"></i><b>14</b> Computing One Dimensional Integrals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html"><i class="fa fa-check"></i><b>14.1</b> Calling the Integrator</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#limits-of-integration"><i class="fa fa-check"></i><b>14.1.1</b> Limits of Integration</a></li>
<li class="chapter" data-level="14.1.2" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#data-versus-parameters-2"><i class="fa fa-check"></i><b>14.1.2</b> Data Versus Parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html"><i class="fa fa-check"></i><b>14.2</b> Integrator Convergence</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="integrator-convergence.html"><a href="integrator-convergence.html#zero-crossing"><i class="fa fa-check"></i><b>14.2.1</b> Zero-crossing Integrals</a></li>
<li class="chapter" data-level="14.2.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html#integral-precision"><i class="fa fa-check"></i><b>14.2.2</b> Avoiding precision loss near limits of integration in definite integrals</a></li>
</ul></li>
</ul></li>
<li><a href="part-2-programming-techniques.html#part-2.-programming-techniques"><i style="font-size: 110%; color:#990017;">Part 2. Programming Techniques</i></a></li>
<li class="chapter" data-level="15" data-path="floating-point-arithmetic.html"><a href="floating-point-arithmetic.html"><i class="fa fa-check"></i><b>15</b> Floating Point Arithmetic</a>
<ul>
<li class="chapter" data-level="15.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html"><i class="fa fa-check"></i><b>15.1</b> Floating-point representations</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html#finite-values"><i class="fa fa-check"></i><b>15.1.1</b> Finite values</a></li>
<li class="chapter" data-level="15.1.2" data-path="floating-point-representations.html"><a href="floating-point-representations.html#normality"><i class="fa fa-check"></i><b>15.1.2</b> Normality</a></li>
<li class="chapter" data-level="15.1.3" data-path="floating-point-representations.html"><a href="floating-point-representations.html#ranges-and-extreme-values"><i class="fa fa-check"></i><b>15.1.3</b> Ranges and extreme values</a></li>
<li class="chapter" data-level="15.1.4" data-path="floating-point-representations.html"><a href="floating-point-representations.html#signed-zero"><i class="fa fa-check"></i><b>15.1.4</b> Signed zero</a></li>
<li class="chapter" data-level="15.1.5" data-path="floating-point-representations.html"><a href="floating-point-representations.html#not-a-number-values"><i class="fa fa-check"></i><b>15.1.5</b> Not-a-number values</a></li>
<li class="chapter" data-level="15.1.6" data-path="floating-point-representations.html"><a href="floating-point-representations.html#positive-and-negative-infinity"><i class="fa fa-check"></i><b>15.1.6</b> Positive and negative infinity</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="literals-decimal-and-scientific-notation.html"><a href="literals-decimal-and-scientific-notation.html"><i class="fa fa-check"></i><b>15.2</b> Literals: decimal and scientific notation</a></li>
<li class="chapter" data-level="15.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html"><i class="fa fa-check"></i><b>15.3</b> Arithmetic Precision</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#rounding-and-probabilities"><i class="fa fa-check"></i><b>15.3.1</b> Rounding and probabilities</a></li>
<li class="chapter" data-level="15.3.2" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#machine-precision-and-the-asymmetry-of-0-and-1"><i class="fa fa-check"></i><b>15.3.2</b> Machine precision and the asymmetry of 0 and 1</a></li>
<li class="chapter" data-level="15.3.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#complementary-and-epsilon-functions"><i class="fa fa-check"></i><b>15.3.3</b> Complementary and epsilon functions</a></li>
<li class="chapter" data-level="15.3.4" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#catastrophic-cancellation"><i class="fa fa-check"></i><b>15.3.4</b> Catastrophic cancellation</a></li>
<li class="chapter" data-level="15.3.5" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#overflow"><i class="fa fa-check"></i><b>15.3.5</b> Overflow</a></li>
<li class="chapter" data-level="15.3.6" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#underflow-and-the-log-scale"><i class="fa fa-check"></i><b>15.3.6</b> Underflow and the log scale</a></li>
<li class="chapter" data-level="15.3.7" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#adding-on-the-log-scale"><i class="fa fa-check"></i><b>15.3.7</b> Adding on the log scale</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="comparing-floating-point-numbers.html"><a href="comparing-floating-point-numbers.html"><i class="fa fa-check"></i><b>15.4</b> Comparing floating-point numbers</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="matrices-vectors-and-arrays.html"><a href="matrices-vectors-and-arrays.html"><i class="fa fa-check"></i><b>16</b> Matrices, Vectors, and Arrays</a>
<ul>
<li class="chapter" data-level="16.1" data-path="basic-motivation.html"><a href="basic-motivation.html"><i class="fa fa-check"></i><b>16.1</b> Basic Motivation</a></li>
<li class="chapter" data-level="16.2" data-path="fixed-sizes-and-indexing-out-of-bounds.html"><a href="fixed-sizes-and-indexing-out-of-bounds.html"><i class="fa fa-check"></i><b>16.2</b> Fixed Sizes and Indexing out of Bounds</a></li>
<li class="chapter" data-level="16.3" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html"><i class="fa fa-check"></i><b>16.3</b> Data Type and Indexing Efficiency</a>
<ul>
<li class="chapter" data-level="" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html#matrices-vs.-two-dimensional-arrays"><i class="fa fa-check"></i>Matrices vs. Two-Dimensional Arrays</a></li>
<li class="chapter" data-level="" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html#row-vectors-vs.-one-dimensional-arrays"><i class="fa fa-check"></i>(Row) Vectors vs. One-Dimensional Arrays</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="memory-locality.html"><a href="memory-locality.html"><i class="fa fa-check"></i><b>16.4</b> Memory Locality</a>
<ul>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#memory-locality-1"><i class="fa fa-check"></i>Memory Locality</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#arrays"><i class="fa fa-check"></i>Arrays</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="converting-among-matrix-vector-and-array-types.html"><a href="converting-among-matrix-vector-and-array-types.html"><i class="fa fa-check"></i><b>16.5</b> Converting among Matrix, Vector, and Array Types</a></li>
<li class="chapter" data-level="16.6" data-path="aliasing-in-stan-containers.html"><a href="aliasing-in-stan-containers.html"><i class="fa fa-check"></i><b>16.6</b> Aliasing in Stan Containers</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="multi-indexing-chapter.html"><a href="multi-indexing-chapter.html"><i class="fa fa-check"></i><b>17</b> Multiple Indexing and Range Indexing</a>
<ul>
<li class="chapter" data-level="17.1" data-path="multiple-indexing.html"><a href="multiple-indexing.html"><i class="fa fa-check"></i><b>17.1</b> Multiple Indexing</a></li>
<li class="chapter" data-level="17.2" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html"><i class="fa fa-check"></i><b>17.2</b> Slicing with Range Indexes</a>
<ul>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-and-upper-bound-indexes"><i class="fa fa-check"></i>Lower and Upper Bound Indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-or-upper-bound-indexes"><i class="fa fa-check"></i>Lower or Upper Bound Indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#full-range-indexes"><i class="fa fa-check"></i>Full Range Indexes</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html"><i class="fa fa-check"></i><b>17.3</b> Multiple Indexing on the Left of Assignments</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html#assign-by-value-and-aliasing"><i class="fa fa-check"></i>Assign-by-Value and Aliasing</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html"><i class="fa fa-check"></i><b>17.4</b> Multiple Indexes with Vectors and Matrices</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-1"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-with-one-multiple-index"><i class="fa fa-check"></i>Matrices with One Multiple Index</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#arrays-of-vectors-or-matrices"><i class="fa fa-check"></i>Arrays of Vectors or Matrices</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="matrices-with-parameters-and-constants.html"><a href="matrices-with-parameters-and-constants.html"><i class="fa fa-check"></i><b>17.5</b> Matrices with Parameters and Constants</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="functions-programming-chapter.html"><a href="functions-programming-chapter.html"><i class="fa fa-check"></i><b>18</b> User-Defined Functions</a>
<ul>
<li class="chapter" data-level="18.1" data-path="basic-functions-section.html"><a href="basic-functions-section.html"><i class="fa fa-check"></i><b>18.1</b> Basic Functions</a>
<ul>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#user-defined-functions-block"><i class="fa fa-check"></i>User-Defined Functions Block</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#function-bodies"><i class="fa fa-check"></i>Function Bodies</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#return-statements"><i class="fa fa-check"></i>Return Statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#reject-statements"><i class="fa fa-check"></i>Reject Statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#type-declarations-for-functions"><i class="fa fa-check"></i>Type Declarations for Functions</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#array-types-for-function-declarations"><i class="fa fa-check"></i>Array Types for Function Declarations</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#data-only-function-arguments"><i class="fa fa-check"></i>Data-only Function Arguments</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="functions-as-statements.html"><a href="functions-as-statements.html"><i class="fa fa-check"></i><b>18.2</b> Functions as Statements</a></li>
<li class="chapter" data-level="18.3" data-path="functions-accessing-the-log-probability-accumulator.html"><a href="functions-accessing-the-log-probability-accumulator.html"><i class="fa fa-check"></i><b>18.3</b> Functions Accessing the Log Probability Accumulator</a></li>
<li class="chapter" data-level="18.4" data-path="functions-acting-as-random-number-generators.html"><a href="functions-acting-as-random-number-generators.html"><i class="fa fa-check"></i><b>18.4</b> Functions Acting as Random Number Generators</a></li>
<li class="chapter" data-level="18.5" data-path="user-defined-probability-functions.html"><a href="user-defined-probability-functions.html"><i class="fa fa-check"></i><b>18.5</b> User-Defined Probability Functions</a></li>
<li class="chapter" data-level="18.6" data-path="overloading-functions.html"><a href="overloading-functions.html"><i class="fa fa-check"></i><b>18.6</b> Overloading Functions</a></li>
<li class="chapter" data-level="18.7" data-path="documenting-functions-section.html"><a href="documenting-functions-section.html"><i class="fa fa-check"></i><b>18.7</b> Documenting Functions</a></li>
<li class="chapter" data-level="18.8" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html"><i class="fa fa-check"></i><b>18.8</b> Summary of Function Types</a>
<ul>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#void-vs.-non-void-return"><i class="fa fa-check"></i>Void vs. Non-Void Return</a></li>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#suffixed-or-non-suffixed"><i class="fa fa-check"></i>Suffixed or Non-Suffixed</a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="recursive-functions.html"><a href="recursive-functions.html"><i class="fa fa-check"></i><b>18.9</b> Recursive Functions</a></li>
<li class="chapter" data-level="18.10" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html"><i class="fa fa-check"></i><b>18.10</b> Truncated Random Number Generation</a>
<ul>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#generation-with-inverse-cdfs"><i class="fa fa-check"></i>Generation with Inverse CDFs</a></li>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#truncated-variate-generation"><i class="fa fa-check"></i>Truncated variate generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="custom-probability-functions-chapter.html"><a href="custom-probability-functions-chapter.html"><i class="fa fa-check"></i><b>19</b> Custom Probability Functions</a>
<ul>
<li class="chapter" data-level="19.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>19.1</b> Examples</a>
<ul>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#triangle-distribution"><i class="fa fa-check"></i>Triangle distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#bivariate-normal-cumulative-distribution-function"><i class="fa fa-check"></i>Bivariate normal cumulative distribution function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="problematic-posteriors-chapter.html"><a href="problematic-posteriors-chapter.html"><i class="fa fa-check"></i><b>20</b> Problematic Posteriors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="collinearity-section.html"><a href="collinearity-section.html"><i class="fa fa-check"></i><b>20.1</b> Collinearity of Predictors in Regressions</a>
<ul>
<li class="chapter" data-level="" data-path="collinearity-section.html"><a href="collinearity-section.html#examples-of-collinearity"><i class="fa fa-check"></i>Examples of Collinearity</a></li>
<li class="chapter" data-level="" data-path="collinearity-section.html"><a href="collinearity-section.html#mitigating-the-invariances"><i class="fa fa-check"></i>Mitigating the Invariances</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html"><i class="fa fa-check"></i><b>20.2</b> Label Switching in Mixture Models</a>
<ul>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#mixture-models"><i class="fa fa-check"></i>Mixture Models</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#convergence-monitoring-and-effective-sample-size"><i class="fa fa-check"></i>Convergence Monitoring and Effective Sample Size</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#some-inferences-are-invariant"><i class="fa fa-check"></i>Some Inferences are Invariant</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#highly-multimodal-posteriors"><i class="fa fa-check"></i>Highly Multimodal Posteriors</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#hacks-as-fixes"><i class="fa fa-check"></i>Hacks as Fixes</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="component-collapsing-in-mixture-models.html"><a href="component-collapsing-in-mixture-models.html"><i class="fa fa-check"></i><b>20.3</b> Component Collapsing in Mixture Models</a></li>
<li class="chapter" data-level="20.4" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html"><i class="fa fa-check"></i><b>20.4</b> Posteriors with Unbounded Densities</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#mixture-models-with-varying-scales"><i class="fa fa-check"></i>Mixture Models with Varying Scales</a></li>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#beta-binomial-models-with-skewed-data-and-weak-priors"><i class="fa fa-check"></i>Beta-Binomial Models with Skewed Data and Weak Priors</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html"><i class="fa fa-check"></i><b>20.5</b> Posteriors with Unbounded Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html#separability-in-logistic-regression"><i class="fa fa-check"></i>Separability in Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="uniform-posteriors.html"><a href="uniform-posteriors.html"><i class="fa fa-check"></i><b>20.6</b> Uniform Posteriors</a></li>
<li class="chapter" data-level="20.7" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html"><i class="fa fa-check"></i><b>20.7</b> Sampling Difficulties with Problematic Priors</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#gibbs-sampling"><i class="fa fa-check"></i>Gibbs Sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#hamiltonian-monte-carlo-sampling"><i class="fa fa-check"></i>Hamiltonian Monte Carlo Sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#no-u-turn-sampling"><i class="fa fa-check"></i>No-U-Turn Sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#examples-fits-in-stan"><i class="fa fa-check"></i>Examples: Fits in Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="change-of-variables-chapter.html"><a href="change-of-variables-chapter.html"><i class="fa fa-check"></i><b>21</b> Reparameterization and Change of Variables</a>
<ul>
<li class="chapter" data-level="21.1" data-path="theoretical-and-practical-background.html"><a href="theoretical-and-practical-background.html"><i class="fa fa-check"></i><b>21.1</b> Theoretical and Practical Background</a></li>
<li class="chapter" data-level="21.2" data-path="reparameterizations.html"><a href="reparameterizations.html"><i class="fa fa-check"></i><b>21.2</b> Reparameterizations</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#beta-and-dirichlet-priors"><i class="fa fa-check"></i>Beta and Dirichlet Priors</a></li>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#transforming-unconstrained-priors-probit-and-logit"><i class="fa fa-check"></i>Transforming Unconstrained Priors: Probit and Logit</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="changes-of-variables.html"><a href="changes-of-variables.html"><i class="fa fa-check"></i><b>21.3</b> Changes of Variables</a>
<ul>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#change-of-variables-vs.-transformations"><i class="fa fa-check"></i>Change of Variables vs. Transformations</a></li>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#multivariate-changes-of-variables"><i class="fa fa-check"></i>Multivariate Changes of Variables</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html"><i class="fa fa-check"></i><b>21.4</b> Vectors with Varying Bounds</a>
<ul>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-lower-bounds"><i class="fa fa-check"></i>Varying Lower Bounds</a></li>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-upper-and-lower-bounds"><i class="fa fa-check"></i>Varying Upper and Lower Bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="optimization-chapter.html"><a href="optimization-chapter.html"><i class="fa fa-check"></i><b>22</b> Efficiency Tuning</a>
<ul>
<li class="chapter" data-level="22.1" data-path="what-is-efficiency.html"><a href="what-is-efficiency.html"><i class="fa fa-check"></i><b>22.1</b> What is Efficiency?</a></li>
<li class="chapter" data-level="22.2" data-path="efficiency-for-probabilistic-models-and-algorithms.html"><a href="efficiency-for-probabilistic-models-and-algorithms.html"><i class="fa fa-check"></i><b>22.2</b> Efficiency for Probabilistic Models and Algorithms</a></li>
<li class="chapter" data-level="22.3" data-path="statistical-vs-computational-efficiency.html"><a href="statistical-vs-computational-efficiency.html"><i class="fa fa-check"></i><b>22.3</b> Statistical vs.  Computational Efficiency</a></li>
<li class="chapter" data-level="22.4" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html"><i class="fa fa-check"></i><b>22.4</b> Model Conditioning and Curvature</a>
<ul>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#condition-number-and-adaptation"><i class="fa fa-check"></i>Condition Number and Adaptation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#unit-scales-without-correlation"><i class="fa fa-check"></i>Unit Scales without Correlation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#varying-curvature"><i class="fa fa-check"></i>Varying Curvature</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#reparameterizing-with-a-change-of-variables"><i class="fa fa-check"></i>Reparameterizing with a Change of Variables</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="well-specified-models.html"><a href="well-specified-models.html"><i class="fa fa-check"></i><b>22.5</b> Well-Specified Models</a></li>
<li class="chapter" data-level="22.6" data-path="avoiding-validation.html"><a href="avoiding-validation.html"><i class="fa fa-check"></i><b>22.6</b> Avoiding Validation</a></li>
<li class="chapter" data-level="22.7" data-path="reparameterization-section.html"><a href="reparameterization-section.html"><i class="fa fa-check"></i><b>22.7</b> Reparameterization</a>
<ul>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#example-neals-funnel"><i class="fa fa-check"></i>Example: Neal’s Funnel</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#reparameterizing-the-cauchy"><i class="fa fa-check"></i>Reparameterizing the Cauchy</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#reparameterizing-a-student-t-distribution"><i class="fa fa-check"></i>Reparameterizing a Student-t Distribution</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#hierarchical-models-and-the-non-centered-parameterization"><i class="fa fa-check"></i>Hierarchical Models and the Non-Centered Parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#non-centered-parameterization"><i class="fa fa-check"></i>Non-Centered Parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#multivariate-reparameterizations"><i class="fa fa-check"></i>Multivariate Reparameterizations</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>22.8</b> Vectorization</a>
<ul>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#gradient-bottleneck"><i class="fa fa-check"></i>Gradient Bottleneck</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorizing-summations"><i class="fa fa-check"></i>Vectorizing Summations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorization-through-matrix-operations"><i class="fa fa-check"></i>Vectorization through Matrix Operations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorized-probability-functions"><i class="fa fa-check"></i>Vectorized Probability Functions</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#reshaping-data-for-vectorization"><i class="fa fa-check"></i>Reshaping Data for Vectorization</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="exploiting-sufficient-statistics.html"><a href="exploiting-sufficient-statistics.html"><i class="fa fa-check"></i><b>22.9</b> Exploiting Sufficient Statistics</a></li>
<li class="chapter" data-level="22.10" data-path="aggregating-common-subexpressions.html"><a href="aggregating-common-subexpressions.html"><i class="fa fa-check"></i><b>22.10</b> Aggregating Common Subexpressions</a></li>
<li class="chapter" data-level="22.11" data-path="exploiting-conjugacy.html"><a href="exploiting-conjugacy.html"><i class="fa fa-check"></i><b>22.11</b> Exploiting Conjugacy</a></li>
<li class="chapter" data-level="22.12" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html"><i class="fa fa-check"></i><b>22.12</b> Standardizing Predictors and Outputs</a>
<ul>
<li class="chapter" data-level="" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html#standard-normal-distribution"><i class="fa fa-check"></i>Standard Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="22.13" data-path="using-map-reduce.html"><a href="using-map-reduce.html"><i class="fa fa-check"></i><b>22.13</b> Using Map-Reduce</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="map-reduce-chapter.html"><a href="map-reduce-chapter.html"><i class="fa fa-check"></i><b>23</b> Map-Reduce</a>
<ul>
<li class="chapter" data-level="23.1" data-path="overview-of-map-reduce.html"><a href="overview-of-map-reduce.html"><i class="fa fa-check"></i><b>23.1</b> Overview of Map-Reduce</a></li>
<li class="chapter" data-level="23.2" data-path="map-function.html"><a href="map-function.html"><i class="fa fa-check"></i><b>23.2</b> Map Function</a>
<ul>
<li class="chapter" data-level="" data-path="map-function.html"><a href="map-function.html#map-function-signature"><i class="fa fa-check"></i>Map Function Signature</a></li>
<li class="chapter" data-level="" data-path="map-function.html"><a href="map-function.html#map-function-semantics"><i class="fa fa-check"></i>Map Function Semantics</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="example-mapping-logistic-regression.html"><a href="example-mapping-logistic-regression.html"><i class="fa fa-check"></i><b>23.3</b> Example: Mapping Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="example-mapping-logistic-regression.html"><a href="example-mapping-logistic-regression.html#unmapped-logistic-regression"><i class="fa fa-check"></i>Unmapped Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="example-mapping-logistic-regression.html"><a href="example-mapping-logistic-regression.html#mapped-logistic-regression"><i class="fa fa-check"></i>Mapped Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="example-hierarchical-logistic-regression.html"><a href="example-hierarchical-logistic-regression.html"><i class="fa fa-check"></i><b>23.4</b> Example: Hierarchical Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="example-hierarchical-logistic-regression.html"><a href="example-hierarchical-logistic-regression.html#unmapped-implementation"><i class="fa fa-check"></i>Unmapped Implementation</a></li>
<li class="chapter" data-level="" data-path="example-hierarchical-logistic-regression.html"><a href="example-hierarchical-logistic-regression.html#mapped-implementation"><i class="fa fa-check"></i>Mapped Implementation</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ragged-inputs-and-outputs.html"><a href="ragged-inputs-and-outputs.html"><i class="fa fa-check"></i><b>23.5</b> Ragged Inputs and Outputs</a>
<ul>
<li class="chapter" data-level="" data-path="ragged-inputs-and-outputs.html"><a href="ragged-inputs-and-outputs.html#ragged-inputs"><i class="fa fa-check"></i>Ragged Inputs</a></li>
<li class="chapter" data-level="" data-path="ragged-inputs-and-outputs.html"><a href="ragged-inputs-and-outputs.html#ragged-outputs"><i class="fa fa-check"></i>Ragged Outputs</a></li>
</ul></li>
</ul></li>
<li><a href="appendices-part.html#appendices.part"><i style="font-size: 110%; color:#990017;">Appendices</i></a></li>
<li class="chapter" data-level="24" data-path="stan-program-style-guide.html"><a href="stan-program-style-guide.html"><i class="fa fa-check"></i><b>24</b> Stan Program Style Guide</a>
<ul>
<li class="chapter" data-level="24.1" data-path="choose-a-consistent-style.html"><a href="choose-a-consistent-style.html"><i class="fa fa-check"></i><b>24.1</b> Choose a Consistent Style</a></li>
<li class="chapter" data-level="24.2" data-path="line-length.html"><a href="line-length.html"><i class="fa fa-check"></i><b>24.2</b> Line Length</a></li>
<li class="chapter" data-level="24.3" data-path="file-extensions.html"><a href="file-extensions.html"><i class="fa fa-check"></i><b>24.3</b> File Extensions</a></li>
<li class="chapter" data-level="24.4" data-path="variable-naming.html"><a href="variable-naming.html"><i class="fa fa-check"></i><b>24.4</b> Variable Naming</a></li>
<li class="chapter" data-level="24.5" data-path="local-variable-scope.html"><a href="local-variable-scope.html"><i class="fa fa-check"></i><b>24.5</b> Local Variable Scope</a>
<ul>
<li class="chapter" data-level="" data-path="local-variable-scope.html"><a href="local-variable-scope.html#scope-of-compound-structures-with-componentwise-assignment"><i class="fa fa-check"></i>Scope of Compound Structures with Componentwise Assignment</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html"><i class="fa fa-check"></i><b>24.6</b> Parentheses and Brackets</a>
<ul>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#optional-parentheses-for-single-statement-blocks"><i class="fa fa-check"></i>Optional Parentheses for Single-Statement Blocks</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#parentheses-in-nested-operator-expressions"><i class="fa fa-check"></i>Parentheses in Nested Operator Expressions</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#no-open-brackets-on-own-line"><i class="fa fa-check"></i>No Open Brackets on Own Line</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>24.7</b> Conditionals</a>
<ul>
<li class="chapter" data-level="" data-path="conditionals.html"><a href="conditionals.html#explicit-comparisons-of-non-boolean-conditions"><i class="fa fa-check"></i>Explicit Comparisons of Non-Boolean Conditions</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>24.8</b> Functions</a></li>
<li class="chapter" data-level="24.9" data-path="white-space.html"><a href="white-space.html"><i class="fa fa-check"></i><b>24.9</b> White Space</a>
<ul>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#line-breaks-between-statements-and-declarations"><i class="fa fa-check"></i>Line Breaks Between Statements and Declarations</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-tabs"><i class="fa fa-check"></i>No Tabs</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#two-character-indents"><i class="fa fa-check"></i>Two-Character Indents</a></li>
<li class="chapter" data-level="24.9.1" data-path="white-space.html"><a href="white-space.html#space-between-if-and-condition"><i class="fa fa-check"></i><b>24.9.1</b> Space Between <code>if</code>, <code>{</code> and Condition</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-space-for-function-calls"><i class="fa fa-check"></i>No Space For Function Calls</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-around-operators"><i class="fa fa-check"></i>Spaces Around Operators</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#breaking-expressions-across-lines"><i class="fa fa-check"></i>Breaking Expressions across Lines</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#optional-spaces-after-commas"><i class="fa fa-check"></i>Optional Spaces after Commas</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#unix-newlines"><i class="fa fa-check"></i>Unix Newlines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="stan-for-bugs-appendix.html"><a href="stan-for-bugs-appendix.html"><i class="fa fa-check"></i><b>25</b> Transitioning from BUGS</a>
<ul>
<li class="chapter" data-level="25.1" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html"><i class="fa fa-check"></i><b>25.1</b> Some Differences in How BUGS and Stan Work</a>
<ul>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-is-interpreted-stan-is-compiled"><i class="fa fa-check"></i>BUGS is interpreted, Stan is compiled</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-performs-mcmc-updating-one-scalar-parameter-at-a-time-stan-uses-hmc-which-moves-in-the-entire-space-of-all-the-parameters-at-each-step"><i class="fa fa-check"></i>BUGS performs MCMC updating one scalar parameter at a time, Stan uses HMC which moves in the entire space of all the parameters at each step</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-tuning-during-warmup"><i class="fa fa-check"></i>Differences in tuning during warmup</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#the-stan-language-is-directly-executable-the-bugs-modeling-language-is-not"><i class="fa fa-check"></i>The Stan language is directly executable, the BUGS modeling language is not</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-statement-order"><i class="fa fa-check"></i>Differences in statement order</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#stan-computes-the-gradient-of-the-log-density-bugs-computes-the-log-density-but-not-its-gradient"><i class="fa fa-check"></i>Stan computes the gradient of the log density, BUGS computes the log density but not its gradient</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#both-bugs-and-stan-are-semi-automatic"><i class="fa fa-check"></i>Both BUGS and Stan are semi-automatic</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#licensing"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#interfaces"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#platforms"><i class="fa fa-check"></i>Platforms</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="some-differences-in-the-modeling-languages.html"><a href="some-differences-in-the-modeling-languages.html"><i class="fa fa-check"></i><b>25.2</b> Some Differences in the Modeling Languages</a></li>
<li class="chapter" data-level="25.3" data-path="some-differences-in-the-statistical-models-that-are-allowed.html"><a href="some-differences-in-the-statistical-models-that-are-allowed.html"><i class="fa fa-check"></i><b>25.3</b> Some Differences in the Statistical Models that are Allowed</a></li>
<li class="chapter" data-level="25.4" data-path="some-differences-when-running-from-r.html"><a href="some-differences-when-running-from-r.html"><i class="fa fa-check"></i><b>25.4</b> Some Differences when Running from R</a></li>
<li class="chapter" data-level="25.5" data-path="the-stan-community.html"><a href="the-stan-community.html"><i class="fa fa-check"></i><b>25.5</b> The Stan Community</a></li>
</ul></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div>
This is an old version, <a href="https://mc-stan.org/docs/stan-users-guide/reparameterization.html">view current version</a>.
</div>
<div id="reparameterization.section" class="section level2">
<h2 number="22.7"><span class="header-section-number">22.7</span> Reparameterization</h2>
<p>Stan’s sampler can be slow in sampling from distributions with
difficult posterior geometries. One way to speed up such models is
through reparameterization. In some cases, reparameterization can
dramatically increase effective sample size for the same number of
iterations or even make programs that would not converge well
behaved.</p>
<div id="example-neals-funnel" class="section level3">
<h3 class="unnumbered" number="">Example: Neal’s Funnel</h3>
<p>In this section, we discuss a general transform from a centered to a
non-centered parameterization <span class="citation">(Papaspiliopoulos, Roberts, and Sköld <a href="references.html#ref-papa-et-al:2007" role="doc-biblioref">2007</a>)</span>.<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a></p>
<p>This reparameterization is helpful when there is not much data,
because it separates the hierarchical parameters and lower-level
parameters in the prior.</p>
<p><span class="citation">Neal (<a href="references.html#ref-Neal:2003" role="doc-biblioref">2003</a>)</span> defines a distribution that exemplifies the difficulties of
sampling from some hierarchical models. Neal’s example is fairly
extreme, but can be trivially reparameterized in such a way as to make
sampling straightforward. Neal’s example has support for <span class="math inline">\(y \in \mathbb{R}\)</span> and <span class="math inline">\(x \in \mathbb{R}^9\)</span> with density</p>
<p><span class="math display">\[
p(y,x) = \mathsf{normal}(y|0,3) * \prod_{n=1}^9
\mathsf{normal}(x_n|0,\exp(y/2)).
\]</span></p>
<p>The probability contours are shaped like ten-dimensional funnels. The
funnel’s neck is particularly sharp because of the exponential
function applied to <span class="math inline">\(y\)</span>. A plot of the log marginal density of <span class="math inline">\(y\)</span>
and the first dimension <span class="math inline">\(x_1\)</span> is shown in the following plot.</p>
<p>The marginal density of Neal’s funnel for the upper-level variable <span class="math inline">\(y\)</span> and one lower-level variable <span class="math inline">\(x_1\)</span> (see the text for the formula). The blue region has log density greater than -8, the yellow region density greater than -16, and the gray background a density less than -16.</p>
<div class="figure">
<img src="img/funnel.png" alt="" />
<p class="caption">Neal’s funnel density</p>
</div>
<p>The funnel can be implemented directly in Stan as follows.</p>
<pre><code>parameters {
  real y;
  vector[9] x;
}
model {
  y ~ normal(0, 3);
  x ~ normal(0, exp(y/2));
}</code></pre>
<p>When the model is expressed this way, Stan has trouble sampling from
the neck of the funnel, where <span class="math inline">\(y\)</span> is small and thus <span class="math inline">\(x\)</span> is constrained
to be near 0. This is due to the fact that the density’s scale
changes with <span class="math inline">\(y\)</span>, so that a step size that works well in the body will
be too large for the neck, and a step size that works in the neck will be
inefficient in the body. This can be seen in the following plot.</p>
<p>4000 draws are taken from a run of Stan’s sampler with default settings. Both
plots are restricted to the shown window of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> values; some
draws fell outside of the displayed area as would be expected given
the density. The samples are consistent with the marginal density
<span class="math inline">\(p(y) = \mathsf{normal}(y|0,3)\)</span>, which has mean 0 and standard
deviation 3.</p>
<p><img src="img/funnel-fit.png" /></p>
<p>In this particular instance, because the analytic form of the density
from which samples are drawn is known, the model can be converted to
the following more efficient form.</p>
<pre><code>parameters {
  real y_raw;
  vector[9] x_raw;
}
transformed parameters {
  real y;
  vector[9] x;

  y = 3.0 * y_raw;
  x = exp(y/2) * x_raw;
}
model {
  y_raw ~ std_normal(); // implies y ~ normal(0, 3)
  x_raw ~ std_normal(); // implies x ~ normal(0, exp(y/2))
}</code></pre>
<p>In this second model, the parameters <code>x_raw</code> and <code>y_raw</code> are
sampled as independent standard normals, which is easy for Stan. These
are then transformed into samples from the funnel. In this case, the
same transform may be used to define Monte Carlo samples directly
based on independent standard normal samples; Markov chain Monte Carlo
methods are not necessary. If such a reparameterization were used in
Stan code, it is useful to provide a comment indicating what the
distribution for the parameter implies for the distribution of the
transformed parameter.</p>
</div>
<div id="reparameterizing-the-cauchy" class="section level3">
<h3 class="unnumbered" number="">Reparameterizing the Cauchy</h3>
<p>Sampling from heavy tailed distributions such as the Cauchy is
difficult for Hamiltonian Monte Carlo, which operates within a
Euclidean geometry.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a></p>
<p>The practical problem is that tail of the Cauchy
requires a relatively large step size compared to the trunk. With a
small step size, the No-U-Turn sampler requires many steps when
starting in the tail of the distribution; with a large step size,
there will be too much rejection in the central portion of the
distribution. This problem may be mitigated by defining the
Cauchy-distributed variable as the transform of a uniformly
distributed variable using the Cauchy inverse cumulative distribution
function.</p>
<p>Suppose a random variable of interest <span class="math inline">\(X\)</span> has a Cauchy distribution
with location <span class="math inline">\(\mu\)</span> and scale <span class="math inline">\(\tau\)</span>, so that <span class="math inline">\(X \sim \mathsf{Cauchy}(\mu,\tau)\)</span>. The variable <span class="math inline">\(X\)</span> has a cumulative
distribution function <span class="math inline">\(F_X:\mathbb{R} \rightarrow (0,1)\)</span> defined by
<span class="math display">\[
F_X(x) = \frac{1}{\pi} \arctan \left( \frac{x - \mu}{\tau} \right) +
\frac{1}{2}.
\]</span>
The inverse of the cumulative distribution function,
<span class="math inline">\(F_X^{-1}:(0,1) \rightarrow \mathbb{R}\)</span>, is thus</p>
<p><span class="math display">\[
F^{-1}_X(y) = \mu + \tau \tan \left( \pi \left( y - \frac{1}{2} \right) \right).
\]</span>
Thus if the random variable <span class="math inline">\(Y\)</span> has a unit uniform distribution, <span class="math inline">\(Y \sim \mathsf{Uniform}(0,1)\)</span>, then <span class="math inline">\(F^{-1}_X(Y)\)</span> has a Cauchy
distribution with location <span class="math inline">\(\mu\)</span> and scale <span class="math inline">\(\tau\)</span>, i.e., <span class="math inline">\(F^{-1}_X(Y) \sim \mathsf{Cauchy}(\mu,\tau)\)</span>.</p>
<p>Consider a Stan program involving a Cauchy-distributed parameter
<code>beta</code>.</p>
<pre><code>parameters {
  real beta;
  ...
}
model {
  beta ~ cauchy(mu, tau);
  ...
}</code></pre>
<p>This declaration of <code>beta</code> as a parameter may be replaced with a
transformed parameter <code>beta</code> defined in terms of a
uniform-distributed parameter <code>beta_unif</code>.</p>
<pre><code>parameters {
  real&lt;lower=-pi()/2, upper=pi()/2&gt; beta_unif;
  ...
}
transformed parameters {
  real beta;
  beta = mu + tau * tan(beta_unif);  // beta ~ cauchy(mu, tau)
}
model {
  beta_unif ~ uniform(-pi()/2, pi()/2);  // not necessary
  ...
}</code></pre>
<p>It is more convenient in Stan to transform a uniform variable on
<span class="math inline">\((-\pi/2, \pi/2)\)</span> than one on <span class="math inline">\((0,1)\)</span>. The Cauchy location and scale
parameters, <code>mu</code> and <code>tau</code>, may be defined as data or may
themselves be parameters. The variable <code>beta</code> could also be
defined as a local variable if it does not need to be included in the
sampler’s output.</p>
<p>The uniform distribution on <code>beta_unif</code> is defined explicitly in
the model block, but it could be safely removed from the program
without changing sampling behavior. This is because <span class="math inline">\(\log \mathsf{Uniform}(\beta_{\mathrm{unif}}|-\pi/2,\pi/2) = -\log \pi\)</span> is a constant and Stan only
needs the total log probability up to an additive constant. Stan will spend
some time checking that that <code>beta_unif</code> is between
<code>-pi()/2</code> and <code>pi()/2</code>, but this condition is guaranteed by
the constraints in the declaration of <code>beta_unif</code>.</p>
</div>
<div id="reparameterizing-a-student-t-distribution" class="section level3">
<h3 class="unnumbered" number="">Reparameterizing a Student-t Distribution</h3>
<p>One thing that sometimes works when you’re having trouble with the
heavy-tailedness of Student-t distributions is to use the
gamma-mixture representation, which says that you can generate a
Student-t distributed variable <span class="math inline">\(\beta\)</span>,
<span class="math display">\[
\beta \sim \mathsf{Student-t}(\nu, 0, 1),
\]</span>
by first generating a gamma-distributed precision (inverse variance)
<span class="math inline">\(\tau\)</span> according to
<span class="math display">\[
\tau \sim \mathsf{Gamma}(\nu/2, \nu/2),
\]</span>
and then generating <span class="math inline">\(\beta\)</span> from the normal distribution,
<span class="math display">\[
\beta \sim \mathsf{normal}(0,\tau^{-\frac{1}{2}}).
\]</span></p>
<p>Because <span class="math inline">\(\tau\)</span> is precision, <span class="math inline">\(\tau^{-\frac{1}{2}}\)</span> is the scale
(standard deviation), which is the parameterization used by Stan.</p>
<p>The marginal distribution of <span class="math inline">\(\beta\)</span> when you integrate out <span class="math inline">\(\tau\)</span> is
<span class="math inline">\(\mathsf{Student-t}(\nu, 0, 1)\)</span>, i.e.,
<span class="math display">\[
\mathsf{Student-t}(\beta | \nu, 0, 1).
=
\int_0^{\infty}
\,
\mathsf{normal}(\beta | 0, \tau^{-0.5})
*
\mathsf{Gamma}(\tau | \nu/2, \nu/2)
\
\mathrm{d} \tau.
\]</span></p>
<p>To go one step further, instead of defining a <span class="math inline">\(\beta\)</span> drawn from a
normal with precision <span class="math inline">\(\tau\)</span>, define <span class="math inline">\(\alpha\)</span> to be drawn from a unit
normal,</p>
<p><span class="math display">\[
\alpha \sim \mathsf{normal}(0,1)
\]</span></p>
<p>and rescale by defining</p>
<p><span class="math display">\[
\beta = \alpha \, \tau^{-\frac{1}{2}}.
\]</span></p>
<p>Now suppose <span class="math inline">\(\mu = \beta x\)</span> is the product of <span class="math inline">\(\beta\)</span> with a
regression predictor <span class="math inline">\(x\)</span>. Then the reparameterization <span class="math inline">\(\mu = \alpha \tau^{-\frac{1}{2}} x\)</span> has the same distribution, but in the original, direct
parameterization, <span class="math inline">\(\beta\)</span> has (potentially) heavy tails, whereas in
the second, neither <span class="math inline">\(\tau\)</span> nor <span class="math inline">\(\alpha\)</span> have heavy tails.</p>
<p>To translate into Stan notation, this reparameterization replaces</p>
<pre><code>parameters {
  real&lt;lower=0&gt; nu;
  real beta;
  ...
model {
  beta ~ student_t(nu, 0, 1);
  ...</code></pre>
<p>with</p>
<pre><code>parameters {
  real&lt;lower=0&gt; nu;
  real&lt;lower=0&gt; tau;
  real alpha;
  ...
transformed parameters {
  real beta;
  beta = alpha / sqrt(tau);
  ...
model {
  real half_nu;
  half_nu = 0.5 * nu;
  tau ~ gamma(half_nu, half_nu);
  alpha ~ std_normal();
  ...</code></pre>
<p>Although set to <code>0</code> here, in most cases, the lower bound for the
degrees of freedom parameter <code>nu</code> can be set to <code>1</code> or
higher; when <code>nu</code> is 1, the result is a Cauchy distribution with
fat tails and as <code>nu</code> approaches infinity, the Student-t
distribution approaches a normal distribution. Thus the parameter
<code>nu</code> characterizes the heaviness of the tails of the model.</p>
</div>
<div id="hierarchical-models-and-the-non-centered-parameterization" class="section level3">
<h3 class="unnumbered" number="">Hierarchical Models and the Non-Centered Parameterization</h3>
<p>Unfortunately, the usual situation in applied Bayesian modeling
involves complex geometries and interactions that are not known
analytically. Nevertheless, reparameterization can still be
effective for separating parameters.</p>
<div id="centered-parameterization" class="section level4">
<h4 class="unnumbered" number="">Centered parameterization</h4>
<p>For example, a vectorized hierarchical model might draw a vector of
coefficients <span class="math inline">\(\beta\)</span> with definitions as follows. The so-called
centered parameterization is as follows.</p>
<pre><code>parameters {
  real mu_beta;
  real&lt;lower=0&gt; sigma_beta;
  vector[K] beta;
  ...
model {
  beta ~ normal(mu_beta, sigma_beta);
  ...</code></pre>
<p>Although not shown, a full model will have priors on both
<code>mu_beta</code> and <code>sigma_beta</code> along with data modeled based on
these coefficients. For instance, a standard binary logistic
regression with data matrix <code>x</code> and binary outcome vector
<code>y</code> would include a likelihood statement such as form
<code>y ~ bernoulli_logit(x * beta)</code>, leading to an analytically
intractable posterior.</p>
<p>A hierarchical model such as the above will suffer from the same kind
of inefficiencies as Neal’s funnel, because the values of <code>beta</code>,
<code>mu_beta</code> and <code>sigma_beta</code> are highly correlated in the
posterior. The extremity of the correlation depends on the amount of
data, with Neal’s funnel being the extreme with no data. In these
cases, the non-centered parameterization, discussed in the next
section, is preferable; when there is a lot of data, the centered
parameterization is more efficient. See
<span class="citation">Betancourt and Girolami (<a href="references.html#ref-Betancourt-Girolami:2013" role="doc-biblioref">2013</a>)</span> for more information on the effects of
centering in hierarchical models fit with Hamiltonian Monte Carlo.</p>
</div>
</div>
<div id="non-centered-parameterization" class="section level3">
<h3 class="unnumbered" number="">Non-Centered Parameterization</h3>
<p>Sometimes the group-level effects do not constrain the hierarchical
distribution tightly. Examples arise when there are not many groups,
or when the inter-group variation is high. In such cases,
hierarchical models can be made much more efficient by shifting the
data’s correlation with the parameters to the hyperparameters. Similar
to the funnel example, this will be much more efficient in terms of
effective sample size when there is not much data (see
<span class="citation">Betancourt and Girolami (<a href="references.html#ref-Betancourt-Girolami:2013" role="doc-biblioref">2013</a>)</span>), and in more extreme cases will be
necessary to achieve convergence.</p>
<pre><code>parameters {
  vector[K] beta_raw;
  ...
transformed parameters {
  vector[K] beta;
  // implies: beta ~ normal(mu_beta, sigma_beta)
  beta = mu_beta + sigma_beta * beta_raw;
model {
  beta_raw ~ std_normal();
  ...</code></pre>
<p>Any priors defined for <code>mu_beta</code> and <code>sigma_beta</code> remain as
defined in the original model.</p>
<p>Reparameterization of hierarchical models is not limited to the normal
distribution, although the normal distribution is the best candidate
for doing so. In general, any distribution of parameters in the
location-scale family is a good candidate for reparameterization. Let
<span class="math inline">\(\beta = l + s\alpha\)</span> where <span class="math inline">\(l\)</span> is a location parameter and <span class="math inline">\(s\)</span> is a
scale parameter. The parameter <span class="math inline">\(l\)</span> need not be the mean, <span class="math inline">\(s\)</span> need not
be the standard deviation, and neither the mean nor the standard
deviation need to exist. If <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are from the same
distributional family but <span class="math inline">\(\alpha\)</span> has location zero and unit scale,
while <span class="math inline">\(\beta\)</span> has location <span class="math inline">\(l\)</span> and scale <span class="math inline">\(s\)</span>, then that distribution
is a location-scale distribution. Thus, if <span class="math inline">\(\alpha\)</span> were a parameter
and <span class="math inline">\(\beta\)</span> were a transformed parameter, then a prior distribution
from the location-scale family on <span class="math inline">\(\alpha\)</span> with location zero and unit
scale implies a prior distribution on <span class="math inline">\(\beta\)</span> with location <span class="math inline">\(l\)</span> and
scale <span class="math inline">\(s\)</span>. Doing so would reduce the dependence between <span class="math inline">\(\alpha\)</span>,
<span class="math inline">\(l\)</span>, and <span class="math inline">\(s\)</span>.</p>
<p>There are several univariate distributions in the location-scale
family, such as the Student t distribution, including its special
cases of the Cauchy distribution (with one degree of freedom) and the
normal distribution (with infinite degrees of freedom). As shown above,
if <span class="math inline">\(\alpha\)</span> is distributed standard normal, then <span class="math inline">\(\beta\)</span> is distributed
normal with mean <span class="math inline">\(\mu = l\)</span> and standard deviation <span class="math inline">\(\sigma = s\)</span>. The
logistic, the double exponential, the generalized extreme value
distributions, and the stable distribution are also in the
location-scale family.</p>
<p>Also, if <span class="math inline">\(z\)</span> is distributed standard normal, then <span class="math inline">\(z^2\)</span> is distributed
chi-squared with one degree of freedom. By summing the squares of <span class="math inline">\(K\)</span>
independent standard normal variates, one can obtain a single variate
that is distributed chi-squared with <span class="math inline">\(K\)</span> degrees of freedom. However,
for large <span class="math inline">\(K\)</span>, the computational gains of this reparameterization may
be overwhelmed by the computational cost of specifying <span class="math inline">\(K\)</span> primitive
parameters just to obtain one transformed parameter to use in a model.</p>
</div>
<div id="multivariate-reparameterizations" class="section level3">
<h3 class="unnumbered" number="">Multivariate Reparameterizations</h3>
<p>The benefits of reparameterization are not limited to univariate
distributions. A parameter with a multivariate normal prior distribution
is also an excellent candidate for reparameterization. Suppose you intend
the prior for <span class="math inline">\(\beta\)</span> to be multivariate normal with mean vector <span class="math inline">\(\mu\)</span>
and covariance matrix <span class="math inline">\(\Sigma\)</span>. Such a belief is reflected by the
following code.</p>
<pre><code>data {
  int&lt;lower=2&gt; K;
  vector[K] mu;
  cov_matrix[K] Sigma;
  ...
parameters {
  vector[K] beta;
  ...
model {
  beta ~ multi_normal(mu, Sigma);
  ...</code></pre>
<p>In this case <code>mu</code> and <code>Sigma</code> are fixed data, but they could
be unknown parameters, in which case their priors would be unaffected
by a reparameterization of <code>beta</code>.</p>
<p>If <span class="math inline">\(\alpha\)</span> has the same dimensions as <span class="math inline">\(\beta\)</span> but the elements of
<span class="math inline">\(\alpha\)</span> are independently and identically distributed standard normal
such that <span class="math inline">\(\beta = \mu + L\alpha\)</span>, where <span class="math inline">\(LL^\top = \Sigma\)</span>, then
<span class="math inline">\(\beta\)</span> is distributed multivariate normal with mean vector <span class="math inline">\(\mu\)</span> and
covariance matrix <span class="math inline">\(\Sigma\)</span>. One choice for <span class="math inline">\(L\)</span> is the Cholesky factor
of <span class="math inline">\(\Sigma\)</span>. Thus, the model above could be reparameterized as follows.</p>
<pre><code>data {
  int&lt;lower=2&gt; K;
  vector[K] mu;
  cov_matrix[K] Sigma;
  ...
transformed data {
  matrix[K, K] L;
  L = cholesky_decompose(Sigma);
}
parameters {
  vector[K] alpha;
  ...
transformed parameters {
  vector[K] beta;
  beta = mu + L * alpha;
}
model {
  alpha ~ std_normal();
  // implies: beta ~ multi_normal(mu, Sigma)
  ...</code></pre>
<p>This reparameterization is more efficient for two reasons. First, it
reduces dependence among the elements of <code>alpha</code> and second, it
avoids the need to invert <code>Sigma</code> every time <code>multi_normal</code>
is evaluated.</p>
<p>The Cholesky factor is also useful when a covariance matrix is
decomposed into a correlation matrix that is multiplied from both
sides by a diagonal matrix of standard deviations, where either the
standard deviations or the correlations are unknown parameters. The
Cholesky factor of the covariance matrix is equal to the product of
a diagonal matrix of standard deviations and the Cholesky factor of
the correlation matrix. Furthermore, the product of a diagonal matrix
of standard deviations and a vector is equal to the elementwise
product between the standard deviations and that vector. Thus, if for
example the correlation matrix <code>Tau</code> were fixed data but the
vector of standard deviations <code>sigma</code> were unknown parameters,
then a reparameterization of <code>beta</code> in terms of <code>alpha</code>
could be implemented as follows.</p>
<pre><code>data {
  int&lt;lower=2&gt; K;
  vector[K] mu;
  corr_matrix[K] Tau;
  ...
transformed data {
  matrix[K, K] L;
  L = cholesky_decompose(Tau);
}
parameters {
  vector[K] alpha;
  vector&lt;lower=0&gt;[K] sigma;
  ...
transformed parameters {
  vector[K] beta;
  // This equals mu + diag_matrix(sigma) * L * alpha;
  beta = mu + sigma .* (L * alpha);
}
model {
  sigma ~ cauchy(0, 5);
  alpha ~ std_normal();
  // implies: beta ~ multi_normal(mu,
  //  diag_matrix(sigma) * L * L&#39; * diag_matrix(sigma)))
  ...</code></pre>
<p>This reparameterization of a multivariate normal distribution in
terms of standard normal variates can be extended to other multivariate
distributions that can be conceptualized as contaminations of the
multivariate normal, such as the multivariate Student t and the skew
multivariate normal distribution.</p>
<p>A Wishart distribution can also be reparameterized in terms of standard
normal variates and chi-squared variates. Let <span class="math inline">\(L\)</span> be the Cholesky factor
of a <span class="math inline">\(K \times K\)</span> positive definite scale matrix <span class="math inline">\(S\)</span> and let <span class="math inline">\(\nu\)</span> be
the degrees of freedom. If</p>
<p><span class="math display">\[\begin{equation*}
A = \left( \begin{array}{cccc}
\sqrt{c_{1}} &amp; 0 &amp; \cdots &amp; 0\\
z_{21} &amp; \sqrt{c_{2}} &amp; \ddots &amp; \vdots\\
\vdots &amp; \ddots &amp; \ddots &amp; 0\\
z_{K1} &amp; \cdots &amp; z_{K\left(K-1\right)} &amp; \sqrt{c_{K}}
 \end{array} \right),
\end{equation*}\]</span></p>
<p>where each <span class="math inline">\(c_i\)</span> is distributed chi-squared with <span class="math inline">\(\nu - i + 1\)</span> degrees
of freedom and each <span class="math inline">\(z_{ij}\)</span> is distributed standard normal, then
<span class="math inline">\(W = LAA^{\top}L^{\top}\)</span> is distributed Wishart with scale matrix
<span class="math inline">\(S = LL^{\top}\)</span> and degrees of freedom <span class="math inline">\(\nu\)</span>. Such a reparameterization
can be implemented by the following Stan code:</p>
<pre><code>data {
  int&lt;lower=1&gt; N;
  int&lt;lower=1&gt; K;
  int&lt;lower=K+2&gt; nu
  matrix[K, K] L; // Cholesky factor of scale matrix
  vector[K] mu;
  matrix[N, K] y;
  ...
parameters {
  vector&lt;lower=0&gt;[K] c;
  vector[0.5 * K * (K - 1)] z;
  ...
model {
  matrix[K, K] A;
  int count = 1;
  for (j in 1:(K-1)) {
    for (i in (j+1):K) {
      A[i, j] = z[count];
      count += 1;
    }
    for (i in 1:(j - 1)) {
      A[i, j] = 0.0;
    }
    A[j, j] = sqrt(c[j]);
  }
  for (i in 1:(K-1))
    A[i, K] = 0;
  A[K, K] = sqrt(c[K]);

  for (i in 1:K)
    c[i] ~ chi_square(nu - i + 1);

  z ~ std_normal();
  // implies: L * A * A&#39; * L&#39; ~ wishart(nu, L * L&#39;)
  y ~ multi_normal_cholesky(mu, L * A);
  ...</code></pre>
<p>This reparameterization is more efficient for three reasons. First, it
reduces dependence among the elements of <code>z</code> and second, it
avoids the need to invert the covariance matrix, <span class="math inline">\(W\)</span> every time
<code>wishart</code> is evaluated. Third, if <span class="math inline">\(W\)</span> is to be used with a
multivariate normal distribution, you can pass <span class="math inline">\(L A\)</span> to the more
efficient <code>multi_normal_cholesky</code> function, rather than passing
<span class="math inline">\(W\)</span> to <code>multi_normal</code>.</p>
<p>If <span class="math inline">\(W\)</span> is distributed Wishart with scale matrix <span class="math inline">\(S\)</span> and degrees of
freedom <span class="math inline">\(\nu\)</span>, then <span class="math inline">\(W^{-1}\)</span> is distributed inverse Wishart with inverse
scale matrix <span class="math inline">\(S^{-1}\)</span> and degrees of freedom <span class="math inline">\(\nu\)</span>. Thus, the previous
result can be used to reparameterize the inverse Wishart distribution.
Since <span class="math inline">\(W = L * A * A^{\top} * L^{\top}\)</span>,
<span class="math inline">\(W^{-1} = L^{{\top}^{-1}} A^{{\top}^{-1}} A^{-1} L^{-1}\)</span>, where all four
inverses exist, but
<span class="math inline">\(L^{{-1}^{\top}} = L^{{\top}^{-1}}\)</span> and <span class="math inline">\(A^{{-1}^{\top}} = A^{{\top}^{-1}}\)</span>.
We can slightly modify the above Stan code for this case:</p>
<pre><code>data {
  int&lt;lower=1&gt; K;
  int&lt;lower=K+2&gt; nu
  matrix[K, K] L; // Cholesky factor of scale matrix
  ...
transformed data {
  matrix[K, K] eye;
  matrix[K, K] L_inv;
  for (j in 1:K) {
    for (i in 1:K) {
      eye[i, j] = 0.0;
    }
    eye[j, j] = 1.0;
  }
  L_inv = mdivide_left_tri_low(L, eye);
}
parameters {
  vector&lt;lower=0&gt;[K] c;
  vector[0.5 * K * (K - 1)] z;
  ...
model {
  matrix[K, K] A;
  matrix[K, K] A_inv_L_inv;
  int count;
  count = 1;
  for (j in 1:(K-1)) {
    for (i in (j+1):K) {
      A[i, j] = z[count];
      count += 1;
    }
    for (i in 1:(j - 1)) {
      A[i, j] = 0.0;
    }
    A[j, j] = sqrt(c[j]);
  }
  for (i in 1:(K-1))
    A[i, K] = 0;
  A[K, K] = sqrt(c[K]);

  A_inv_L_inv = mdivide_left_tri_low(A, L_inv);
  for (i in 1:K)
    c[i] ~ chi_square(nu - i + 1);

  z ~ std_normal(); // implies: crossprod(A_inv_L_inv) ~
  // inv_wishart(nu, L_inv&#39; * L_inv)
  ...</code></pre>
<p>Another candidate for reparameterization is the Dirichlet distribution
with all <span class="math inline">\(K\)</span> shape parameters equal. <span class="citation">Zyczkowski and Sommers (<a href="references.html#ref-ZyczkowskiSommers:2001" role="doc-biblioref">2001</a>)</span> shows
that if <span class="math inline">\(\theta_i\)</span> is equal to the sum of <span class="math inline">\(\beta\)</span> independent squared
standard normal variates and <span class="math inline">\(\rho_i = \frac{\theta_i}{\sum \theta_i}\)</span>,
then the <span class="math inline">\(K\)</span>-vector <span class="math inline">\(\rho\)</span> is distributed Dirichlet with all shape
parameters equal to <span class="math inline">\(\frac{\beta}{2}\)</span>. In particular, if <span class="math inline">\(\beta = 2\)</span>,
then <span class="math inline">\(\rho\)</span> is uniformly distributed on the unit simplex. Thus, we can
make <span class="math inline">\(\rho\)</span> be a transformed parameter to reduce dependence, as in:</p>
<pre><code>data {
  int&lt;lower=1&gt; beta;
  ...
parameters {
  vector[beta] z[K];
  ...
transformed parameters {
  simplex[K] rho;
  for (k in 1:K)
    rho[k] = dot_self(z[k]); // sum-of-squares
  rho = rho / sum(rho);
}
model {
  for (k in 1:K)
    z[k] ~ std_normal();
  // implies: rho ~ dirichlet(0.5 * beta * ones)
  ...</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="39">
<li id="fn39"><p>This parameterization came to be known on our mailing lists as the “Matt trick” after Matt Hoffman, who independently came up with it while fitting hierarchical models in Stan.<a href="reparameterization-section.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>Riemannian Manifold Hamiltonian Monte Carlo (RMHMC) overcomes this difficulty by simulating the Hamiltonian dynamics in a space with a position-dependent metric; see <span class="citation">Girolami and Calderhead (<a href="references.html#ref-GirolamiCalderhead:2011" role="doc-biblioref">2011</a>)</span> and <span class="citation">Betancourt (<a href="references.html#ref-Betancourt:2012" role="doc-biblioref">2012</a>)</span>.<a href="reparameterization-section.html#fnref40" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="avoiding-validation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vectorization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
