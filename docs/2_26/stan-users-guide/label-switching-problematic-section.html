<!DOCTYPE html>
<html lang="" xml:lang="">
<head>
<link rel="canonical" href="https://mc-stan.org/docs/stan-users-guide/problematic-posteriors.html#label-switching-problematic.section" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>20.2 Label switching in mixture models | Stan User’s Guide</title>
  <meta name="description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="20.2 Label switching in mixture models | Stan User’s Guide" />
  <meta property="og:type" content="book" />

  <meta property="og:image" content="img/logo-tm.pdf" />
  <meta property="og:description" content="Stan user’s guide with examples and programming techniques." />


  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="20.2 Label switching in mixture models | Stan User’s Guide" />

  <meta name="twitter:description" content="Stan user’s guide with examples and programming techniques." />
  <meta name="twitter:image" content="img/logo-tm.pdf" />

<meta name="author" content="Stan Development Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />


<link rel="prev" href="collinearity-section.html"/>
<link rel="next" href="component-collapsing-in-mixture-models.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />



<link rel="stylesheet" href="stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/stan-users-guide/index.html" style="color:#4183C4">Stan User's Guide</a></li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li><a href="example-models-part.html#example-models.part"><i style="font-size: 110%; color:#990017;">Part 1. Example Models</i></a></li>
<li class="chapter" data-level="1" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>1</b> Regression Models</a><ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1.1</b> Linear regression</a><ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#vectorization.section"><i class="fa fa-check"></i>Matrix notation and vectorization</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="QR-reparameterization-section.html"><a href="QR-reparameterization-section.html"><i class="fa fa-check"></i><b>1.2</b> The QR reparameterization</a></li>
<li class="chapter" data-level="1.3" data-path="regression-priors-section.html"><a href="regression-priors-section.html"><i class="fa fa-check"></i><b>1.3</b> Priors for coefficients and scales</a></li>
<li class="chapter" data-level="1.4" data-path="robust-noise-models.html"><a href="robust-noise-models.html"><i class="fa fa-check"></i><b>1.4</b> Robust noise models</a></li>
<li class="chapter" data-level="1.5" data-path="logistic-probit-regression-section.html"><a href="logistic-probit-regression-section.html"><i class="fa fa-check"></i><b>1.5</b> Logistic and probit regression</a></li>
<li class="chapter" data-level="1.6" data-path="multi-logit-section.html"><a href="multi-logit-section.html"><i class="fa fa-check"></i><b>1.6</b> Multi-logit regression</a><ul>
<li class="chapter" data-level="" data-path="multi-logit-section.html"><a href="multi-logit-section.html#identifiability"><i class="fa fa-check"></i>Identifiability</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html"><i class="fa fa-check"></i><b>1.7</b> Parameterizing centered vectors</a><ul>
<li><a href="parameterizing-centered-vectors.html#k-1-degrees-of-freedom"><span class="math inline">\(K-1\)</span> degrees of freedom</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#qr-decomposition"><i class="fa fa-check"></i>QR decomposition</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#translated-and-scaled-simplex"><i class="fa fa-check"></i>Translated and scaled simplex</a></li>
<li class="chapter" data-level="" data-path="parameterizing-centered-vectors.html"><a href="parameterizing-centered-vectors.html#soft-centering"><i class="fa fa-check"></i>Soft centering</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="ordered-logistic-section.html"><a href="ordered-logistic-section.html"><i class="fa fa-check"></i><b>1.8</b> Ordered logistic and probit regression</a><ul>
<li class="chapter" data-level="" data-path="ordered-logistic-section.html"><a href="ordered-logistic-section.html#ordered-logistic-regression"><i class="fa fa-check"></i>Ordered logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="hierarchical-logistic-regression.html"><a href="hierarchical-logistic-regression.html"><i class="fa fa-check"></i><b>1.9</b> Hierarchical logistic regression</a></li>
<li class="chapter" data-level="1.10" data-path="hierarchical-priors-section.html"><a href="hierarchical-priors-section.html"><i class="fa fa-check"></i><b>1.10</b> Hierarchical priors</a><ul>
<li class="chapter" data-level="" data-path="hierarchical-priors-section.html"><a href="hierarchical-priors-section.html#boundary-avoiding-priors-for-mle-in-hierarchical-models"><i class="fa fa-check"></i>Boundary-avoiding priors for MLE in hierarchical models</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="item-response-models-section.html"><a href="item-response-models-section.html"><i class="fa fa-check"></i><b>1.11</b> Item-response theory models</a><ul>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#data-declaration-with-missingness"><i class="fa fa-check"></i>Data declaration with missingness</a></li>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#pl-rasch-model"><i class="fa fa-check"></i>1PL (Rasch) model</a></li>
<li class="chapter" data-level="" data-path="item-response-models-section.html"><a href="item-response-models-section.html#multilevel-2pl-model"><i class="fa fa-check"></i>Multilevel 2PL model</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html"><i class="fa fa-check"></i><b>1.12</b> Priors for identifiability</a><ul>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#location-and-scale-invariance"><i class="fa fa-check"></i>Location and scale invariance</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="priors-for-identification-section.html"><a href="priors-for-identification-section.html#separability"><i class="fa fa-check"></i>Separability</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="multivariate-hierarchical-priors-section.html"><a href="multivariate-hierarchical-priors-section.html"><i class="fa fa-check"></i><b>1.13</b> Multivariate priors for hierarchical models</a><ul>
<li class="chapter" data-level="" data-path="multivariate-hierarchical-priors-section.html"><a href="multivariate-hierarchical-priors-section.html#multivariate-regression-example"><i class="fa fa-check"></i>Multivariate regression example</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html"><i class="fa fa-check"></i><b>1.14</b> Prediction, forecasting, and backcasting</a><ul>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#programming-predictions"><i class="fa fa-check"></i>Programming predictions</a></li>
<li class="chapter" data-level="" data-path="prediction-forecasting-and-backcasting.html"><a href="prediction-forecasting-and-backcasting.html#predictions-as-generated-quantities"><i class="fa fa-check"></i>Predictions as generated quantities</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html"><i class="fa fa-check"></i><b>1.15</b> Multivariate outcomes</a><ul>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#seemingly-unrelated-regressions"><i class="fa fa-check"></i>Seemingly unrelated regressions</a></li>
<li class="chapter" data-level="" data-path="multivariate-outcomes.html"><a href="multivariate-outcomes.html#multivariate-probit-regression"><i class="fa fa-check"></i>Multivariate probit regression</a></li>
</ul></li>
<li class="chapter" data-level="1.16" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html"><i class="fa fa-check"></i><b>1.16</b> Applications of pseudorandom number generation</a><ul>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="applications-of-pseudorandom-number-generation.html"><a href="applications-of-pseudorandom-number-generation.html#posterior-predictive-checks"><i class="fa fa-check"></i>Posterior predictive checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-chapter.html"><a href="time-series-chapter.html"><i class="fa fa-check"></i><b>2</b> Time-Series Models</a><ul>
<li class="chapter" data-level="2.1" data-path="autoregressive-section.html"><a href="autoregressive-section.html"><i class="fa fa-check"></i><b>2.1</b> Autoregressive models</a><ul>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#ar1-models"><i class="fa fa-check"></i>AR(1) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#extensions-to-the-ar1-model"><i class="fa fa-check"></i>Extensions to the AR(1) model</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#ar2-models"><i class="fa fa-check"></i>AR(2) models</a></li>
<li><a href="autoregressive-section.html#ark-models">AR(<span class="math inline">\(K\)</span>) models</a></li>
<li class="chapter" data-level="" data-path="autoregressive-section.html"><a href="autoregressive-section.html#arch1-models"><i class="fa fa-check"></i>ARCH(1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html"><i class="fa fa-check"></i><b>2.2</b> Modeling temporal heteroscedasticity</a><ul>
<li class="chapter" data-level="" data-path="modeling-temporal-heteroscedasticity.html"><a href="modeling-temporal-heteroscedasticity.html#garch11-models"><i class="fa fa-check"></i>GARCH(1,1) models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>2.3</b> Moving average models</a><ul>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#ma2-example"><i class="fa fa-check"></i>MA(2) example</a></li>
<li class="chapter" data-level="" data-path="moving-average-models.html"><a href="moving-average-models.html#vectorized-maq-model"><i class="fa fa-check"></i>Vectorized MA(Q) model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html"><i class="fa fa-check"></i><b>2.4</b> Autoregressive moving average models</a><ul>
<li class="chapter" data-level="" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html#identifiability-and-stationarity"><i class="fa fa-check"></i>Identifiability and stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="stochastic-volatility-models.html"><a href="stochastic-volatility-models.html"><i class="fa fa-check"></i><b>2.5</b> Stochastic volatility models</a></li>
<li class="chapter" data-level="2.6" data-path="hmms-section.html"><a href="hmms-section.html"><i class="fa fa-check"></i><b>2.6</b> Hidden Markov models</a><ul>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#supervised-parameter-estimation"><i class="fa fa-check"></i>Supervised parameter estimation</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#start-state-and-end-state-probabilities"><i class="fa fa-check"></i>Start-state and end-state probabilities</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#calculating-sufficient-statistics"><i class="fa fa-check"></i>Calculating sufficient statistics</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#analytic-posterior"><i class="fa fa-check"></i>Analytic posterior</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#semisupervised-estimation"><i class="fa fa-check"></i>Semisupervised estimation</a></li>
<li class="chapter" data-level="" data-path="hmms-section.html"><a href="hmms-section.html#predictive-inference"><i class="fa fa-check"></i>Predictive inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missing-data-and-partially-known-parameters.html"><a href="missing-data-and-partially-known-parameters.html"><i class="fa fa-check"></i><b>3</b> Missing Data and Partially Known Parameters</a><ul>
<li class="chapter" data-level="3.1" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>3.1</b> Missing data</a></li>
<li class="chapter" data-level="3.2" data-path="partially-known-parameters-section.html"><a href="partially-known-parameters-section.html"><i class="fa fa-check"></i><b>3.2</b> Partially known parameters</a></li>
<li class="chapter" data-level="3.3" data-path="sliced-missing-data.html"><a href="sliced-missing-data.html"><i class="fa fa-check"></i><b>3.3</b> Sliced missing data</a></li>
<li class="chapter" data-level="3.4" data-path="loading-matrix-for-factor-analysis.html"><a href="loading-matrix-for-factor-analysis.html"><i class="fa fa-check"></i><b>3.4</b> Loading matrix for factor analysis</a></li>
<li class="chapter" data-level="3.5" data-path="missing-multivariate-data.html"><a href="missing-multivariate-data.html"><i class="fa fa-check"></i><b>3.5</b> Missing multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="truncated-or-censored-data.html"><a href="truncated-or-censored-data.html"><i class="fa fa-check"></i><b>4</b> Truncated or Censored Data</a><ul>
<li class="chapter" data-level="4.1" data-path="truncation-section.html"><a href="truncation-section.html"><i class="fa fa-check"></i><b>4.1</b> Truncated distributions</a></li>
<li class="chapter" data-level="4.2" data-path="truncated-data-section.html"><a href="truncated-data-section.html"><i class="fa fa-check"></i><b>4.2</b> Truncated data</a><ul>
<li class="chapter" data-level="" data-path="truncated-data-section.html"><a href="truncated-data-section.html#constraints-and-out-of-bounds-returns"><i class="fa fa-check"></i>Constraints and out-of-bounds returns</a></li>
<li class="chapter" data-level="" data-path="truncated-data-section.html"><a href="truncated-data-section.html#unknown-truncation-points"><i class="fa fa-check"></i>Unknown truncation points</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="censored-data.html"><a href="censored-data.html"><i class="fa fa-check"></i><b>4.3</b> Censored data</a><ul>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#estimating-censored-values"><i class="fa fa-check"></i>Estimating censored values</a></li>
<li class="chapter" data-level="" data-path="censored-data.html"><a href="censored-data.html#integrating-out-censored-values"><i class="fa fa-check"></i>Integrating out censored values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixture-modeling-chapter.html"><a href="mixture-modeling-chapter.html"><i class="fa fa-check"></i><b>5</b> Finite Mixtures</a><ul>
<li class="chapter" data-level="5.1" data-path="clustering-mixture-section.html"><a href="clustering-mixture-section.html"><i class="fa fa-check"></i><b>5.1</b> Relation to clustering</a></li>
<li class="chapter" data-level="5.2" data-path="latent-discrete-parameterization.html"><a href="latent-discrete-parameterization.html"><i class="fa fa-check"></i><b>5.2</b> Latent discrete parameterization</a></li>
<li class="chapter" data-level="5.3" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html"><i class="fa fa-check"></i><b>5.3</b> Summing out the responsibility parameter</a><ul>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#log-sum-of-exponentials-linear-sums-on-the-log-scale"><i class="fa fa-check"></i>Log sum of exponentials: linear Sums on the log scale</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#dropping-uniform-mixture-ratios"><i class="fa fa-check"></i>Dropping uniform mixture ratios</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#recovering-posterior-mixture-proportions"><i class="fa fa-check"></i>Recovering posterior mixture proportions</a></li>
<li class="chapter" data-level="" data-path="summing-out-the-responsibility-parameter.html"><a href="summing-out-the-responsibility-parameter.html#estimating-parameters-of-a-mixture"><i class="fa fa-check"></i>Estimating parameters of a mixture</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectorizing-mixtures.html"><a href="vectorizing-mixtures.html"><i class="fa fa-check"></i><b>5.4</b> Vectorizing mixtures</a></li>
<li class="chapter" data-level="5.5" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html"><i class="fa fa-check"></i><b>5.5</b> Inferences supported by mixtures</a><ul>
<li class="chapter" data-level="" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html#mixtures-with-unidentifiable-components"><i class="fa fa-check"></i>Mixtures with unidentifiable components</a></li>
<li class="chapter" data-level="" data-path="mixture-inference-section.html"><a href="mixture-inference-section.html#inference-under-label-switching"><i class="fa fa-check"></i>Inference under label switching</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html"><i class="fa fa-check"></i><b>5.6</b> Zero-inflated and hurdle models</a><ul>
<li class="chapter" data-level="" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html#zero-inflation"><i class="fa fa-check"></i>Zero inflation</a></li>
<li class="chapter" data-level="" data-path="zero-inflated-section.html"><a href="zero-inflated-section.html#hurdle-models"><i class="fa fa-check"></i>Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html"><i class="fa fa-check"></i><b>5.7</b> Priors and effective data size in mixture models</a><ul>
<li class="chapter" data-level="" data-path="priors-and-effective-data-size-in-mixture-models.html"><a href="priors-and-effective-data-size-in-mixture-models.html#comparison-to-model-averaging"><i class="fa fa-check"></i>Comparison to model averaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="measurement-error-and-meta-analysis.html"><a href="measurement-error-and-meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Measurement Error and Meta-Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html"><i class="fa fa-check"></i><b>6.1</b> Bayesian measurement error model</a><ul>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#regression-with-measurement-error"><i class="fa fa-check"></i>Regression with measurement error</a></li>
<li class="chapter" data-level="" data-path="bayesian-measurement-error-model.html"><a href="bayesian-measurement-error-model.html#rounding"><i class="fa fa-check"></i>Rounding</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Meta-analysis</a><ul>
<li class="chapter" data-level="" data-path="meta-analysis.html"><a href="meta-analysis.html#treatment-effects-in-controlled-studies"><i class="fa fa-check"></i>Treatment effects in controlled studies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-discrete-chapter.html"><a href="latent-discrete-chapter.html"><i class="fa fa-check"></i><b>7</b> Latent Discrete Parameters</a><ul>
<li class="chapter" data-level="7.1" data-path="rao-blackwell-section.html"><a href="rao-blackwell-section.html"><i class="fa fa-check"></i><b>7.1</b> The benefits of marginalization</a></li>
<li class="chapter" data-level="7.2" data-path="change-point-section.html"><a href="change-point-section.html"><i class="fa fa-check"></i><b>7.2</b> Change point models</a><ul>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#model-with-latent-discrete-parameter"><i class="fa fa-check"></i>Model with latent discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#marginalizing-out-the-discrete-parameter"><i class="fa fa-check"></i>Marginalizing out the discrete parameter</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#coding-the-model-in-stan-1"><i class="fa fa-check"></i>Coding the model in Stan</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#fitting-the-model-with-mcmc"><i class="fa fa-check"></i>Fitting the model with MCMC</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#posterior-distribution-of-the-discrete-change-point"><i class="fa fa-check"></i>Posterior distribution of the discrete change point</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#discrete-sampling"><i class="fa fa-check"></i>Discrete sampling</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#posterior-covariance"><i class="fa fa-check"></i>Posterior covariance</a></li>
<li class="chapter" data-level="" data-path="change-point-section.html"><a href="change-point-section.html#multiple-change-points"><i class="fa fa-check"></i>Multiple change points</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html"><i class="fa fa-check"></i><b>7.3</b> Mark-recapture models</a><ul>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#simple-mark-recapture-model"><i class="fa fa-check"></i>Simple mark-recapture model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#cormack-jolly-seber-with-discrete-parameter"><i class="fa fa-check"></i>Cormack-Jolly-Seber with discrete parameter</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#collective-cormack-jolly-seber-model"><i class="fa fa-check"></i>Collective Cormack-Jolly-Seber model</a></li>
<li class="chapter" data-level="" data-path="mark-recapture-models.html"><a href="mark-recapture-models.html#individual-cormack-jolly-seber-model"><i class="fa fa-check"></i>Individual Cormack-Jolly-Seber model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html"><i class="fa fa-check"></i><b>7.4</b> Data coding and diagnostic accuracy models</a><ul>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#diagnostic-accuracy"><i class="fa fa-check"></i>Diagnostic accuracy</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#data-coding"><i class="fa fa-check"></i>Data coding</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-categorical-measurement-model"><i class="fa fa-check"></i>Noisy categorical measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#model-parameters"><i class="fa fa-check"></i>Model parameters</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#noisy-measurement-model"><i class="fa fa-check"></i>Noisy measurement model</a></li>
<li class="chapter" data-level="" data-path="data-coding-and-diagnostic-accuracy-models.html"><a href="data-coding-and-diagnostic-accuracy-models.html#stan-implementation"><i class="fa fa-check"></i>Stan implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sparse-ragged-chapter.html"><a href="sparse-ragged-chapter.html"><i class="fa fa-check"></i><b>8</b> Sparse and Ragged Data Structures</a><ul>
<li class="chapter" data-level="8.1" data-path="sparse-data-structures.html"><a href="sparse-data-structures.html"><i class="fa fa-check"></i><b>8.1</b> Sparse data structures</a></li>
<li class="chapter" data-level="8.2" data-path="ragged-data-structs-section.html"><a href="ragged-data-structs-section.html"><i class="fa fa-check"></i><b>8.2</b> Ragged data structures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering-chapter.html"><a href="clustering-chapter.html"><i class="fa fa-check"></i><b>9</b> Clustering Models</a><ul>
<li class="chapter" data-level="9.1" data-path="relation-to-finite-mixture-models.html"><a href="relation-to-finite-mixture-models.html"><i class="fa fa-check"></i><b>9.1</b> Relation to finite mixture models</a></li>
<li class="chapter" data-level="9.2" data-path="soft-k-means.html"><a href="soft-k-means.html"><i class="fa fa-check"></i><b>9.2</b> Soft <em>K</em>-means</a><ul>
<li class="chapter" data-level="9.2.1" data-path="soft-k-means.html"><a href="soft-k-means.html#geometric-hard-k-means-clustering"><i class="fa fa-check"></i><b>9.2.1</b> Geometric hard <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="9.2.2" data-path="soft-k-means.html"><a href="soft-k-means.html#soft-k-means-clustering"><i class="fa fa-check"></i><b>9.2.2</b> Soft <em>K</em>-means clustering</a></li>
<li><a href="soft-k-means.html#stan-implementation-of-soft-k-means">Stan implementation of soft <em>K</em>-means</a></li>
<li><a href="soft-k-means.html#generalizing-soft-k-means">Generalizing soft <em>K</em>-means</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html"><i class="fa fa-check"></i><b>9.3</b> The difficulty of Bayesian inference for clustering</a><ul>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#non-identifiability"><i class="fa fa-check"></i>Non-identifiability</a></li>
<li class="chapter" data-level="" data-path="the-difficulty-of-bayesian-inference-for-clustering.html"><a href="the-difficulty-of-bayesian-inference-for-clustering.html#multimodality"><i class="fa fa-check"></i>Multimodality</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html"><i class="fa fa-check"></i><b>9.4</b> Naive Bayes classification and clustering</a><ul>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#coding-ragged-arrays"><i class="fa fa-check"></i>Coding ragged arrays</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-with-category-labeled-training-data"><i class="fa fa-check"></i>Estimation with category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#estimation-without-category-labeled-training-data"><i class="fa fa-check"></i>Estimation without category-labeled training data</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#full-bayesian-inference-for-naive-bayes"><i class="fa fa-check"></i>Full Bayesian inference for naive Bayes</a></li>
<li class="chapter" data-level="" data-path="naive-bayes-classification-and-clustering.html"><a href="naive-bayes-classification-and-clustering.html#prediction-without-model-updates"><i class="fa fa-check"></i>Prediction without model updates</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>9.5</b> Latent Dirichlet allocation</a><ul>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#the-lda-model"><i class="fa fa-check"></i>The LDA Model</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#summing-out-the-discrete-parameters"><i class="fa fa-check"></i>Summing out the discrete parameters</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#implementation-of-lda"><i class="fa fa-check"></i>Implementation of LDA</a></li>
<li class="chapter" data-level="" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#correlated-topic-model"><i class="fa fa-check"></i>Correlated topic model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gaussian-processes-chapter.html"><a href="gaussian-processes-chapter.html"><i class="fa fa-check"></i><b>10</b> Gaussian Processes</a><ul>
<li class="chapter" data-level="10.1" data-path="gaussian-process-regression.html"><a href="gaussian-process-regression.html"><i class="fa fa-check"></i><b>10.1</b> Gaussian process regression</a></li>
<li class="chapter" data-level="10.2" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html"><i class="fa fa-check"></i><b>10.2</b> Simulating from a Gaussian process</a><ul>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#multivariate-inputs"><i class="fa fa-check"></i>Multivariate inputs</a></li>
<li class="chapter" data-level="" data-path="simulating-from-a-gaussian-process.html"><a href="simulating-from-a-gaussian-process.html#cholesky-factored-and-transformed-implementation"><i class="fa fa-check"></i>Cholesky factored and transformed implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fit-gp-section.html"><a href="fit-gp-section.html"><i class="fa fa-check"></i><b>10.3</b> Fitting a Gaussian process</a><ul>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#gp-with-a-normal-outcome"><i class="fa fa-check"></i>GP with a normal outcome</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#discrete-outcomes-with-gaussian-processes"><i class="fa fa-check"></i>Discrete outcomes with Gaussian processes</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#automatic-relevance-determination"><i class="fa fa-check"></i>Automatic relevance determination</a></li>
<li class="chapter" data-level="10.3.1" data-path="fit-gp-section.html"><a href="fit-gp-section.html#priors-gp.section"><i class="fa fa-check"></i><b>10.3.1</b> Priors for Gaussian process parameters</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#predictive-inference-with-a-gaussian-process"><i class="fa fa-check"></i>Predictive inference with a Gaussian process</a></li>
<li class="chapter" data-level="" data-path="fit-gp-section.html"><a href="fit-gp-section.html#multiple-output-gaussian-processes"><i class="fa fa-check"></i>Multiple-output Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="directions-rotations-and-hyperspheres.html"><a href="directions-rotations-and-hyperspheres.html"><i class="fa fa-check"></i><b>11</b> Directions, Rotations, and Hyperspheres</a><ul>
<li class="chapter" data-level="11.1" data-path="unit-vectors.html"><a href="unit-vectors.html"><i class="fa fa-check"></i><b>11.1</b> Unit vectors</a></li>
<li class="chapter" data-level="11.2" data-path="circles-spheres-and-hyperspheres.html"><a href="circles-spheres-and-hyperspheres.html"><i class="fa fa-check"></i><b>11.2</b> Circles, spheres, and hyperspheres</a></li>
<li class="chapter" data-level="11.3" data-path="transforming-to-unconstrained-parameters.html"><a href="transforming-to-unconstrained-parameters.html"><i class="fa fa-check"></i><b>11.3</b> Transforming to unconstrained parameters</a></li>
<li class="chapter" data-level="11.4" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html"><i class="fa fa-check"></i><b>11.4</b> Unit vectors and rotations</a><ul>
<li class="chapter" data-level="" data-path="unit-vectors-and-rotations.html"><a href="unit-vectors-and-rotations.html#angles-from-unit-vectors"><i class="fa fa-check"></i>Angles from unit vectors</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="circular-representations-of-days-and-years.html"><a href="circular-representations-of-days-and-years.html"><i class="fa fa-check"></i><b>11.5</b> Circular representations of days and years</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="algebra-solver-chapter.html"><a href="algebra-solver-chapter.html"><i class="fa fa-check"></i><b>12</b> Solving Algebraic Equations</a><ul>
<li class="chapter" data-level="12.1" data-path="example-system-of-nonlinear-algebraic-equations.html"><a href="example-system-of-nonlinear-algebraic-equations.html"><i class="fa fa-check"></i><b>12.1</b> Example: system of nonlinear algebraic equations</a></li>
<li class="chapter" data-level="12.2" data-path="coding-an-algebraic-system.html"><a href="coding-an-algebraic-system.html"><i class="fa fa-check"></i><b>12.2</b> Coding an algebraic system</a></li>
<li class="chapter" data-level="12.3" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html"><i class="fa fa-check"></i><b>12.3</b> Calling the algebraic solver</a><ul>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#data-versus-parameters"><i class="fa fa-check"></i>Data versus parameters</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#length-of-the-algebraic-function-and-of-the-vector-of-unknowns"><i class="fa fa-check"></i>Length of the algebraic function and of the vector of unknowns</a></li>
<li class="chapter" data-level="" data-path="calling-the-algebraic-solver.html"><a href="calling-the-algebraic-solver.html#pathological-solutions"><i class="fa fa-check"></i>Pathological solutions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="algebra-control-section.html"><a href="algebra-control-section.html"><i class="fa fa-check"></i><b>12.4</b> Control parameters for the algebraic solver</a><ul>
<li class="chapter" data-level="" data-path="algebra-control-section.html"><a href="algebra-control-section.html#tolerance"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="algebra-control-section.html"><a href="algebra-control-section.html#maximum-number-of-steps"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ode-solver-chapter.html"><a href="ode-solver-chapter.html"><i class="fa fa-check"></i><b>13</b> Ordinary Differential Equations</a><ul>
<li class="chapter" data-level="13.1" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>13.1</b> Notation</a></li>
<li class="chapter" data-level="13.2" data-path="example-simple-harmonic-oscillator.html"><a href="example-simple-harmonic-oscillator.html"><i class="fa fa-check"></i><b>13.2</b> Example: simple harmonic oscillator</a></li>
<li class="chapter" data-level="13.3" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html"><i class="fa fa-check"></i><b>13.3</b> Coding the ODE system function</a><ul>
<li class="chapter" data-level="" data-path="coding-the-ode-system-function.html"><a href="coding-the-ode-system-function.html#strict-signature-1"><i class="fa fa-check"></i>Strict signature</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="measurement-error-models.html"><a href="measurement-error-models.html"><i class="fa fa-check"></i><b>13.4</b> Measurement error models</a><ul>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#simulating-noisy-measurements"><i class="fa fa-check"></i>Simulating noisy measurements</a></li>
<li class="chapter" data-level="" data-path="measurement-error-models.html"><a href="measurement-error-models.html#estimating-system-parameters-and-initial-state"><i class="fa fa-check"></i>Estimating system parameters and initial state</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="stiff-ode-section.html"><a href="stiff-ode-section.html"><i class="fa fa-check"></i><b>13.5</b> Stiff ODEs</a></li>
<li class="chapter" data-level="13.6" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html"><i class="fa fa-check"></i><b>13.6</b> Control parameters for ODE solving</a><ul>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#discontinuous-ode-system-function"><i class="fa fa-check"></i>Discontinuous ODE system function</a></li>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#tolerance-1"><i class="fa fa-check"></i>Tolerance</a></li>
<li class="chapter" data-level="" data-path="control-parameters-for-ode-solving.html"><a href="control-parameters-for-ode-solving.html#maximum-number-of-steps-1"><i class="fa fa-check"></i>Maximum number of steps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><a href="solving-a-system-of-linear-odes-using-a-matrix-exponential.html"><i class="fa fa-check"></i><b>13.7</b> Solving a system of linear ODEs using a matrix exponential</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="integrate-1d.html"><a href="integrate-1d.html"><i class="fa fa-check"></i><b>14</b> Computing One Dimensional Integrals</a><ul>
<li class="chapter" data-level="14.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html"><i class="fa fa-check"></i><b>14.1</b> Calling the integrator</a><ul>
<li class="chapter" data-level="14.1.1" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#limits-of-integration"><i class="fa fa-check"></i><b>14.1.1</b> Limits of integration</a></li>
<li class="chapter" data-level="14.1.2" data-path="calling-the-integrator.html"><a href="calling-the-integrator.html#data-vs.-parameters"><i class="fa fa-check"></i><b>14.1.2</b> Data vs. parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html"><i class="fa fa-check"></i><b>14.2</b> Integrator convergence</a><ul>
<li class="chapter" data-level="14.2.1" data-path="integrator-convergence.html"><a href="integrator-convergence.html#zero-crossing"><i class="fa fa-check"></i><b>14.2.1</b> Zero-crossing integrals</a></li>
<li class="chapter" data-level="14.2.2" data-path="integrator-convergence.html"><a href="integrator-convergence.html#integral-precision"><i class="fa fa-check"></i><b>14.2.2</b> Avoiding precision loss near limits of integration in definite integrals</a></li>
</ul></li>
</ul></li>
<li><a href="part-2-programming-techniques.html#part-2.-programming-techniques"><i style="font-size: 110%; color:#990017;">Part 2. Programming Techniques</i></a></li>
<li class="chapter" data-level="15" data-path="floating-point-arithmetic.html"><a href="floating-point-arithmetic.html"><i class="fa fa-check"></i><b>15</b> Floating Point Arithmetic</a><ul>
<li class="chapter" data-level="15.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html"><i class="fa fa-check"></i><b>15.1</b> Floating-point representations</a><ul>
<li class="chapter" data-level="15.1.1" data-path="floating-point-representations.html"><a href="floating-point-representations.html#finite-values"><i class="fa fa-check"></i><b>15.1.1</b> Finite values</a></li>
<li class="chapter" data-level="15.1.2" data-path="floating-point-representations.html"><a href="floating-point-representations.html#normality"><i class="fa fa-check"></i><b>15.1.2</b> Normality</a></li>
<li class="chapter" data-level="15.1.3" data-path="floating-point-representations.html"><a href="floating-point-representations.html#ranges-and-extreme-values"><i class="fa fa-check"></i><b>15.1.3</b> Ranges and extreme values</a></li>
<li class="chapter" data-level="15.1.4" data-path="floating-point-representations.html"><a href="floating-point-representations.html#signed-zero"><i class="fa fa-check"></i><b>15.1.4</b> Signed zero</a></li>
<li class="chapter" data-level="15.1.5" data-path="floating-point-representations.html"><a href="floating-point-representations.html#not-a-number-values"><i class="fa fa-check"></i><b>15.1.5</b> Not-a-number values</a></li>
<li class="chapter" data-level="15.1.6" data-path="floating-point-representations.html"><a href="floating-point-representations.html#positive-and-negative-infinity"><i class="fa fa-check"></i><b>15.1.6</b> Positive and negative infinity</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="literals-decimal-and-scientific-notation.html"><a href="literals-decimal-and-scientific-notation.html"><i class="fa fa-check"></i><b>15.2</b> Literals: decimal and scientific notation</a></li>
<li class="chapter" data-level="15.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html"><i class="fa fa-check"></i><b>15.3</b> Arithmetic precision</a><ul>
<li class="chapter" data-level="15.3.1" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#rounding-and-probabilities"><i class="fa fa-check"></i><b>15.3.1</b> Rounding and probabilities</a></li>
<li class="chapter" data-level="15.3.2" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#machine-precision-and-the-asymmetry-of-0-and-1"><i class="fa fa-check"></i><b>15.3.2</b> Machine precision and the asymmetry of 0 and 1</a></li>
<li class="chapter" data-level="15.3.3" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#complementary-and-epsilon-functions"><i class="fa fa-check"></i><b>15.3.3</b> Complementary and epsilon functions</a></li>
<li class="chapter" data-level="15.3.4" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#catastrophic-cancellation"><i class="fa fa-check"></i><b>15.3.4</b> Catastrophic cancellation</a></li>
<li class="chapter" data-level="15.3.5" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#overflow"><i class="fa fa-check"></i><b>15.3.5</b> Overflow</a></li>
<li class="chapter" data-level="15.3.6" data-path="arithmetic-precision.html"><a href="arithmetic-precision.html#underflow-and-the-log-scale"><i class="fa fa-check"></i><b>15.3.6</b> Underflow and the log scale</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html"><i class="fa fa-check"></i><b>15.4</b> Log sum of exponentials</a><ul>
<li class="chapter" data-level="15.4.1" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#log-sum-exp-function"><i class="fa fa-check"></i><b>15.4.1</b> Log-sum-exp function</a></li>
<li class="chapter" data-level="15.4.2" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#applying-log-sum-exp-to-a-sequence"><i class="fa fa-check"></i><b>15.4.2</b> Applying log-sum-exp to a sequence</a></li>
<li class="chapter" data-level="15.4.3" data-path="log-sum-of-exponentials.html"><a href="log-sum-of-exponentials.html#calculating-means-with-log-sum-exp"><i class="fa fa-check"></i><b>15.4.3</b> Calculating means with log-sum-exp</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="comparing-floating-point-numbers.html"><a href="comparing-floating-point-numbers.html"><i class="fa fa-check"></i><b>15.5</b> Comparing floating-point numbers</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="matrices-vectors-and-arrays.html"><a href="matrices-vectors-and-arrays.html"><i class="fa fa-check"></i><b>16</b> Matrices, Vectors, and Arrays</a><ul>
<li class="chapter" data-level="16.1" data-path="basic-motivation.html"><a href="basic-motivation.html"><i class="fa fa-check"></i><b>16.1</b> Basic motivation</a></li>
<li class="chapter" data-level="16.2" data-path="fixed-sizes-and-indexing-out-of-bounds.html"><a href="fixed-sizes-and-indexing-out-of-bounds.html"><i class="fa fa-check"></i><b>16.2</b> Fixed sizes and indexing out of bounds</a></li>
<li class="chapter" data-level="16.3" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html"><i class="fa fa-check"></i><b>16.3</b> Data type and indexing efficiency</a><ul>
<li class="chapter" data-level="" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html#matrices-vs.-two-dimensional-arrays"><i class="fa fa-check"></i>Matrices vs. two-dimensional arrays</a></li>
<li class="chapter" data-level="" data-path="indexing-efficiency-section.html"><a href="indexing-efficiency-section.html#row-vectors-vs.-one-dimensional-arrays"><i class="fa fa-check"></i>(Row) vectors vs. one-dimensional arrays</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="memory-locality.html"><a href="memory-locality.html"><i class="fa fa-check"></i><b>16.4</b> Memory locality</a><ul>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#memory-locality-1"><i class="fa fa-check"></i>Memory locality</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="memory-locality.html"><a href="memory-locality.html#arrays"><i class="fa fa-check"></i>Arrays</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="converting-among-matrix-vector-and-array-types.html"><a href="converting-among-matrix-vector-and-array-types.html"><i class="fa fa-check"></i><b>16.5</b> Converting among matrix, vector, and array types</a></li>
<li class="chapter" data-level="16.6" data-path="aliasing-in-stan-containers.html"><a href="aliasing-in-stan-containers.html"><i class="fa fa-check"></i><b>16.6</b> Aliasing in Stan containers</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="multi-indexing-chapter.html"><a href="multi-indexing-chapter.html"><i class="fa fa-check"></i><b>17</b> Multiple Indexing and Range Indexing</a><ul>
<li class="chapter" data-level="17.1" data-path="multiple-indexing.html"><a href="multiple-indexing.html"><i class="fa fa-check"></i><b>17.1</b> Multiple indexing</a></li>
<li class="chapter" data-level="17.2" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html"><i class="fa fa-check"></i><b>17.2</b> Slicing with range indexes</a><ul>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-and-upper-bound-indexes"><i class="fa fa-check"></i>Lower and upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#lower-or-upper-bound-indexes"><i class="fa fa-check"></i>Lower or upper bound indexes</a></li>
<li class="chapter" data-level="" data-path="slicing-with-range-indexes.html"><a href="slicing-with-range-indexes.html#full-range-indexes"><i class="fa fa-check"></i>Full range indexes</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html"><i class="fa fa-check"></i><b>17.3</b> Multiple indexing on the left of assignments</a><ul>
<li class="chapter" data-level="" data-path="multiple-indexing-on-the-left-of-assignments.html"><a href="multiple-indexing-on-the-left-of-assignments.html#assign-by-value-and-aliasing"><i class="fa fa-check"></i>Assign-by-value and aliasing</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html"><i class="fa fa-check"></i><b>17.4</b> Multiple indexes with vectors and matrices</a><ul>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-1"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#matrices-with-one-multiple-index"><i class="fa fa-check"></i>Matrices with one multiple index</a></li>
<li class="chapter" data-level="" data-path="multiple-indexes-with-vectors-and-matrices.html"><a href="multiple-indexes-with-vectors-and-matrices.html#arrays-of-vectors-or-matrices"><i class="fa fa-check"></i>Arrays of vectors or matrices</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="matrices-with-parameters-and-constants.html"><a href="matrices-with-parameters-and-constants.html"><i class="fa fa-check"></i><b>17.5</b> Matrices with parameters and constants</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="functions-programming-chapter.html"><a href="functions-programming-chapter.html"><i class="fa fa-check"></i><b>18</b> User-Defined Functions</a><ul>
<li class="chapter" data-level="18.1" data-path="basic-functions-section.html"><a href="basic-functions-section.html"><i class="fa fa-check"></i><b>18.1</b> Basic functions</a><ul>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#user-defined-functions-block"><i class="fa fa-check"></i>User-defined functions block</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#function-bodies"><i class="fa fa-check"></i>Function bodies</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#return-statements"><i class="fa fa-check"></i>Return statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#reject-statements"><i class="fa fa-check"></i>Reject statements</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#type-declarations-for-functions"><i class="fa fa-check"></i>Type declarations for functions</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#array-types-for-function-declarations"><i class="fa fa-check"></i>Array types for function declarations</a></li>
<li class="chapter" data-level="" data-path="basic-functions-section.html"><a href="basic-functions-section.html#data-only-function-arguments"><i class="fa fa-check"></i>Data-only function arguments</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="functions-as-statements.html"><a href="functions-as-statements.html"><i class="fa fa-check"></i><b>18.2</b> Functions as statements</a></li>
<li class="chapter" data-level="18.3" data-path="functions-accessing-the-log-probability-accumulator.html"><a href="functions-accessing-the-log-probability-accumulator.html"><i class="fa fa-check"></i><b>18.3</b> Functions accessing the log probability accumulator</a></li>
<li class="chapter" data-level="18.4" data-path="functions-acting-as-random-number-generators.html"><a href="functions-acting-as-random-number-generators.html"><i class="fa fa-check"></i><b>18.4</b> Functions acting as random number generators</a></li>
<li class="chapter" data-level="18.5" data-path="user-defined-probability-functions.html"><a href="user-defined-probability-functions.html"><i class="fa fa-check"></i><b>18.5</b> User-defined probability functions</a></li>
<li class="chapter" data-level="18.6" data-path="overloading-functions.html"><a href="overloading-functions.html"><i class="fa fa-check"></i><b>18.6</b> Overloading functions</a></li>
<li class="chapter" data-level="18.7" data-path="documenting-functions-section.html"><a href="documenting-functions-section.html"><i class="fa fa-check"></i><b>18.7</b> Documenting functions</a></li>
<li class="chapter" data-level="18.8" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html"><i class="fa fa-check"></i><b>18.8</b> Summary of function types</a><ul>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#void-vs.-non-void-return"><i class="fa fa-check"></i>Void vs. non-void return</a></li>
<li class="chapter" data-level="" data-path="summary-of-function-types.html"><a href="summary-of-function-types.html#suffixed-or-non-suffixed"><i class="fa fa-check"></i>Suffixed or non-suffixed</a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="recursive-functions.html"><a href="recursive-functions.html"><i class="fa fa-check"></i><b>18.9</b> Recursive functions</a></li>
<li class="chapter" data-level="18.10" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html"><i class="fa fa-check"></i><b>18.10</b> Truncated random number generation</a><ul>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#generation-with-inverse-cdfs"><i class="fa fa-check"></i>Generation with inverse CDFs</a></li>
<li class="chapter" data-level="" data-path="truncated-random-number-generation.html"><a href="truncated-random-number-generation.html#truncated-variate-generation"><i class="fa fa-check"></i>Truncated variate generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="custom-probability-functions-chapter.html"><a href="custom-probability-functions-chapter.html"><i class="fa fa-check"></i><b>19</b> Custom Probability Functions</a><ul>
<li class="chapter" data-level="19.1" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>19.1</b> Examples</a><ul>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#triangle-distribution"><i class="fa fa-check"></i>Triangle distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html#bivariate-normal-cumulative-distribution-function"><i class="fa fa-check"></i>Bivariate normal cumulative distribution function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="problematic-posteriors-chapter.html"><a href="problematic-posteriors-chapter.html"><i class="fa fa-check"></i><b>20</b> Problematic Posteriors</a><ul>
<li class="chapter" data-level="20.1" data-path="collinearity-section.html"><a href="collinearity-section.html"><i class="fa fa-check"></i><b>20.1</b> Collinearity of predictors in regressions</a><ul>
<li class="chapter" data-level="" data-path="collinearity-section.html"><a href="collinearity-section.html#examples-of-collinearity"><i class="fa fa-check"></i>Examples of collinearity</a></li>
<li class="chapter" data-level="" data-path="collinearity-section.html"><a href="collinearity-section.html#mitigating-the-invariances"><i class="fa fa-check"></i>Mitigating the invariances</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html"><i class="fa fa-check"></i><b>20.2</b> Label switching in mixture models</a><ul>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#mixture-models"><i class="fa fa-check"></i>Mixture models</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#convergence-monitoring-and-effective-sample-size"><i class="fa fa-check"></i>Convergence monitoring and effective sample size</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#some-inferences-are-invariant"><i class="fa fa-check"></i>Some inferences are invariant</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#highly-multimodal-posteriors"><i class="fa fa-check"></i>Highly multimodal posteriors</a></li>
<li class="chapter" data-level="" data-path="label-switching-problematic-section.html"><a href="label-switching-problematic-section.html#hacks-as-fixes"><i class="fa fa-check"></i>Hacks as fixes</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="component-collapsing-in-mixture-models.html"><a href="component-collapsing-in-mixture-models.html"><i class="fa fa-check"></i><b>20.3</b> Component collapsing in mixture models</a></li>
<li class="chapter" data-level="20.4" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html"><i class="fa fa-check"></i><b>20.4</b> Posteriors with unbounded densities</a><ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#mixture-models-with-varying-scales"><i class="fa fa-check"></i>Mixture models with varying scales</a></li>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-densities.html"><a href="posteriors-with-unbounded-densities.html#beta-binomial-models-with-skewed-data-and-weak-priors"><i class="fa fa-check"></i>Beta-binomial models with skewed data and weak priors</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html"><i class="fa fa-check"></i><b>20.5</b> Posteriors with unbounded parameters</a><ul>
<li class="chapter" data-level="" data-path="posteriors-with-unbounded-parameters.html"><a href="posteriors-with-unbounded-parameters.html#separability-in-logistic-regression"><i class="fa fa-check"></i>Separability in logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="uniform-posteriors.html"><a href="uniform-posteriors.html"><i class="fa fa-check"></i><b>20.6</b> Uniform posteriors</a></li>
<li class="chapter" data-level="20.7" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html"><i class="fa fa-check"></i><b>20.7</b> Sampling difficulties with problematic priors</a><ul>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#gibbs-sampling"><i class="fa fa-check"></i>Gibbs sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#hamiltonian-monte-carlo-sampling"><i class="fa fa-check"></i>Hamiltonian Monte Carlo sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#no-u-turn-sampling"><i class="fa fa-check"></i>No-U-turn sampling</a></li>
<li class="chapter" data-level="" data-path="sampling-difficulties-with-problematic-priors.html"><a href="sampling-difficulties-with-problematic-priors.html#examples-fits-in-stan"><i class="fa fa-check"></i>Examples: fits in Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="change-of-variables-chapter.html"><a href="change-of-variables-chapter.html"><i class="fa fa-check"></i><b>21</b> Reparameterization and Change of Variables</a><ul>
<li class="chapter" data-level="21.1" data-path="theoretical-and-practical-background.html"><a href="theoretical-and-practical-background.html"><i class="fa fa-check"></i><b>21.1</b> Theoretical and practical background</a></li>
<li class="chapter" data-level="21.2" data-path="reparameterizations.html"><a href="reparameterizations.html"><i class="fa fa-check"></i><b>21.2</b> Reparameterizations</a><ul>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#beta-and-dirichlet-priors"><i class="fa fa-check"></i>Beta and Dirichlet priors</a></li>
<li class="chapter" data-level="" data-path="reparameterizations.html"><a href="reparameterizations.html#transforming-unconstrained-priors-probit-and-logit"><i class="fa fa-check"></i>Transforming unconstrained priors: probit and logit</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="changes-of-variables.html"><a href="changes-of-variables.html"><i class="fa fa-check"></i><b>21.3</b> Changes of variables</a><ul>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#change-of-variables-vs.-transformations"><i class="fa fa-check"></i>Change of variables vs. transformations</a></li>
<li class="chapter" data-level="" data-path="changes-of-variables.html"><a href="changes-of-variables.html#multivariate-changes-of-variables"><i class="fa fa-check"></i>Multivariate changes of variables</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html"><i class="fa fa-check"></i><b>21.4</b> Vectors with varying bounds</a><ul>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-lower-bounds"><i class="fa fa-check"></i>Varying lower bounds</a></li>
<li class="chapter" data-level="" data-path="vectors-with-varying-bounds.html"><a href="vectors-with-varying-bounds.html#varying-upper-and-lower-bounds"><i class="fa fa-check"></i>Varying upper and lower bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="optimization-chapter.html"><a href="optimization-chapter.html"><i class="fa fa-check"></i><b>22</b> Efficiency Tuning</a><ul>
<li class="chapter" data-level="22.1" data-path="what-is-efficiency.html"><a href="what-is-efficiency.html"><i class="fa fa-check"></i><b>22.1</b> What is efficiency?</a></li>
<li class="chapter" data-level="22.2" data-path="efficiency-for-probabilistic-models-and-algorithms.html"><a href="efficiency-for-probabilistic-models-and-algorithms.html"><i class="fa fa-check"></i><b>22.2</b> Efficiency for probabilistic models and algorithms</a></li>
<li class="chapter" data-level="22.3" data-path="statistical-vs-computational-efficiency.html"><a href="statistical-vs-computational-efficiency.html"><i class="fa fa-check"></i><b>22.3</b> Statistical vs.  computational efficiency</a></li>
<li class="chapter" data-level="22.4" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html"><i class="fa fa-check"></i><b>22.4</b> Model conditioning and curvature</a><ul>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#condition-number-and-adaptation"><i class="fa fa-check"></i>Condition number and adaptation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#unit-scales-without-correlation"><i class="fa fa-check"></i>Unit scales without correlation</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#varying-curvature"><i class="fa fa-check"></i>Varying curvature</a></li>
<li class="chapter" data-level="" data-path="model-conditioning-and-curvature.html"><a href="model-conditioning-and-curvature.html#reparameterizing-with-a-change-of-variables"><i class="fa fa-check"></i>Reparameterizing with a change of variables</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="well-specified-models.html"><a href="well-specified-models.html"><i class="fa fa-check"></i><b>22.5</b> Well-specified models</a></li>
<li class="chapter" data-level="22.6" data-path="avoiding-validation.html"><a href="avoiding-validation.html"><i class="fa fa-check"></i><b>22.6</b> Avoiding validation</a></li>
<li class="chapter" data-level="22.7" data-path="reparameterization-section.html"><a href="reparameterization-section.html"><i class="fa fa-check"></i><b>22.7</b> Reparameterization</a><ul>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#funnel.figure"><i class="fa fa-check"></i>Example: Neal’s funnel</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#reparameterizing-the-cauchy"><i class="fa fa-check"></i>Reparameterizing the Cauchy</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#reparameterizing-a-student-t-distribution"><i class="fa fa-check"></i>Reparameterizing a Student-t distribution</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#hierarchical-models-and-the-non-centered-parameterization"><i class="fa fa-check"></i>Hierarchical models and the non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#non-centered-parameterization"><i class="fa fa-check"></i>Non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="reparameterization-section.html"><a href="reparameterization-section.html#multivariate-reparameterizations"><i class="fa fa-check"></i>Multivariate reparameterizations</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>22.8</b> Vectorization</a><ul>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#gradient-bottleneck"><i class="fa fa-check"></i>Gradient bottleneck</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorizing-summations"><i class="fa fa-check"></i>Vectorizing summations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorization-through-matrix-operations"><i class="fa fa-check"></i>Vectorization through matrix operations</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#vectorized-probability-functions"><i class="fa fa-check"></i>Vectorized probability functions</a></li>
<li class="chapter" data-level="" data-path="vectorization.html"><a href="vectorization.html#reshaping-data-for-vectorization"><i class="fa fa-check"></i>Reshaping data for vectorization</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="exploiting-sufficient-statistics.html"><a href="exploiting-sufficient-statistics.html"><i class="fa fa-check"></i><b>22.9</b> Exploiting sufficient statistics</a></li>
<li class="chapter" data-level="22.10" data-path="aggregating-common-subexpressions.html"><a href="aggregating-common-subexpressions.html"><i class="fa fa-check"></i><b>22.10</b> Aggregating common subexpressions</a></li>
<li class="chapter" data-level="22.11" data-path="exploiting-conjugacy.html"><a href="exploiting-conjugacy.html"><i class="fa fa-check"></i><b>22.11</b> Exploiting conjugacy</a></li>
<li class="chapter" data-level="22.12" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html"><i class="fa fa-check"></i><b>22.12</b> Standardizing predictors and outputs</a><ul>
<li class="chapter" data-level="" data-path="standardizing-predictors-and-outputs.html"><a href="standardizing-predictors-and-outputs.html#standard-normal-distribution"><i class="fa fa-check"></i>Standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="22.13" data-path="using-map-reduce.html"><a href="using-map-reduce.html"><i class="fa fa-check"></i><b>22.13</b> Using map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="parallelization-chapter.html"><a href="parallelization-chapter.html"><i class="fa fa-check"></i><b>23</b> Parallelization</a><ul>
<li class="chapter" data-level="23.1" data-path="reduce-sum.html"><a href="reduce-sum.html"><i class="fa fa-check"></i><b>23.1</b> Reduce-sum</a><ul>
<li class="chapter" data-level="23.1.1" data-path="reduce-sum.html"><a href="reduce-sum.html#example-logistic-regression"><i class="fa fa-check"></i><b>23.1.1</b> Example: logistic regression</a></li>
<li class="chapter" data-level="23.1.2" data-path="reduce-sum.html"><a href="reduce-sum.html#reduce-sum-grainsize"><i class="fa fa-check"></i><b>23.1.2</b> Picking the grainsize</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="map-rect.html"><a href="map-rect.html"><i class="fa fa-check"></i><b>23.2</b> Map-rect</a><ul>
<li class="chapter" data-level="23.2.1" data-path="map-rect.html"><a href="map-rect.html#map-function"><i class="fa fa-check"></i><b>23.2.1</b> Map function</a></li>
<li class="chapter" data-level="" data-path="map-rect.html"><a href="map-rect.html#map-function-signature"><i class="fa fa-check"></i>Map function signature</a></li>
<li class="chapter" data-level="23.2.2" data-path="map-rect.html"><a href="map-rect.html#example-logistic-regression-1"><i class="fa fa-check"></i><b>23.2.2</b> Example: logistic regression</a></li>
<li class="chapter" data-level="23.2.3" data-path="map-rect.html"><a href="map-rect.html#example-hierarchical-logistic-regression"><i class="fa fa-check"></i><b>23.2.3</b> Example: hierarchical logistic regression</a></li>
<li class="chapter" data-level="23.2.4" data-path="map-rect.html"><a href="map-rect.html#ragged-inputs-and-outputs"><i class="fa fa-check"></i><b>23.2.4</b> Ragged inputs and outputs</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="opencl.html"><a href="opencl.html"><i class="fa fa-check"></i><b>23.3</b> OpenCL</a></li>
</ul></li>
<li><a href="meta-models-part.html#meta-models.part"><i style="font-size: 110%; color:#990017;">Part 3. Posterior Inference &amp; Model Checking</i></a></li>
<li class="chapter" data-level="24" data-path="posterior-prediction-chapter.html"><a href="posterior-prediction-chapter.html"><i class="fa fa-check"></i><b>24</b> Posterior Predictive Sampling</a><ul>
<li class="chapter" data-level="24.1" data-path="posterior-predictive-distribution.html"><a href="posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>24.1</b> Posterior predictive distribution</a></li>
<li class="chapter" data-level="24.2" data-path="computing-the-posterior-predictive-distribution.html"><a href="computing-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>24.2</b> Computing the posterior predictive distribution</a></li>
<li class="chapter" data-level="24.3" data-path="sampling-from-the-posterior-predictive-distribution.html"><a href="sampling-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>24.3</b> Sampling from the posterior predictive distribution</a></li>
<li class="chapter" data-level="24.4" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html"><i class="fa fa-check"></i><b>24.4</b> Posterior predictive simulation in Stan</a><ul>
<li class="chapter" data-level="24.4.1" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#simple-poisson-model"><i class="fa fa-check"></i><b>24.4.1</b> Simple Poisson model</a></li>
<li class="chapter" data-level="24.4.2" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#stan-code"><i class="fa fa-check"></i><b>24.4.2</b> Stan code</a></li>
<li class="chapter" data-level="24.4.3" data-path="posterior-predictive-simulation-in-stan.html"><a href="posterior-predictive-simulation-in-stan.html#analytic-posterior-and-posterior-predictive"><i class="fa fa-check"></i><b>24.4.3</b> Analytic posterior and posterior predictive</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html"><i class="fa fa-check"></i><b>24.5</b> Posterior prediction for regressions</a><ul>
<li class="chapter" data-level="24.5.1" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#posterior-predictive-distributions-for-regressions"><i class="fa fa-check"></i><b>24.5.1</b> Posterior predictive distributions for regressions</a></li>
<li class="chapter" data-level="24.5.2" data-path="posterior-prediction-for-regressions.html"><a href="posterior-prediction-for-regressions.html#stan-program"><i class="fa fa-check"></i><b>24.5.2</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="estimating-event-probabilities.html"><a href="estimating-event-probabilities.html"><i class="fa fa-check"></i><b>24.6</b> Estimating event probabilities</a></li>
<li class="chapter" data-level="24.7" data-path="stand-alone-generated-quantities-and-ongoing-prediction.html"><a href="stand-alone-generated-quantities-and-ongoing-prediction.html"><i class="fa fa-check"></i><b>24.7</b> Stand-alone generated quantities and ongoing prediction</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="simulation-based-calibration.html"><a href="simulation-based-calibration.html"><i class="fa fa-check"></i><b>25</b> Simulation-Based Calibration</a><ul>
<li class="chapter" data-level="25.1" data-path="bayes-is-calibrated-by-construction.html"><a href="bayes-is-calibrated-by-construction.html"><i class="fa fa-check"></i><b>25.1</b> Bayes is calibrated by construction</a></li>
<li class="chapter" data-level="25.2" data-path="simulation-based-calibration-1.html"><a href="simulation-based-calibration-1.html"><i class="fa fa-check"></i><b>25.2</b> Simulation-based calibration</a></li>
<li class="chapter" data-level="25.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html"><i class="fa fa-check"></i><b>25.3</b> SBC in Stan</a><ul>
<li class="chapter" data-level="25.3.1" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#example-model"><i class="fa fa-check"></i><b>25.3.1</b> Example model</a></li>
<li class="chapter" data-level="25.3.2" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#testing-a-stan-program-with-simulation-based-calibration"><i class="fa fa-check"></i><b>25.3.2</b> Testing a Stan program with simulation-based calibration</a></li>
<li class="chapter" data-level="25.3.3" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#pseudocode-for-simulation-based-calibration"><i class="fa fa-check"></i><b>25.3.3</b> Pseudocode for simulation-based calibration</a></li>
<li class="chapter" data-level="25.3.4" data-path="sbc-in-stan.html"><a href="sbc-in-stan.html#the-importance-of-thinning"><i class="fa fa-check"></i><b>25.3.4</b> The importance of thinning</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="testing-uniformity.html"><a href="testing-uniformity.html"><i class="fa fa-check"></i><b>25.4</b> Testing uniformity</a><ul>
<li class="chapter" data-level="25.4.1" data-path="testing-uniformity.html"><a href="testing-uniformity.html#indexing-to-simplify-arithmetic"><i class="fa fa-check"></i><b>25.4.1</b> Indexing to simplify arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html"><i class="fa fa-check"></i><b>25.5</b> Examples of simulation-based calibration</a><ul>
<li class="chapter" data-level="25.5.1" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-right"><i class="fa fa-check"></i><b>25.5.1</b> When things go right</a></li>
<li class="chapter" data-level="25.5.2" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-things-go-wrong"><i class="fa fa-check"></i><b>25.5.2</b> When things go wrong</a></li>
<li class="chapter" data-level="25.5.3" data-path="examples-of-simulation-based-calibration.html"><a href="examples-of-simulation-based-calibration.html#when-stans-sampler-goes-wrong"><i class="fa fa-check"></i><b>25.5.3</b> When Stan’s sampler goes wrong</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ppcs-chapter.html"><a href="ppcs-chapter.html"><i class="fa fa-check"></i><b>26</b> Posterior and Prior Predictive Checks</a><ul>
<li class="chapter" data-level="26.1" data-path="simulating-from-the-posterior-predictive-distribution.html"><a href="simulating-from-the-posterior-predictive-distribution.html"><i class="fa fa-check"></i><b>26.1</b> Simulating from the posterior predictive distribution</a></li>
<li class="chapter" data-level="26.2" data-path="plotting-multiples.html"><a href="plotting-multiples.html"><i class="fa fa-check"></i><b>26.2</b> Plotting multiples</a></li>
<li class="chapter" data-level="26.3" data-path="posterior-p-values.html"><a href="posterior-p-values.html"><i class="fa fa-check"></i><b>26.3</b> Posterior ``p-values’’</a><ul>
<li class="chapter" data-level="26.3.1" data-path="posterior-p-values.html"><a href="posterior-p-values.html#which-statistics-to-test"><i class="fa fa-check"></i><b>26.3.1</b> Which statistics to test?</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html"><i class="fa fa-check"></i><b>26.4</b> Prior predictive checks</a><ul>
<li class="chapter" data-level="26.4.1" data-path="prior-predictive-checks.html"><a href="prior-predictive-checks.html#coding-prior-predictive-checks-in-stan"><i class="fa fa-check"></i><b>26.4.1</b> Coding prior predictive checks in Stan</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="example-of-prior-predictive-checks.html"><a href="example-of-prior-predictive-checks.html"><i class="fa fa-check"></i><b>26.5</b> Example of prior predictive checks</a></li>
<li class="chapter" data-level="26.6" data-path="mixed-replication.html"><a href="mixed-replication.html"><i class="fa fa-check"></i><b>26.6</b> Mixed predictive replication for hierarchical models</a></li>
<li class="chapter" data-level="26.7" data-path="joint-model-representation.html"><a href="joint-model-representation.html"><i class="fa fa-check"></i><b>26.7</b> Joint model representation</a><ul>
<li class="chapter" data-level="26.7.1" data-path="joint-model-representation.html"><a href="joint-model-representation.html#posterior-predictive-model"><i class="fa fa-check"></i><b>26.7.1</b> Posterior predictive model</a></li>
<li class="chapter" data-level="26.7.2" data-path="joint-model-representation.html"><a href="joint-model-representation.html#prior-predictive-model"><i class="fa fa-check"></i><b>26.7.2</b> Prior predictive model</a></li>
<li class="chapter" data-level="26.7.3" data-path="joint-model-representation.html"><a href="joint-model-representation.html#mixed-replication-for-hierarchical-models"><i class="fa fa-check"></i><b>26.7.3</b> Mixed replication for hierarchical models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="held-out-evaluation-and-cross-validation.html"><a href="held-out-evaluation-and-cross-validation.html"><i class="fa fa-check"></i><b>27</b> Held-Out Evaluation and Cross-Validation</a><ul>
<li class="chapter" data-level="27.1" data-path="evaluating-posterior-predictive-section.html"><a href="evaluating-posterior-predictive-section.html"><i class="fa fa-check"></i><b>27.1</b> Evaluating posterior predictive densities</a><ul>
<li class="chapter" data-level="27.1.1" data-path="evaluating-posterior-predictive-section.html"><a href="evaluating-posterior-predictive-section.html#stan-program-1"><i class="fa fa-check"></i><b>27.1.1</b> Stan program</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="estimation-error.html"><a href="estimation-error.html"><i class="fa fa-check"></i><b>27.2</b> Estimation error</a><ul>
<li class="chapter" data-level="27.2.1" data-path="estimation-error.html"><a href="estimation-error.html#parameter-estimates"><i class="fa fa-check"></i><b>27.2.1</b> Parameter estimates</a></li>
<li class="chapter" data-level="27.2.2" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates"><i class="fa fa-check"></i><b>27.2.2</b> Predictive estimates</a></li>
<li class="chapter" data-level="27.2.3" data-path="estimation-error.html"><a href="estimation-error.html#predictive-estimates-in-stan"><i class="fa fa-check"></i><b>27.2.3</b> Predictive estimates in Stan</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>27.3</b> Cross-validation</a><ul>
<li class="chapter" data-level="27.3.1" data-path="cross-validation.html"><a href="cross-validation.html#stan-implementation-with-random-folds"><i class="fa fa-check"></i><b>27.3.1</b> Stan implementation with random folds</a></li>
<li class="chapter" data-level="27.3.2" data-path="cross-validation.html"><a href="cross-validation.html#user-defined-permutations"><i class="fa fa-check"></i><b>27.3.2</b> User-defined permutations</a></li>
<li class="chapter" data-level="27.3.3" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-structured-data"><i class="fa fa-check"></i><b>27.3.3</b> Cross-validation with structured data</a></li>
<li class="chapter" data-level="27.3.4" data-path="cross-validation.html"><a href="cross-validation.html#cross-validation-with-spatio-temporal-data"><i class="fa fa-check"></i><b>27.3.4</b> Cross-validation with spatio-temporal data</a></li>
<li class="chapter" data-level="27.3.5" data-path="cross-validation.html"><a href="cross-validation.html#approximate-cross-validation"><i class="fa fa-check"></i><b>27.3.5</b> Approximate cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="poststratification.html"><a href="poststratification.html"><i class="fa fa-check"></i><b>28</b> Poststratification</a><ul>
<li class="chapter" data-level="28.1" data-path="some-examples.html"><a href="some-examples.html"><i class="fa fa-check"></i><b>28.1</b> Some examples</a><ul>
<li class="chapter" data-level="28.1.1" data-path="some-examples.html"><a href="some-examples.html#earth-science"><i class="fa fa-check"></i><b>28.1.1</b> Earth science</a></li>
<li class="chapter" data-level="28.1.2" data-path="some-examples.html"><a href="some-examples.html#polling"><i class="fa fa-check"></i><b>28.1.2</b> Polling</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="bayesian-poststratification.html"><a href="bayesian-poststratification.html"><i class="fa fa-check"></i><b>28.2</b> Bayesian poststratification</a></li>
<li class="chapter" data-level="28.3" data-path="poststratification-in-stan.html"><a href="poststratification-in-stan.html"><i class="fa fa-check"></i><b>28.3</b> Poststratification in Stan</a></li>
<li class="chapter" data-level="28.4" data-path="regression-and-poststratification.html"><a href="regression-and-poststratification.html"><i class="fa fa-check"></i><b>28.4</b> Regression and poststratification</a></li>
<li class="chapter" data-level="28.5" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>28.5</b> Multilevel regression and poststratification</a><ul>
<li class="chapter" data-level="28.5.1" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html#dealing-with-small-partitions-and-non-identifiability"><i class="fa fa-check"></i><b>28.5.1</b> Dealing with small partitions and non-identifiability</a></li>
</ul></li>
<li class="chapter" data-level="28.6" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html"><i class="fa fa-check"></i><b>28.6</b> Coding MRP in Stan</a><ul>
<li class="chapter" data-level="28.6.1" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#binomial-coding"><i class="fa fa-check"></i><b>28.6.1</b> Binomial coding</a></li>
<li class="chapter" data-level="28.6.2" data-path="coding-mrp-in-stan.html"><a href="coding-mrp-in-stan.html#coding-binary-groups"><i class="fa fa-check"></i><b>28.6.2</b> Coding binary groups</a></li>
</ul></li>
<li class="chapter" data-level="28.7" data-path="adding-group-level-predictors.html"><a href="adding-group-level-predictors.html"><i class="fa fa-check"></i><b>28.7</b> Adding group-level predictors</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="decision-analysis.html"><a href="decision-analysis.html"><i class="fa fa-check"></i><b>29</b> Decision Analysis</a><ul>
<li class="chapter" data-level="29.1" data-path="outline-of-decision-analysis.html"><a href="outline-of-decision-analysis.html"><i class="fa fa-check"></i><b>29.1</b> Outline of decision analysis</a></li>
<li class="chapter" data-level="29.2" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html"><i class="fa fa-check"></i><b>29.2</b> Example decision analysis</a><ul>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-1.-define-decisions-and-outcomes"><i class="fa fa-check"></i>Step 1. Define decisions and outcomes</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-2.-define-density-of-outcome-conditioned-on-decision"><i class="fa fa-check"></i>Step 2. Define density of outcome conditioned on decision</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-3.-define-the-utility-function"><i class="fa fa-check"></i>Step 3. Define the utility function</a></li>
<li class="chapter" data-level="" data-path="example-decision-analysis.html"><a href="example-decision-analysis.html#step-4.-maximize-expected-utility"><i class="fa fa-check"></i>Step 4. Maximize expected utility</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="continuous-choices.html"><a href="continuous-choices.html"><i class="fa fa-check"></i><b>29.3</b> Continuous choices</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="the-bootstrap-and-bagging.html"><a href="the-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>30</b> The Bootstrap and Bagging</a><ul>
<li class="chapter" data-level="30.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>30.1</b> The bootstrap</a><ul>
<li class="chapter" data-level="30.1.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html#estimators"><i class="fa fa-check"></i><b>30.1.1</b> Estimators</a></li>
<li class="chapter" data-level="30.1.2" data-path="the-bootstrap.html"><a href="the-bootstrap.html#the-bootstrap-in-pseudocode"><i class="fa fa-check"></i><b>30.1.2</b> The bootstrap in pseudocode</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="coding-the-bootstrap-in-stan.html"><a href="coding-the-bootstrap-in-stan.html"><i class="fa fa-check"></i><b>30.2</b> Coding the bootstrap in Stan</a></li>
<li class="chapter" data-level="30.3" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html"><i class="fa fa-check"></i><b>30.3</b> Error statistics from the bootstrap</a><ul>
<li class="chapter" data-level="30.3.1" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#standard-errors"><i class="fa fa-check"></i><b>30.3.1</b> Standard errors</a></li>
<li class="chapter" data-level="30.3.2" data-path="error-statistics-from-the-bootstrap.html"><a href="error-statistics-from-the-bootstrap.html#confidence-intervals"><i class="fa fa-check"></i><b>30.3.2</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>30.4</b> Bagging</a></li>
<li class="chapter" data-level="30.5" data-path="bayesian-bootstrap-and-bagging.html"><a href="bayesian-bootstrap-and-bagging.html"><i class="fa fa-check"></i><b>30.5</b> Bayesian bootstrap and bagging</a></li>
</ul></li>
<li><a href="appendices-part.html#appendices.part"><i style="font-size: 110%; color:#990017;">Appendices</i></a></li>
<li class="chapter" data-level="31" data-path="stan-program-style-guide.html"><a href="stan-program-style-guide.html"><i class="fa fa-check"></i><b>31</b> Stan Program Style Guide</a><ul>
<li class="chapter" data-level="31.1" data-path="choose-a-consistent-style.html"><a href="choose-a-consistent-style.html"><i class="fa fa-check"></i><b>31.1</b> Choose a consistent style</a></li>
<li class="chapter" data-level="31.2" data-path="line-length.html"><a href="line-length.html"><i class="fa fa-check"></i><b>31.2</b> Line length</a></li>
<li class="chapter" data-level="31.3" data-path="file-extensions.html"><a href="file-extensions.html"><i class="fa fa-check"></i><b>31.3</b> File extensions</a></li>
<li class="chapter" data-level="31.4" data-path="variable-naming.html"><a href="variable-naming.html"><i class="fa fa-check"></i><b>31.4</b> Variable naming</a></li>
<li class="chapter" data-level="31.5" data-path="local-variable-scope.html"><a href="local-variable-scope.html"><i class="fa fa-check"></i><b>31.5</b> Local variable scope</a></li>
<li class="chapter" data-level="31.6" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html"><i class="fa fa-check"></i><b>31.6</b> Parentheses and brackets</a><ul>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#optional-parentheses-for-single-statement-blocks"><i class="fa fa-check"></i>Optional parentheses for single-statement blocks</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#parentheses-in-nested-operator-expressions"><i class="fa fa-check"></i>Parentheses in nested operator expressions</a></li>
<li class="chapter" data-level="" data-path="parentheses-and-brackets.html"><a href="parentheses-and-brackets.html#no-open-brackets-on-own-line"><i class="fa fa-check"></i>No open brackets on own line</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>31.7</b> Conditionals</a><ul>
<li class="chapter" data-level="" data-path="conditionals.html"><a href="conditionals.html#explicit-comparisons-of-non-boolean-conditions"><i class="fa fa-check"></i>Explicit comparisons of non-Boolean conditions</a></li>
</ul></li>
<li class="chapter" data-level="31.8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>31.8</b> Functions</a></li>
<li class="chapter" data-level="31.9" data-path="white-space.html"><a href="white-space.html"><i class="fa fa-check"></i><b>31.9</b> White space</a><ul>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#line-breaks-between-statements-and-declarations"><i class="fa fa-check"></i>Line breaks between statements and declarations</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-tabs"><i class="fa fa-check"></i>No tabs</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#two-character-indents"><i class="fa fa-check"></i>Two-character indents</a></li>
<li class="chapter" data-level="31.9.1" data-path="white-space.html"><a href="white-space.html#space-between-if-and-condition"><i class="fa fa-check"></i><b>31.9.1</b> Space between <code>if</code>, <code>{</code> and condition</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#no-space-for-function-calls"><i class="fa fa-check"></i>No space For function calls</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#spaces-around-operators"><i class="fa fa-check"></i>Spaces around operators</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#breaking-expressions-across-lines"><i class="fa fa-check"></i>Breaking expressions across lines</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#optional-spaces-after-commas"><i class="fa fa-check"></i>Optional spaces after commas</a></li>
<li class="chapter" data-level="" data-path="white-space.html"><a href="white-space.html#unix-newlines"><i class="fa fa-check"></i>Unix newlines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="stan-for-bugs-appendix.html"><a href="stan-for-bugs-appendix.html"><i class="fa fa-check"></i><b>32</b> Transitioning from BUGS</a><ul>
<li class="chapter" data-level="32.1" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html"><i class="fa fa-check"></i><b>32.1</b> Some differences in how BUGS and Stan work</a><ul>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-is-interpreted-stan-is-compiled"><i class="fa fa-check"></i>BUGS is interpreted, Stan is compiled</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#bugs-performs-mcmc-updating-one-scalar-parameter-at-a-time-stan-uses-hmc-which-moves-in-the-entire-space-of-all-the-parameters-at-each-step"><i class="fa fa-check"></i>BUGS performs MCMC updating one scalar parameter at a time, Stan uses HMC which moves in the entire space of all the parameters at each step</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-tuning-during-warmup"><i class="fa fa-check"></i>Differences in tuning during warmup</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#the-stan-language-is-directly-executable-the-bugs-modeling-language-is-not"><i class="fa fa-check"></i>The Stan language is directly executable, the BUGS modeling language is not</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#differences-in-statement-order"><i class="fa fa-check"></i>Differences in statement order</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#stan-computes-the-gradient-of-the-log-density-bugs-computes-the-log-density-but-not-its-gradient"><i class="fa fa-check"></i>Stan computes the gradient of the log density, BUGS computes the log density but not its gradient</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#both-bugs-and-stan-are-semi-automatic"><i class="fa fa-check"></i>Both BUGS and Stan are semi-automatic</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#licensing"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#interfaces"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="some-differences-in-how-bugs-and-stan-work.html"><a href="some-differences-in-how-bugs-and-stan-work.html#platforms"><i class="fa fa-check"></i>Platforms</a></li>
</ul></li>
<li class="chapter" data-level="32.2" data-path="some-differences-in-the-modeling-languages.html"><a href="some-differences-in-the-modeling-languages.html"><i class="fa fa-check"></i><b>32.2</b> Some differences in the modeling languages</a></li>
<li class="chapter" data-level="32.3" data-path="some-differences-in-the-statistical-models-that-are-allowed.html"><a href="some-differences-in-the-statistical-models-that-are-allowed.html"><i class="fa fa-check"></i><b>32.3</b> Some differences in the statistical models that are allowed</a></li>
<li class="chapter" data-level="32.4" data-path="some-differences-when-running-from-r.html"><a href="some-differences-when-running-from-r.html"><i class="fa fa-check"></i><b>32.4</b> Some differences when running from R</a></li>
<li class="chapter" data-level="32.5" data-path="the-stan-community.html"><a href="the-stan-community.html"><i class="fa fa-check"></i><b>32.5</b> The Stan community</a></li>
</ul></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div>
This is an old version, <a href="https://mc-stan.org/docs/stan-users-guide/problematic-posteriors.html#label-switching-problematic.section">view current version</a>.
</div>
<div id="label-switching-problematic.section" class="section level2">
<h2><span class="header-section-number">20.2</span> Label switching in mixture models</h2>
<p>Where collinearity in regression models can lead to infinitely many
posterior maxima, swapping components in a mixture model leads to
finitely many posterior maxima.</p>
<div id="mixture-models" class="section level3 unnumbered">
<h3>Mixture models</h3>
<p>Consider a normal mixture model with two location parameters <span class="math inline">\(\mu_1\)</span>
and <span class="math inline">\(\mu_2\)</span>, a shared scale <span class="math inline">\(\sigma &gt; 0\)</span>, a mixture ratio <span class="math inline">\(\theta \in [0,1]\)</span>, and likelihood
<span class="math display">\[
p(y \mid \theta,\mu_1,\mu_2,\sigma)
= \prod_{n=1}^N \big( \theta \, \textsf{normal}(y_n \mid \mu_1,\sigma)
                       + (1 - \theta) \, \textsf{normal}(y_n \mid \mu_2,\sigma) \big).
\]</span>
The issue here is exchangeability of the mixture components, because
<span class="math display">\[
p(\theta,\mu_1,\mu_2,\sigma \mid y) = p\big((1-\theta),\mu_2,\mu_1,\sigma \mid y\big).
\]</span>
The problem is exacerbated as the number of mixture components <span class="math inline">\(K\)</span>
grows, as in clustering models, leading to <span class="math inline">\(K!\)</span> identical posterior
maxima.</p>
</div>
<div id="convergence-monitoring-and-effective-sample-size" class="section level3 unnumbered">
<h3>Convergence monitoring and effective sample size</h3>
<p>The analysis of posterior convergence and effective sample size is
also difficult for mixture models. For example, the <span class="math inline">\(\hat{R}\)</span>
convergence statistic reported by Stan and the computation of
effective sample size are both compromised by label switching. The
problem is that the posterior mean, a key ingredient in these
computations, is affected by label switching, resulting in a posterior
mean for <span class="math inline">\(\mu_1\)</span> that is equal to that of <span class="math inline">\(\mu_2\)</span>, and a posterior
mean for <span class="math inline">\(\theta\)</span> that is always 1/2, no matter what the data are.</p>
</div>
<div id="some-inferences-are-invariant" class="section level3 unnumbered">
<h3>Some inferences are invariant</h3>
<p>In some sense, the index (or label) of a mixture component is
irrelevant. Posterior predictive inferences can still be carried out
without identifying mixture components. For example, the log
probability of a new observation does not depend on the identities of
the mixture components. The only sound Bayesian inferences in such
models are those that are invariant to label switching. Posterior
means for the parameters are meaningless because they are not
invariant to label switching; for example, the posterior mean for
<span class="math inline">\(\theta\)</span> in the two component mixture model will always be 1/2.</p>
</div>
<div id="highly-multimodal-posteriors" class="section level3 unnumbered">
<h3>Highly multimodal posteriors</h3>
<p>Theoretically, this should not present a problem for inference because
all of the integrals involved in posterior predictive inference will
be well behaved. The problem in practice is computation.</p>
<p>Being able to carry out such invariant inferences in practice is an
altogether different matter. It is almost always intractable to find
even a single posterior mode, much less balance the exploration of the
neighborhoods of multiple local maxima according to the probability
masses. In Gibbs sampling, it is unlikely for <span class="math inline">\(\mu_1\)</span>
to move to a new mode when sampled conditioned on the current values
of <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\theta\)</span>. For HMC and NUTS, the problem is that the
sampler gets stuck in one of the two “bowls” around the modes and
cannot gather enough energy from random momentum assignment to move
from one mode to another.</p>
<p>Even with a proper posterior, all known sampling and inference
techniques are notoriously ineffective when the number of modes grows
super-exponentially as it does for mixture models with increasing
numbers of components.</p>
</div>
<div id="hacks-as-fixes" class="section level3 unnumbered">
<h3>Hacks as fixes</h3>
<p>Several hacks (i.e., “tricks”) have been suggested and employed to
deal with the problems posed by label switching in practice.</p>
<div id="parameter-ordering-constraints" class="section level4 unnumbered">
<h4>Parameter ordering constraints</h4>
<p>One common strategy is to impose a constraint on the parameters that
identifies the components. For instance, we might consider
constraining <span class="math inline">\(\mu_1 &lt; \mu_2\)</span> in the two-component normal mixture model
discussed above. A problem that can arise from such an approach is
when there is substantial probability mass for the opposite ordering
<span class="math inline">\(\mu_1 &gt; \mu_2\)</span>. In these cases, the posteriors are affected by
the constraint and true posterior uncertainty in <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span>
is not captured by the model with the constraint. In addition,
standard approaches to posterior inference for event probabilities is
compromised. For instance, attempting to use <span class="math inline">\(M\)</span> posterior samples to
estimate <span class="math inline">\(\textsf{Pr}[\mu_1 &gt; \mu_2]\)</span>, will fail, because the estimator
<span class="math display">\[
\textsf{Pr}[\mu_1 &gt; \mu_2]
\approx
\sum_{m=1}^M \textrm{I}\left(\mu_1^{(m)} &gt; \mu_2^{(m)}\right)
\]</span>
will result in an estimate of 0 because the posterior respects the
constraint in the model.</p>
</div>
<div id="initialization-around-a-single-mode" class="section level4 unnumbered">
<h4>Initialization around a single mode</h4>
<p>Another common approach is to run a single chain or to initialize the
parameters near realistic values.<a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a></p>
<p>This can work better than the hard constraint approach if reasonable
initial values can be found and the labels do not switch within a
Markov chain. The result is that all chains are glued to a
neighborhood of a particular mode in the posterior.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="36">
<li id="fn36"><p>Tempering methods may be viewed as automated ways to carry
out such a search for modes, though most MCMC tempering methods
continue to search for modes on an ongoing basis; see
<span class="citation">(Swendsen and Wang <a href="#ref-SwendsenWang:1986">1986</a>; Neal <a href="#ref-Neal:1996b">1996</a><a href="#ref-Neal:1996b">b</a>)</span>.<a href="label-switching-problematic-section.html#fnref36" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="collinearity-section.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="component-collapsing-in-mixture-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
